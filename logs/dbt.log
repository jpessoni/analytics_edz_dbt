[0m10:50:08.358851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028878417470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028878417740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288784144A0>]}


============================== 10:50:08.358851 | fa686cfd-34e3-4630-96f1-adf9c5dec30d ==============================
[0m10:50:08.358851 [info ] [MainThread]: Running with dbt=1.7.3
[0m10:50:08.358851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:50:08.358851 [info ] [MainThread]: dbt version: 1.7.3
[0m10:50:08.358851 [info ] [MainThread]: python version: 3.12.0
[0m10:50:08.375054 [info ] [MainThread]: python path: C:\Josi\Cursos e Treinamentos\Stack\DBT\dbt_env\dbt_env\Scripts\python.exe
[0m10:50:08.377098 [info ] [MainThread]: os info: Windows-11-10.0.22621-SP0
[0m10:50:08.666698 [info ] [MainThread]: Using profiles dir at C:\Users\jpess\.dbt
[0m10:50:08.668976 [info ] [MainThread]: Using profiles.yml file at C:\Users\jpess\.dbt\profiles.yml
[0m10:50:08.671015 [info ] [MainThread]: Using dbt_project.yml file at C:\Josi\Cursos e Treinamentos\Stack\DBT\dbt_env\analytics_dbt\dbt_project.yml
[0m10:50:08.672265 [info ] [MainThread]: adapter type: redshift
[0m10:50:08.672265 [info ] [MainThread]: adapter version: 1.7.0
[0m10:50:08.768604 [info ] [MainThread]: Configuration:
[0m10:50:08.770438 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:50:08.772438 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:50:08.773696 [info ] [MainThread]: Required dependencies:
[0m10:50:08.775715 [debug] [MainThread]: Executing "git --help"
[0m10:50:08.839550 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c name=value]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   reset      Reset current HEAD to the specified state\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   branch     List, create, or delete branches\n   checkout   Switch branches or restore working tree files\n   commit     Record changes to the repository\n   diff       Show changes between commits, commit and working tree, etc\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\n""
[0m10:50:08.840864 [debug] [MainThread]: STDERR: "b''"
[0m10:50:08.840864 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:50:08.840864 [info ] [MainThread]: Connection:
[0m10:50:08.840864 [info ] [MainThread]:   host: redshift-cluster-1.cfqk4kc9vmtx.us-east-1.redshift.amazonaws.com
[0m10:50:08.840864 [info ] [MainThread]:   user: awsuser
[0m10:50:08.840864 [info ] [MainThread]:   port: 5439
[0m10:50:08.840864 [info ] [MainThread]:   database: dev
[0m10:50:08.840864 [info ] [MainThread]:   method: database
[0m10:50:08.840864 [info ] [MainThread]:   cluster_id: None
[0m10:50:08.856213 [info ] [MainThread]:   iam_profile: None
[0m10:50:08.857206 [info ] [MainThread]:   schema: public
[0m10:50:08.859204 [info ] [MainThread]:   sslmode: prefer
[0m10:50:08.860615 [info ] [MainThread]:   region: None
[0m10:50:08.860615 [info ] [MainThread]:   sslmode: prefer
[0m10:50:08.860615 [info ] [MainThread]:   region: None
[0m10:50:08.860615 [info ] [MainThread]:   iam_profile: None
[0m10:50:08.860615 [info ] [MainThread]:   autocreate: False
[0m10:50:08.860615 [info ] [MainThread]:   db_groups: []
[0m10:50:08.860615 [info ] [MainThread]:   ra3_node: False
[0m10:50:08.872901 [info ] [MainThread]:   connect_timeout: None
[0m10:50:08.874903 [info ] [MainThread]:   role: None
[0m10:50:08.875906 [info ] [MainThread]:   retries: 1
[0m10:50:08.878045 [info ] [MainThread]:   autocommit: True
[0m10:50:08.878045 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m10:50:08.878045 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m10:50:08.878045 [debug] [MainThread]: Using redshift connection "debug"
[0m10:50:08.889713 [debug] [MainThread]: On debug: select 1 as id
[0m10:50:08.890712 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:50:08.893966 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:50:08.893966 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:50:14.089489 [debug] [MainThread]: SQL status: SUCCESS in 5.0 seconds
[0m10:50:14.089489 [debug] [MainThread]: On debug: Close
[0m10:50:14.089489 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:50:14.089489 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:50:14.108859 [debug] [MainThread]: Command `dbt debug` succeeded at 10:50:14.108859 after 5.82 seconds
[0m10:50:14.110855 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:50:14.111856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028878E94B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028877D4C8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028878AF0560>]}
[0m10:50:14.113856 [debug] [MainThread]: Flushing usage events
[0m19:37:28.796868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028637037680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286370376B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028637035550>]}


============================== 19:37:28.813053 | a853b104-d0a8-4cd9-8f94-5735cb85d7c5 ==============================
[0m19:37:28.813053 [info ] [MainThread]: Running with dbt=1.7.3
[0m19:37:28.813053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:37:28.813053 [info ] [MainThread]: dbt version: 1.7.3
[0m19:37:28.813053 [info ] [MainThread]: python version: 3.12.0
[0m19:37:28.813053 [info ] [MainThread]: python path: C:\Josi\Cursos e Treinamentos\Stack\DBT\dbt_env\dbt_env\Scripts\python.exe
[0m19:37:28.823464 [info ] [MainThread]: os info: Windows-11-10.0.22621-SP0
[0m19:37:29.157329 [info ] [MainThread]: Using profiles dir at C:\Users\jpess\.dbt
[0m19:37:29.157329 [info ] [MainThread]: Using profiles.yml file at C:\Users\jpess\.dbt\profiles.yml
[0m19:37:29.157329 [info ] [MainThread]: Using dbt_project.yml file at C:\Josi\Cursos e Treinamentos\Stack\DBT\dbt_env\analytics_edz_dbt\dbt_project.yml
[0m19:37:29.157329 [info ] [MainThread]: adapter type: redshift
[0m19:37:29.157329 [info ] [MainThread]: adapter version: 1.7.0
[0m19:37:29.282489 [info ] [MainThread]: Configuration:
[0m19:37:29.282489 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:37:29.282489 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:37:29.282489 [info ] [MainThread]: Required dependencies:
[0m19:37:29.282489 [debug] [MainThread]: Executing "git --help"
[0m19:37:29.350453 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c name=value]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   reset      Reset current HEAD to the specified state\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   branch     List, create, or delete branches\n   checkout   Switch branches or restore working tree files\n   commit     Record changes to the repository\n   diff       Show changes between commits, commit and working tree, etc\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\n""
[0m19:37:29.364718 [debug] [MainThread]: STDERR: "b''"
[0m19:37:29.365730 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:37:29.367737 [info ] [MainThread]: Connection:
[0m19:37:29.368728 [info ] [MainThread]:   host: redshift-cluster-1.cfqk4kc9vmtx.us-east-1.redshift.amazonaws.com
[0m19:37:29.370050 [info ] [MainThread]:   user: awsuser
[0m19:37:29.372071 [info ] [MainThread]:   port: 5439
[0m19:37:29.373065 [info ] [MainThread]:   database: dev
[0m19:37:29.375071 [info ] [MainThread]:   method: database
[0m19:37:29.377074 [info ] [MainThread]:   cluster_id: None
[0m19:37:29.377769 [info ] [MainThread]:   iam_profile: None
[0m19:37:29.381385 [info ] [MainThread]:   schema: public
[0m19:37:29.383400 [info ] [MainThread]:   sslmode: prefer
[0m19:37:29.385398 [info ] [MainThread]:   region: None
[0m19:37:29.386398 [info ] [MainThread]:   sslmode: prefer
[0m19:37:29.387793 [info ] [MainThread]:   region: None
[0m19:37:29.387793 [info ] [MainThread]:   iam_profile: None
[0m19:37:29.387793 [info ] [MainThread]:   autocreate: False
[0m19:37:29.387793 [info ] [MainThread]:   db_groups: []
[0m19:37:29.387793 [info ] [MainThread]:   ra3_node: False
[0m19:37:29.387793 [info ] [MainThread]:   connect_timeout: None
[0m19:37:29.387793 [info ] [MainThread]:   role: None
[0m19:37:29.399099 [info ] [MainThread]:   retries: 1
[0m19:37:29.401099 [info ] [MainThread]:   autocommit: True
[0m19:37:29.403096 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m19:37:29.405092 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m19:37:29.411140 [debug] [MainThread]: Using redshift connection "debug"
[0m19:37:29.411140 [debug] [MainThread]: On debug: select 1 as id
[0m19:37:29.411140 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:37:29.419498 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:37:29.420477 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:37:31.655067 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m19:37:31.657069 [debug] [MainThread]: On debug: Close
[0m19:37:31.660066 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:37:31.662066 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:37:31.664615 [debug] [MainThread]: Command `dbt debug` succeeded at 19:37:31.664615 after 2.93 seconds
[0m19:37:31.664615 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:37:31.664615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286368ED730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286368EF080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028636D38680>]}
[0m19:37:31.664615 [debug] [MainThread]: Flushing usage events
[0m19:48:12.742637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A99D16000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A99D17740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A99D148C0>]}


============================== 19:48:12.751189 | 5f82e58e-5704-44bd-81a0-bf351451eb4b ==============================
[0m19:48:12.751189 [info ] [MainThread]: Running with dbt=1.7.3
[0m19:48:12.753160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:48:13.416273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f82e58e-5704-44bd-81a0-bf351451eb4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A9A759670>]}
[0m19:48:13.538314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f82e58e-5704-44bd-81a0-bf351451eb4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A9A2E2600>]}
[0m19:48:13.539828 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m19:48:13.549229 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m19:48:13.560122 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:48:13.562091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5f82e58e-5704-44bd-81a0-bf351451eb4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A9A8704D0>]}
[0m19:48:15.349036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f82e58e-5704-44bd-81a0-bf351451eb4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A9AD5B320>]}
[0m19:48:15.369027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f82e58e-5704-44bd-81a0-bf351451eb4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A9A98FE60>]}
[0m19:48:15.370066 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m19:48:15.372047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f82e58e-5704-44bd-81a0-bf351451eb4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A9A8727E0>]}
[0m19:48:15.375115 [info ] [MainThread]: 
[0m19:48:15.375115 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m19:48:15.379133 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m19:48:15.419020 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m19:48:15.419020 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m19:48:15.419020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:15.427082 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:48:15.429082 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:48:18.192002 [debug] [ThreadPool]: SQL status: SUCCESS in 3.0 seconds
[0m19:48:18.196948 [debug] [ThreadPool]: On list_dev: Close
[0m19:48:18.201657 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m19:48:18.219018 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m19:48:18.219018 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m19:48:18.219018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:18.226506 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:48:18.229225 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:48:20.039726 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m19:48:20.042443 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m19:48:20.043459 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m19:48:20.351475 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:20.355333 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m19:48:20.651236 [debug] [ThreadPool]: On list_dev_public: Close
[0m19:48:20.669311 [debug] [MainThread]: Using redshift connection "master"
[0m19:48:20.670837 [debug] [MainThread]: On master: BEGIN
[0m19:48:20.672837 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:48:20.673838 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:48:20.676071 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:48:22.493507 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m19:48:22.495928 [debug] [MainThread]: Using redshift connection "master"
[0m19:48:22.497254 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m19:48:22.837806 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:22.841254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f82e58e-5704-44bd-81a0-bf351451eb4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A9AD50AD0>]}
[0m19:48:22.841254 [debug] [MainThread]: On master: ROLLBACK
[0m19:48:23.149086 [debug] [MainThread]: Using redshift connection "master"
[0m19:48:23.149086 [debug] [MainThread]: On master: BEGIN
[0m19:48:23.303191 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:23.304221 [debug] [MainThread]: On master: COMMIT
[0m19:48:23.306174 [debug] [MainThread]: Using redshift connection "master"
[0m19:48:23.307175 [debug] [MainThread]: On master: COMMIT
[0m19:48:23.597050 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:23.598098 [debug] [MainThread]: On master: Close
[0m19:48:23.600261 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:48:23.602811 [info ] [MainThread]: 
[0m19:48:23.627872 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m19:48:23.629459 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:48:23.631474 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.analytics_dbt.my_first_dbt_model'
[0m19:48:23.633472 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m19:48:23.637547 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m19:48:23.644692 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 19:48:23.633472 => 19:48:23.643694
[0m19:48:23.645744 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m19:48:23.718290 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m19:48:23.725324 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:48:23.727354 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:48:23.728945 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:48:23.730681 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:48:23.732678 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:48:25.421344 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m19:48:25.423362 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:48:25.425325 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m19:48:26.151102 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:48:26.162408 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:48:26.163243 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:48:26.865301 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:48:26.909224 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:48:26.911739 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:48:26.915638 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:48:27.673172 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:48:27.674854 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:48:27.676514 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:48:27.956203 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:27.967151 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m19:48:27.975707 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:48:27.978368 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:48:28.257604 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:28.260376 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:48:28.261401 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:48:28.262402 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:48:28.409207 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:28.411073 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:48:28.413119 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:48:28.554583 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:28.558333 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 19:48:23.647523 => 19:48:28.558333
[0m19:48:28.560816 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m19:48:28.841437 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m19:48:28.844624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f82e58e-5704-44bd-81a0-bf351451eb4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A9AC54440>]}
[0m19:48:28.846628 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 5.21s]
[0m19:48:28.850143 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m19:48:28.853144 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m19:48:28.856147 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m19:48:28.859658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.my_second_dbt_model)
[0m19:48:28.861334 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m19:48:28.865714 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m19:48:28.867731 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 19:48:28.862704 => 19:48:28.867731
[0m19:48:28.869319 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m19:48:28.904520 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m19:48:28.909179 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:48:28.911070 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:48:28.912152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:48:28.914082 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:48:28.915389 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:48:30.141429 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:48:30.142677 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:48:30.144493 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m19:48:30.705297 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:48:30.714380 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:48:30.715395 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:48:31.134673 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:31.139262 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:48:31.141221 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:48:31.143271 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:48:31.881088 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:48:31.883630 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:48:31.884659 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:48:32.165919 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:32.172517 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m19:48:32.180124 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:48:32.182258 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:48:32.461338 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:32.463233 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:48:32.464253 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:48:32.465846 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:48:32.610924 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:32.613511 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:48:32.614600 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:48:32.749344 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:32.758100 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 19:48:28.869319 => 19:48:32.758100
[0m19:48:32.759411 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m19:48:33.039289 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m19:48:33.042197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f82e58e-5704-44bd-81a0-bf351451eb4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A9B567080>]}
[0m19:48:33.044195 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 4.18s]
[0m19:48:33.047193 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m19:48:33.050626 [debug] [MainThread]: Using redshift connection "master"
[0m19:48:33.051628 [debug] [MainThread]: On master: BEGIN
[0m19:48:33.052609 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:48:33.053606 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:48:33.056604 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:48:34.739038 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m19:48:34.741564 [debug] [MainThread]: On master: COMMIT
[0m19:48:34.742565 [debug] [MainThread]: Using redshift connection "master"
[0m19:48:34.744583 [debug] [MainThread]: On master: COMMIT
[0m19:48:35.025930 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:35.027929 [debug] [MainThread]: On master: Close
[0m19:48:35.030049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:48:35.031023 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m19:48:35.032071 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m19:48:35.033043 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m19:48:35.034047 [info ] [MainThread]: 
[0m19:48:35.036024 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 19.66 seconds (19.66s).
[0m19:48:35.038046 [debug] [MainThread]: Command end result
[0m19:48:35.055685 [info ] [MainThread]: 
[0m19:48:35.058047 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:48:35.060568 [info ] [MainThread]: 
[0m19:48:35.062613 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:48:35.065976 [debug] [MainThread]: Command `dbt run` succeeded at 19:48:35.065976 after 22.41 seconds
[0m19:48:35.067273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A99A87DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A99CFB890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A9A2E2600>]}
[0m19:48:35.068282 [debug] [MainThread]: Flushing usage events
[0m20:08:19.777670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E23FB470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E23FB680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E23FB380>]}


============================== 20:08:19.785362 | 405dc903-6053-4092-8050-6bd78af8f7d7 ==============================
[0m20:08:19.785362 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:08:19.787795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models views/vw_sales.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:08:20.298776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '405dc903-6053-4092-8050-6bd78af8f7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E2415F70>]}
[0m20:08:20.408089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '405dc903-6053-4092-8050-6bd78af8f7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E2FAE900>]}
[0m20:08:20.408089 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m20:08:20.430970 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:08:20.442523 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:08:20.442523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '405dc903-6053-4092-8050-6bd78af8f7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E2F3AB40>]}
[0m20:08:22.056466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '405dc903-6053-4092-8050-6bd78af8f7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E34BA360>]}
[0m20:08:22.072780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '405dc903-6053-4092-8050-6bd78af8f7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E31BEAB0>]}
[0m20:08:22.072780 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:08:22.072780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '405dc903-6053-4092-8050-6bd78af8f7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E34561E0>]}
[0m20:08:22.077362 [warn ] [MainThread]: The selection criterion 'views/vw_sales.sql' does not match any nodes
[0m20:08:22.077362 [info ] [MainThread]: 
[0m20:08:22.077362 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:08:22.084821 [debug] [MainThread]: Command end result
[0m20:08:22.100523 [debug] [MainThread]: Command `dbt run` succeeded at 20:08:22.100523 after 2.41 seconds
[0m20:08:22.100523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E1B2D880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E319D130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E23FB380>]}
[0m20:08:22.107537 [debug] [MainThread]: Flushing usage events
[0m20:09:25.512434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9DB37A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9DB37C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9DB36090>]}


============================== 20:09:25.519711 | be4ef566-625a-4736-bcd4-3d4a6f55aaac ==============================
[0m20:09:25.519711 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:09:25.522078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:09:26.014837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be4ef566-625a-4736-bcd4-3d4a6f55aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9E712000>]}
[0m20:09:26.123610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be4ef566-625a-4736-bcd4-3d4a6f55aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9BEBA7E0>]}
[0m20:09:26.126337 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m20:09:26.139545 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:09:26.297394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:09:26.297394 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:09:26.309856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be4ef566-625a-4736-bcd4-3d4a6f55aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9E6DB950>]}
[0m20:09:26.324460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be4ef566-625a-4736-bcd4-3d4a6f55aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9E85EFF0>]}
[0m20:09:26.325061 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:09:26.327075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be4ef566-625a-4736-bcd4-3d4a6f55aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9DBF8620>]}
[0m20:09:26.329074 [info ] [MainThread]: 
[0m20:09:26.331159 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:09:26.334758 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m20:09:26.360307 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:09:26.361307 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m20:09:26.362310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:26.369753 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:09:26.371753 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:09:28.257600 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:09:28.260121 [debug] [ThreadPool]: On list_dev: Close
[0m20:09:28.264369 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m20:09:28.285631 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:09:28.287650 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:09:28.288646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:28.289641 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:09:28.290644 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:09:30.056667 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:09:30.057686 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:09:30.058678 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m20:09:30.369276 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:30.372300 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:09:30.671914 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:09:30.692385 [debug] [MainThread]: Using redshift connection "master"
[0m20:09:30.694394 [debug] [MainThread]: On master: BEGIN
[0m20:09:30.696201 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:09:30.697894 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:09:30.699414 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:09:32.496780 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m20:09:32.499365 [debug] [MainThread]: Using redshift connection "master"
[0m20:09:32.499365 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:09:32.834460 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:32.846272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be4ef566-625a-4736-bcd4-3d4a6f55aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9E9B10A0>]}
[0m20:09:32.848797 [debug] [MainThread]: On master: ROLLBACK
[0m20:09:33.161192 [debug] [MainThread]: Using redshift connection "master"
[0m20:09:33.161192 [debug] [MainThread]: On master: BEGIN
[0m20:09:33.305111 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:33.305111 [debug] [MainThread]: On master: COMMIT
[0m20:09:33.313364 [debug] [MainThread]: Using redshift connection "master"
[0m20:09:33.314259 [debug] [MainThread]: On master: COMMIT
[0m20:09:33.604845 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:33.604845 [debug] [MainThread]: On master: Close
[0m20:09:33.604845 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:09:33.604845 [info ] [MainThread]: 
[0m20:09:33.620145 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:09:33.621146 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:09:33.623151 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.analytics_dbt.my_first_dbt_model'
[0m20:09:33.624766 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:09:33.632249 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:09:33.636842 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 20:09:33.625690 => 20:09:33.635791
[0m20:09:33.638561 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:09:33.712583 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m20:09:33.717276 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:33.718311 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:09:33.719279 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:09:33.720279 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:09:33.721286 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:09:35.422271 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:09:35.424267 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:35.425879 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:09:35.748982 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:35.752954 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:09:35.754574 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:35.755475 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:09:36.496547 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:09:36.496547 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:36.496547 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:09:36.644749 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:36.658210 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m20:09:36.664588 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:36.664588 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m20:09:36.952801 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:36.955309 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:09:36.957332 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:36.957332 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:09:37.496968 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:09:37.496968 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:37.504625 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:09:37.647257 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:37.658933 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:37.659884 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:09:38.634796 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:09:38.674653 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:09:38.675544 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:38.676553 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:09:39.247863 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:09:39.250860 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:39.251908 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:09:39.532909 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:39.538553 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m20:09:39.540541 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:39.541553 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:09:39.822356 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:39.824974 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:09:39.827059 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:39.827059 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:09:39.974964 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:39.974964 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:39.979625 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:09:40.122192 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:40.125772 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 20:09:33.638561 => 20:09:40.124755
[0m20:09:40.127780 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:09:40.405179 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:09:40.413490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be4ef566-625a-4736-bcd4-3d4a6f55aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9ED596A0>]}
[0m20:09:40.415588 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 6.79s]
[0m20:09:40.417639 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:09:40.418641 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m20:09:40.419660 [info ] [Thread-1 (]: 2 of 3 START sql views model public.vw_sales ................................... [RUN]
[0m20:09:40.421681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m20:09:40.422687 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m20:09:40.426191 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:09:40.429530 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 20:09:40.423673 => 20:09:40.428710
[0m20:09:40.429530 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m20:09:40.429530 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 20:09:40.429530 => 20:09:40.429530
[0m20:09:40.434889 [debug] [Thread-1 (]: Compilation Error in model vw_sales (models\views\vw_sales.sql)
  No materialization 'views' was found for adapter redshift! (searched types 'default' and 'redshift')
[0m20:09:40.434889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be4ef566-625a-4736-bcd4-3d4a6f55aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9ECD5D00>]}
[0m20:09:40.434889 [error] [Thread-1 (]: 2 of 3 ERROR creating sql views model public.vw_sales .......................... [[31mERROR[0m in 0.01s]
[0m20:09:40.434889 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m20:09:40.434889 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:09:40.434889 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:09:40.444473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m20:09:40.445892 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:09:40.452005 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:09:40.455547 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 20:09:40.446947 => 20:09:40.454535
[0m20:09:40.456547 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:09:40.487924 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m20:09:40.490905 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:09:40.491932 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:09:40.491932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:40.492862 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:09:40.492862 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:09:42.234955 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:09:42.234955 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:09:42.234955 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m20:09:42.825685 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:09:42.830617 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:09:42.830617 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:09:43.264219 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:43.271945 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:09:43.274453 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:09:43.274453 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:09:43.931626 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:09:43.934439 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:09:43.936307 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:09:44.227697 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:44.234358 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m20:09:44.234358 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:09:44.234358 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:09:44.529377 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:44.534538 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:09:44.534538 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:09:44.534538 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:09:44.688668 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:44.690704 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:09:44.691718 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:09:44.838087 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:44.840040 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 20:09:40.456547 => 20:09:44.838998
[0m20:09:44.840040 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:09:45.130061 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:09:45.130061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be4ef566-625a-4736-bcd4-3d4a6f55aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9F02EFF0>]}
[0m20:09:45.134688 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 4.70s]
[0m20:09:45.134688 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:09:45.134688 [debug] [MainThread]: Using redshift connection "master"
[0m20:09:45.134688 [debug] [MainThread]: On master: BEGIN
[0m20:09:45.134688 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:09:45.134688 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:09:45.134688 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:09:46.414318 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:09:46.416455 [debug] [MainThread]: On master: COMMIT
[0m20:09:46.417513 [debug] [MainThread]: Using redshift connection "master"
[0m20:09:46.418532 [debug] [MainThread]: On master: COMMIT
[0m20:09:46.709771 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:46.713141 [debug] [MainThread]: On master: Close
[0m20:09:46.715840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:09:46.716694 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m20:09:46.717735 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m20:09:46.717735 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m20:09:46.718692 [info ] [MainThread]: 
[0m20:09:46.719722 [info ] [MainThread]: Finished running 1 table model, 1 views model, 1 view model in 0 hours 0 minutes and 20.39 seconds (20.39s).
[0m20:09:46.722306 [debug] [MainThread]: Command end result
[0m20:09:46.734812 [info ] [MainThread]: 
[0m20:09:46.734812 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:09:46.734812 [info ] [MainThread]: 
[0m20:09:46.734812 [error] [MainThread]:   Compilation Error in model vw_sales (models\views\vw_sales.sql)
  No materialization 'views' was found for adapter redshift! (searched types 'default' and 'redshift')
[0m20:09:46.744675 [info ] [MainThread]: 
[0m20:09:46.748098 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:09:46.751114 [debug] [MainThread]: Command `dbt run` failed at 20:09:46.751114 after 21.32 seconds
[0m20:09:46.753062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9D8CB620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9D38A2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9D38A570>]}
[0m20:09:46.754631 [debug] [MainThread]: Flushing usage events
[0m20:12:27.205289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CE7147D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CE714050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CE7178F0>]}


============================== 20:12:27.220984 | 61615b28-9d94-4c6c-86b6-af59745b6aa8 ==============================
[0m20:12:27.220984 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:12:27.220984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:12:27.713605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61615b28-9d94-4c6c-86b6-af59745b6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CEC77C80>]}
[0m20:12:27.802100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61615b28-9d94-4c6c-86b6-af59745b6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CE6FEDE0>]}
[0m20:12:27.802100 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m20:12:27.820838 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:12:27.839240 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:12:27.839240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '61615b28-9d94-4c6c-86b6-af59745b6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CF239EE0>]}
[0m20:12:29.261429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61615b28-9d94-4c6c-86b6-af59745b6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CF76E690>]}
[0m20:12:29.277047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61615b28-9d94-4c6c-86b6-af59745b6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CF3ED940>]}
[0m20:12:29.277047 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:12:29.277047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61615b28-9d94-4c6c-86b6-af59745b6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CF340800>]}
[0m20:12:29.277047 [info ] [MainThread]: 
[0m20:12:29.291340 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:12:29.293333 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m20:12:29.320680 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:12:29.322674 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m20:12:29.323673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:29.324935 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:12:29.324935 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:12:31.422605 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:12:31.422605 [debug] [ThreadPool]: On list_dev: Close
[0m20:12:31.438237 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m20:12:31.454268 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:12:31.454268 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:12:31.454268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:31.454268 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:12:31.454268 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:12:33.180152 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:12:33.180152 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:12:33.180152 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m20:12:33.483368 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:33.487376 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:12:33.774393 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:12:33.788444 [debug] [MainThread]: Using redshift connection "master"
[0m20:12:33.789445 [debug] [MainThread]: On master: BEGIN
[0m20:12:33.790455 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:12:33.791214 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:12:33.792225 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:12:35.533485 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m20:12:35.533485 [debug] [MainThread]: Using redshift connection "master"
[0m20:12:35.533485 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:12:35.877660 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:35.877660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61615b28-9d94-4c6c-86b6-af59745b6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CF7503E0>]}
[0m20:12:35.877660 [debug] [MainThread]: On master: ROLLBACK
[0m20:12:36.192045 [debug] [MainThread]: Using redshift connection "master"
[0m20:12:36.192045 [debug] [MainThread]: On master: BEGIN
[0m20:12:36.332476 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:36.332476 [debug] [MainThread]: On master: COMMIT
[0m20:12:36.332476 [debug] [MainThread]: Using redshift connection "master"
[0m20:12:36.332476 [debug] [MainThread]: On master: COMMIT
[0m20:12:36.631275 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:36.631275 [debug] [MainThread]: On master: Close
[0m20:12:36.631275 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:12:36.631275 [info ] [MainThread]: 
[0m20:12:36.648020 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:12:36.649083 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:12:36.652086 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.analytics_dbt.my_first_dbt_model'
[0m20:12:36.653505 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:12:36.653505 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:12:36.661121 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 20:12:36.653505 => 20:12:36.661121
[0m20:12:36.661121 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:12:36.720049 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m20:12:36.720049 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:36.720049 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:12:36.720049 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:12:36.720049 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:12:36.734637 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:12:38.492890 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:12:38.494825 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:38.495825 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:12:38.820015 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:38.835666 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:12:38.835666 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:38.835666 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:12:39.545970 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:12:39.561513 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:39.561513 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:12:39.703060 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:39.718660 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m20:12:39.718660 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:39.718660 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m20:12:40.016295 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:40.031763 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:12:40.031763 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:40.031763 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:12:40.533847 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:12:40.549548 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:40.549548 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:12:40.691596 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:40.707072 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:40.707072 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:12:41.726917 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:12:41.757991 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:12:41.757991 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:41.757991 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:12:42.401258 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:12:42.401258 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:42.401258 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:12:42.698427 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:42.698427 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m20:12:42.698427 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:42.713753 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:12:42.997501 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:42.997501 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:12:42.997501 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:42.997501 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:12:43.162940 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:43.164522 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:43.165537 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:12:43.308890 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:43.308890 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 20:12:36.661121 => 20:12:43.308890
[0m20:12:43.308890 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:12:43.607861 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:12:43.607861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61615b28-9d94-4c6c-86b6-af59745b6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CF67BB00>]}
[0m20:12:43.607861 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 6.96s]
[0m20:12:43.607861 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:12:43.607861 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m20:12:43.607861 [info ] [Thread-1 (]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m20:12:43.607861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m20:12:43.622552 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m20:12:43.625561 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:12:43.627561 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 20:12:43.623564 => 20:12:43.627561
[0m20:12:43.628563 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m20:12:43.659563 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m20:12:43.668522 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:12:43.669119 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:12:43.669119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:43.669119 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:12:43.669119 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:12:45.347396 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:12:45.347396 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:12:45.347396 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales
),

renamed as (

    select 
        SALESID AS ID_VENDAS,
        LISTID AS ID_LISTA,
        SALLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMISSION AS COMISSAO,
        SALETIME AS DATA_VENDA
    
    from source_sales
)

SELECT * FROM renamed
  ) ;
[0m20:12:45.491170 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column "sallerid" does not exist in source_sales
[0m20:12:45.491170 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:12:45.765814 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 20:12:43.629562 => 20:12:45.765814
[0m20:12:45.765814 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m20:12:45.781292 [debug] [Thread-1 (]: Database Error in model vw_sales (models\views\vw_sales.sql)
  column "sallerid" does not exist in source_sales
  compiled Code at target\run\analytics_dbt\models\views\vw_sales.sql
[0m20:12:45.781292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61615b28-9d94-4c6c-86b6-af59745b6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CFC9ABD0>]}
[0m20:12:45.791389 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public.vw_sales ........................... [[31mERROR[0m in 2.17s]
[0m20:12:45.791389 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m20:12:45.791389 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:12:45.791389 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:12:45.798786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m20:12:45.798786 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:12:45.805937 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:12:45.806346 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 20:12:45.800927 => 20:12:45.806346
[0m20:12:45.806346 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:12:45.806346 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m20:12:45.820502 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:12:45.820502 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:12:45.820502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:45.820502 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:12:45.820502 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:12:47.529503 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:12:47.529503 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:12:47.544911 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m20:12:48.129132 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:12:48.135214 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:12:48.137133 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:12:48.563070 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:48.563070 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:12:48.563070 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:12:48.578465 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:12:49.189480 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:12:49.189480 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:12:49.189480 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:12:49.472716 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:49.488085 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m20:12:49.488085 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:12:49.488085 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:12:49.785835 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:49.785835 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:12:49.785835 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:12:49.785835 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:12:49.939444 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:49.939444 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:12:49.939444 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:12:50.092921 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:50.095937 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 20:12:45.806346 => 20:12:50.094950
[0m20:12:50.096928 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:12:50.384973 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:12:50.384973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61615b28-9d94-4c6c-86b6-af59745b6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258D0035940>]}
[0m20:12:50.384973 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 4.59s]
[0m20:12:50.384973 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:12:50.384973 [debug] [MainThread]: Using redshift connection "master"
[0m20:12:50.384973 [debug] [MainThread]: On master: BEGIN
[0m20:12:50.384973 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:12:50.384973 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:12:50.384973 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:12:51.652343 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:12:51.652343 [debug] [MainThread]: On master: COMMIT
[0m20:12:51.667924 [debug] [MainThread]: Using redshift connection "master"
[0m20:12:51.667924 [debug] [MainThread]: On master: COMMIT
[0m20:12:51.951478 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:51.953502 [debug] [MainThread]: On master: Close
[0m20:12:51.955517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:12:51.956475 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m20:12:51.957483 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m20:12:51.958480 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m20:12:51.959520 [info ] [MainThread]: 
[0m20:12:51.961805 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 22.68 seconds (22.68s).
[0m20:12:51.964421 [debug] [MainThread]: Command end result
[0m20:12:51.982421 [info ] [MainThread]: 
[0m20:12:51.984425 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:12:51.986425 [info ] [MainThread]: 
[0m20:12:51.987420 [error] [MainThread]:   Database Error in model vw_sales (models\views\vw_sales.sql)
  column "sallerid" does not exist in source_sales
  compiled Code at target\run\analytics_dbt\models\views\vw_sales.sql
[0m20:12:51.989705 [info ] [MainThread]: 
[0m20:12:51.989705 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:12:51.989705 [debug] [MainThread]: Command `dbt run` failed at 20:12:51.989705 after 24.86 seconds
[0m20:12:51.989705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CD0FA330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CF67BB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CF75F2F0>]}
[0m20:12:51.989705 [debug] [MainThread]: Flushing usage events
[0m20:13:05.788564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C2E16600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C2E16ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C2E16450>]}


============================== 20:13:05.804228 | 4ca0963e-3bfd-458b-bf1f-88c567877503 ==============================
[0m20:13:05.804228 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:13:05.804228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:13:06.304382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ca0963e-3bfd-458b-bf1f-88c567877503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C354FC80>]}
[0m20:13:06.383199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ca0963e-3bfd-458b-bf1f-88c567877503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C390D400>]}
[0m20:13:06.383199 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m20:13:06.402537 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:13:06.532950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:13:06.532950 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:13:06.548552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ca0963e-3bfd-458b-bf1f-88c567877503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C33E2B10>]}
[0m20:13:06.564583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ca0963e-3bfd-458b-bf1f-88c567877503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C3A3F920>]}
[0m20:13:06.564583 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:13:06.564583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ca0963e-3bfd-458b-bf1f-88c567877503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C2F43E00>]}
[0m20:13:06.564583 [info ] [MainThread]: 
[0m20:13:06.564583 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:13:06.564583 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m20:13:06.596072 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:13:06.597781 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m20:13:06.598848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:06.599973 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:13:06.599973 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:13:08.716569 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:13:08.716569 [debug] [ThreadPool]: On list_dev: Close
[0m20:13:08.732197 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m20:13:08.751581 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:13:08.752582 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:13:08.753575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:08.755573 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:13:08.756582 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:13:10.462683 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:13:10.462683 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:13:10.462683 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m20:13:10.763890 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:10.763890 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:13:11.041124 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:13:11.065964 [debug] [MainThread]: Using redshift connection "master"
[0m20:13:11.065964 [debug] [MainThread]: On master: BEGIN
[0m20:13:11.065964 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:13:11.065964 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:13:11.065964 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:13:12.782006 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m20:13:12.829166 [debug] [MainThread]: Using redshift connection "master"
[0m20:13:12.829166 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:13:13.157359 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:13.174049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ca0963e-3bfd-458b-bf1f-88c567877503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C3BB15E0>]}
[0m20:13:13.174049 [debug] [MainThread]: On master: ROLLBACK
[0m20:13:13.483299 [debug] [MainThread]: Using redshift connection "master"
[0m20:13:13.483299 [debug] [MainThread]: On master: BEGIN
[0m20:13:13.628950 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:13.628950 [debug] [MainThread]: On master: COMMIT
[0m20:13:13.628950 [debug] [MainThread]: Using redshift connection "master"
[0m20:13:13.628950 [debug] [MainThread]: On master: COMMIT
[0m20:13:13.926021 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:13.926021 [debug] [MainThread]: On master: Close
[0m20:13:13.926021 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:13:13.926021 [info ] [MainThread]: 
[0m20:13:13.944147 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:13:13.945162 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:13:13.948092 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.analytics_dbt.my_first_dbt_model'
[0m20:13:13.949999 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:13:13.953153 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:13:13.953153 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 20:13:13.951916 => 20:13:13.953153
[0m20:13:13.953153 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:13:14.022902 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m20:13:14.026982 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:14.028529 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:13:14.029539 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:13:14.030549 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:13:14.031844 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:13:15.281286 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:13:15.281286 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:15.281286 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:13:15.620606 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:15.620606 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:13:15.620606 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:15.620606 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:13:16.529937 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:13:16.529937 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:16.529937 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:13:16.686918 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:16.686918 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m20:13:16.702644 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:16.704301 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m20:13:16.999965 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:16.999965 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:13:16.999965 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:16.999965 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:13:17.501314 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:13:17.501314 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:17.501314 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:13:17.643043 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:17.658288 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:17.658288 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:13:18.671934 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:13:18.706498 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:13:18.707817 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:18.708829 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:13:19.381864 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:13:19.397656 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:19.397656 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:13:19.680693 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:19.680693 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m20:13:19.696020 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:19.697587 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:13:19.978054 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:19.978054 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:13:19.978054 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:19.993726 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:13:20.135719 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:20.135719 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:20.135719 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:13:20.292592 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:20.292592 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 20:13:13.953153 => 20:13:20.292592
[0m20:13:20.299649 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:13:20.589472 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:13:20.589472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ca0963e-3bfd-458b-bf1f-88c567877503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C39D6270>]}
[0m20:13:20.589472 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 6.64s]
[0m20:13:20.589472 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:13:20.589472 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m20:13:20.589472 [info ] [Thread-1 (]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m20:13:20.600488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m20:13:20.600488 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m20:13:20.605607 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:13:20.608294 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 20:13:20.600488 => 20:13:20.607283
[0m20:13:20.609360 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m20:13:20.636527 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m20:13:20.636527 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:13:20.636527 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:13:20.636527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:20.636527 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:13:20.649723 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:13:21.860621 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:13:21.860621 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:13:21.860621 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales
),

renamed as (

    select 
        SALESID AS ID_VENDAS,
        LISTID AS ID_LISTA,
        SALLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMISSION AS COMISSAO,
        SALETIME AS DATA_VENDA
    
    from source_sales
)

SELECT * FROM renamed
  ) ;
[0m20:13:22.006489 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column "sallerid" does not exist in source_sales
[0m20:13:22.006489 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:13:22.284728 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 20:13:20.610291 => 20:13:22.284728
[0m20:13:22.284728 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m20:13:22.284728 [debug] [Thread-1 (]: Database Error in model vw_sales (models\views\vw_sales.sql)
  column "sallerid" does not exist in source_sales
  compiled Code at target\run\analytics_dbt\models\views\vw_sales.sql
[0m20:13:22.284728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ca0963e-3bfd-458b-bf1f-88c567877503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C39F5370>]}
[0m20:13:22.300153 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public.vw_sales ........................... [[31mERROR[0m in 1.68s]
[0m20:13:22.300153 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m20:13:22.300153 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:13:22.300153 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:13:22.308589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m20:13:22.309654 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:13:22.316484 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:13:22.318551 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 20:13:22.310647 => 20:13:22.318551
[0m20:13:22.318551 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:13:22.318551 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m20:13:22.332025 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:13:22.333040 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:13:22.335043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:22.336035 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:13:22.338037 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:13:24.011469 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:13:24.011469 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:13:24.012981 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m20:13:24.566770 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:13:24.566770 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:13:24.566770 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:13:24.997387 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:24.997387 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:13:24.997387 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:13:24.997387 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:13:25.670611 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:13:25.670611 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:13:25.685966 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:13:25.951844 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:25.967515 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m20:13:25.967515 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:13:25.967515 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:13:26.256205 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:26.258404 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:13:26.259268 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:13:26.260485 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:13:26.406996 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:26.406996 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:13:26.406996 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:13:26.550443 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:26.552991 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 20:13:22.318551 => 20:13:26.551953
[0m20:13:26.553965 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:13:26.834358 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:13:26.836404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ca0963e-3bfd-458b-bf1f-88c567877503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C4212030>]}
[0m20:13:26.837432 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 4.53s]
[0m20:13:26.839816 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:13:26.842874 [debug] [MainThread]: Using redshift connection "master"
[0m20:13:26.844817 [debug] [MainThread]: On master: BEGIN
[0m20:13:26.845825 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:13:26.847818 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:13:26.848821 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:13:28.057082 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:13:28.058132 [debug] [MainThread]: On master: COMMIT
[0m20:13:28.059122 [debug] [MainThread]: Using redshift connection "master"
[0m20:13:28.060762 [debug] [MainThread]: On master: COMMIT
[0m20:13:28.333950 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:28.333950 [debug] [MainThread]: On master: Close
[0m20:13:28.333950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:13:28.333950 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m20:13:28.333950 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m20:13:28.333950 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m20:13:28.333950 [info ] [MainThread]: 
[0m20:13:28.333950 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 21.77 seconds (21.77s).
[0m20:13:28.349628 [debug] [MainThread]: Command end result
[0m20:13:28.349628 [info ] [MainThread]: 
[0m20:13:28.366757 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:13:28.368772 [info ] [MainThread]: 
[0m20:13:28.370780 [error] [MainThread]:   Database Error in model vw_sales (models\views\vw_sales.sql)
  column "sallerid" does not exist in source_sales
  compiled Code at target\run\analytics_dbt\models\views\vw_sales.sql
[0m20:13:28.373381 [info ] [MainThread]: 
[0m20:13:28.373381 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:13:28.373381 [debug] [MainThread]: Command `dbt run` failed at 20:13:28.373381 after 22.66 seconds
[0m20:13:28.382487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C2710830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C385F050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C2B86A80>]}
[0m20:13:28.383488 [debug] [MainThread]: Flushing usage events
[0m20:16:57.212209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5FF446A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5FF447B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5FF444D10>]}


============================== 20:16:57.212209 | e7d1fc16-9760-4fc5-bd2f-6fa99b905b4d ==============================
[0m20:16:57.212209 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:16:57.212209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:16:57.619400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7d1fc16-9760-4fc5-bd2f-6fa99b905b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5FFB46780>]}
[0m20:16:57.704035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7d1fc16-9760-4fc5-bd2f-6fa99b905b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5FFE39730>]}
[0m20:16:57.704035 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m20:16:57.722340 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:16:57.854749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:16:57.855751 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models\views\vw_sales.sql
[0m20:16:57.993558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7d1fc16-9760-4fc5-bd2f-6fa99b905b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5804B7B30>]}
[0m20:16:58.004570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7d1fc16-9760-4fc5-bd2f-6fa99b905b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5801344D0>]}
[0m20:16:58.009578 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:16:58.009578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7d1fc16-9760-4fc5-bd2f-6fa99b905b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5804F02C0>]}
[0m20:16:58.009578 [info ] [MainThread]: 
[0m20:16:58.009578 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:16:58.009578 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m20:16:58.040382 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:16:58.041316 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m20:16:58.042606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:58.042606 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:16:58.042606 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:16:59.957099 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:16:59.959144 [debug] [ThreadPool]: On list_dev: Close
[0m20:16:59.965358 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m20:16:59.978369 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:16:59.978369 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:16:59.984442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:59.986290 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:16:59.986290 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:17:01.291801 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:17:01.291801 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:17:01.291801 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m20:17:01.599774 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:01.599774 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:17:01.898911 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:17:01.919034 [debug] [MainThread]: Using redshift connection "master"
[0m20:17:01.919034 [debug] [MainThread]: On master: BEGIN
[0m20:17:01.919034 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:17:01.922458 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:17:01.922458 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:17:03.643237 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m20:17:03.643237 [debug] [MainThread]: Using redshift connection "master"
[0m20:17:03.643237 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:17:03.970593 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:03.985815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7d1fc16-9760-4fc5-bd2f-6fa99b905b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5808E5700>]}
[0m20:17:03.985815 [debug] [MainThread]: On master: ROLLBACK
[0m20:17:04.282099 [debug] [MainThread]: Using redshift connection "master"
[0m20:17:04.282099 [debug] [MainThread]: On master: BEGIN
[0m20:17:04.423804 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:04.423804 [debug] [MainThread]: On master: COMMIT
[0m20:17:04.423804 [debug] [MainThread]: Using redshift connection "master"
[0m20:17:04.423804 [debug] [MainThread]: On master: COMMIT
[0m20:17:04.716183 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:04.716183 [debug] [MainThread]: On master: Close
[0m20:17:04.719542 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:17:04.720551 [info ] [MainThread]: 
[0m20:17:04.727035 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:17:04.728006 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:17:04.730011 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.analytics_dbt.my_first_dbt_model'
[0m20:17:04.731009 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:17:04.735686 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:17:04.735686 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 20:17:04.732013 => 20:17:04.735686
[0m20:17:04.735686 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:17:04.786007 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m20:17:04.802591 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:04.802591 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:17:04.802591 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:17:04.802591 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:17:04.802591 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:17:06.540149 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:17:06.540149 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:06.540149 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:17:06.884019 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:06.884019 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:17:06.884019 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:06.884019 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:17:07.655820 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:17:07.655820 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:07.655820 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:17:07.812875 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:07.812875 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m20:17:07.827493 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:07.829096 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m20:17:08.124901 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:08.128411 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:17:08.128411 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:08.128411 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:17:08.642682 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:17:08.642682 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:08.642682 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:17:08.800014 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:08.800014 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:08.800014 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:17:09.865765 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:17:09.897358 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:17:09.897358 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:09.897358 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:17:10.512917 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:17:10.512917 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:10.528273 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:17:10.820056 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:10.820056 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m20:17:10.820056 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:10.820056 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:17:11.118651 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:11.118651 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:17:11.118651 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:11.118651 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:17:11.260910 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:11.276224 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:11.276224 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:17:11.418457 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:11.418457 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 20:17:04.735686 => 20:17:11.418457
[0m20:17:11.418457 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:17:11.713640 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:17:11.713640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d1fc16-9760-4fc5-bd2f-6fa99b905b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5805A8C20>]}
[0m20:17:11.728969 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 6.98s]
[0m20:17:11.728969 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:17:11.728969 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m20:17:11.728969 [info ] [Thread-1 (]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m20:17:11.737541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m20:17:11.738625 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m20:17:11.741687 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:17:11.741687 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 20:17:11.739674 => 20:17:11.741687
[0m20:17:11.741687 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m20:17:11.773774 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m20:17:11.779727 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:17:11.780728 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:17:11.781728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:11.782727 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:17:11.783753 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:17:13.487883 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:17:13.487883 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:17:13.487883 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales

),



renamed as (

    select 
        SALESID AS ID_VENDAS,
        LISTID AS ID_LISTA,
        SALLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMISSION AS COMISSAO,
        SALETIME AS DATA_VENDA
     from source_sales

)

SELECT * FROM renamed
  ) ;
[0m20:17:13.629941 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column "sallerid" does not exist in source_sales
[0m20:17:13.629941 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:17:13.909050 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 20:17:11.741687 => 20:17:13.909050
[0m20:17:13.924354 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m20:17:13.924354 [debug] [Thread-1 (]: Database Error in model vw_sales (models\views\vw_sales.sql)
  column "sallerid" does not exist in source_sales
  compiled Code at target\run\analytics_dbt\models\views\vw_sales.sql
[0m20:17:13.924354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d1fc16-9760-4fc5-bd2f-6fa99b905b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E580A2D1C0>]}
[0m20:17:13.924354 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public.vw_sales ........................... [[31mERROR[0m in 2.20s]
[0m20:17:13.924354 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m20:17:13.924354 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:17:13.924354 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:17:13.924354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m20:17:13.924354 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:17:13.943830 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:17:13.945761 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 20:17:13.924354 => 20:17:13.945761
[0m20:17:13.947711 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:17:13.954697 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m20:17:13.954697 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:17:13.954697 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:17:13.954697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:13.954697 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:17:13.954697 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:17:15.650567 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:17:15.650567 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:17:15.650567 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m20:17:16.216885 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:17:16.216885 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:17:16.216885 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:17:16.639024 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:16.654264 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:17:16.654264 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:17:16.654264 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:17:17.298759 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:17:17.298759 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:17:17.298759 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:17:17.578563 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:17.578563 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m20:17:17.594263 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:17:17.594263 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:17:17.865045 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:17.878569 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:17:17.878569 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:17:17.878569 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:17:18.018387 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:18.018387 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:17:18.033966 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:17:18.165524 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:18.176088 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 20:17:13.947711 => 20:17:18.176088
[0m20:17:18.176088 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:17:18.460476 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:17:18.460476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d1fc16-9760-4fc5-bd2f-6fa99b905b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E580A2CA40>]}
[0m20:17:18.460476 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 4.54s]
[0m20:17:18.466067 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:17:18.466067 [debug] [MainThread]: Using redshift connection "master"
[0m20:17:18.466067 [debug] [MainThread]: On master: BEGIN
[0m20:17:18.466067 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:17:18.466067 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:17:18.466067 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:17:20.180049 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m20:17:20.180049 [debug] [MainThread]: On master: COMMIT
[0m20:17:20.180049 [debug] [MainThread]: Using redshift connection "master"
[0m20:17:20.180049 [debug] [MainThread]: On master: COMMIT
[0m20:17:20.479569 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:20.479569 [debug] [MainThread]: On master: Close
[0m20:17:20.479569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:17:20.479569 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m20:17:20.479569 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m20:17:20.479569 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m20:17:20.479569 [info ] [MainThread]: 
[0m20:17:20.479569 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 22.47 seconds (22.47s).
[0m20:17:20.479569 [debug] [MainThread]: Command end result
[0m20:17:20.503391 [info ] [MainThread]: 
[0m20:17:20.503391 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:17:20.503391 [info ] [MainThread]: 
[0m20:17:20.503391 [error] [MainThread]:   Database Error in model vw_sales (models\views\vw_sales.sql)
  column "sallerid" does not exist in source_sales
  compiled Code at target\run\analytics_dbt\models\views\vw_sales.sql
[0m20:17:20.503391 [info ] [MainThread]: 
[0m20:17:20.503391 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:17:20.518265 [debug] [MainThread]: Command `dbt run` failed at 20:17:20.518265 after 23.38 seconds
[0m20:17:20.518265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5FF42F440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E580987E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E580A4B170>]}
[0m20:17:20.518265 [debug] [MainThread]: Flushing usage events
[0m20:19:32.818940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A050D35B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A050D36C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A050D35BB0>]}


============================== 20:19:32.818940 | 49b80da5-2013-4a89-a102-f17764501d1c ==============================
[0m20:19:32.818940 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:19:32.818940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:19:33.240602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49b80da5-2013-4a89-a102-f17764501d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0505EFC80>]}
[0m20:19:33.336381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49b80da5-2013-4a89-a102-f17764501d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A050D1AFC0>]}
[0m20:19:33.336381 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m20:19:33.356281 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:19:33.491042 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:19:33.491042 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models\views\vw_sales.sql
[0m20:19:33.663953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49b80da5-2013-4a89-a102-f17764501d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A050D1AFF0>]}
[0m20:19:33.679578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49b80da5-2013-4a89-a102-f17764501d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A051C380B0>]}
[0m20:19:33.679578 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:19:33.679578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49b80da5-2013-4a89-a102-f17764501d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0518CF4A0>]}
[0m20:19:33.679578 [info ] [MainThread]: 
[0m20:19:33.679578 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:19:33.696773 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m20:19:33.711752 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:19:33.711752 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m20:19:33.711752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:33.728761 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:19:33.729719 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:19:35.538764 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:19:35.541765 [debug] [ThreadPool]: On list_dev: Close
[0m20:19:35.546870 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m20:19:35.558938 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:19:35.558938 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:19:35.558938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:35.558938 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:19:35.558938 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:19:37.270918 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:19:37.270918 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:19:37.270918 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m20:19:37.570274 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:37.570274 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:19:37.853585 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:19:37.869336 [debug] [MainThread]: Using redshift connection "master"
[0m20:19:37.869336 [debug] [MainThread]: On master: BEGIN
[0m20:19:37.869336 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:19:37.869336 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:19:37.869336 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:19:39.091055 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:19:39.091055 [debug] [MainThread]: Using redshift connection "master"
[0m20:19:39.091055 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:19:39.422774 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:39.422774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49b80da5-2013-4a89-a102-f17764501d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05185E000>]}
[0m20:19:39.422774 [debug] [MainThread]: On master: ROLLBACK
[0m20:19:39.718382 [debug] [MainThread]: Using redshift connection "master"
[0m20:19:39.718382 [debug] [MainThread]: On master: BEGIN
[0m20:19:39.860252 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:39.875886 [debug] [MainThread]: On master: COMMIT
[0m20:19:39.875886 [debug] [MainThread]: Using redshift connection "master"
[0m20:19:39.875886 [debug] [MainThread]: On master: COMMIT
[0m20:19:40.157601 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:40.157601 [debug] [MainThread]: On master: Close
[0m20:19:40.157601 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:19:40.157601 [info ] [MainThread]: 
[0m20:19:40.157601 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:19:40.157601 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:19:40.174830 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.analytics_dbt.my_first_dbt_model'
[0m20:19:40.176889 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:19:40.181906 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:19:40.184458 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 20:19:40.177897 => 20:19:40.184458
[0m20:19:40.185701 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:19:40.292520 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m20:19:40.292520 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:40.292520 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:19:40.292520 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:19:40.308147 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:19:40.308147 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:19:41.584757 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:19:41.584757 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:41.584757 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:19:41.929305 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:41.929305 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:19:41.929305 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:41.929305 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:19:42.636701 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:19:42.636701 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:42.636701 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:19:42.776044 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:42.791164 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m20:19:42.791164 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:42.791164 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m20:19:43.091060 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:43.091060 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:19:43.091060 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:43.091060 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:19:43.624210 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:19:43.624210 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:43.624210 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:19:43.769420 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:43.781527 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:43.781527 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:19:44.799732 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:19:44.815155 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:19:44.815155 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:44.815155 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:19:45.425246 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:19:45.425246 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:45.425246 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:19:45.723065 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:45.723065 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m20:19:45.723065 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:45.723065 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:19:46.020959 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:46.020959 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:19:46.020959 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:46.020959 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:19:46.178434 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:46.178434 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:46.178434 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:19:46.328621 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:46.328621 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 20:19:40.186671 => 20:19:46.328621
[0m20:19:46.328621 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:19:46.617063 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:19:46.617063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49b80da5-2013-4a89-a102-f17764501d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A051FE2F90>]}
[0m20:19:46.632482 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 6.44s]
[0m20:19:46.632482 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:19:46.632482 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m20:19:46.632482 [info ] [Thread-1 (]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m20:19:46.632482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m20:19:46.632482 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m20:19:46.632482 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:19:46.632482 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 20:19:46.632482 => 20:19:46.632482
[0m20:19:46.632482 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m20:19:46.680137 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m20:19:46.680137 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:19:46.680137 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:19:46.680137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:46.680137 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:19:46.692396 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:19:47.935708 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:19:47.935708 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:19:47.951067 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales

),



renamed as (

    select 
        SALESID AS ID_VENDAS,
        LISTID AS ID_LISTA,
        SELLER AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        SALETIME AS DATA_VENDA
     from source_sales

)

SELECT * FROM renamed
  ) ;
[0m20:19:48.091050 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column "seller" does not exist in source_sales
[0m20:19:48.091050 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:19:48.390345 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 20:19:46.648073 => 20:19:48.390345
[0m20:19:48.390345 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m20:19:48.390345 [debug] [Thread-1 (]: Database Error in model vw_sales (models\views\vw_sales.sql)
  column "seller" does not exist in source_sales
  compiled Code at target\run\analytics_dbt\models\views\vw_sales.sql
[0m20:19:48.390345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49b80da5-2013-4a89-a102-f17764501d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05232AC60>]}
[0m20:19:48.390345 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public.vw_sales ........................... [[31mERROR[0m in 1.76s]
[0m20:19:48.390345 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m20:19:48.390345 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:19:48.405987 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:19:48.409382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m20:19:48.410399 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:19:48.414580 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:19:48.414580 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 20:19:48.411454 => 20:19:48.414580
[0m20:19:48.414580 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:19:48.428465 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m20:19:48.428465 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:19:48.428465 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:19:48.428465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:48.428465 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:19:48.428465 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:19:49.692573 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:19:49.692573 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:19:49.692573 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m20:19:50.286017 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:19:50.286017 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:19:50.294533 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:19:50.724652 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:50.724652 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:19:50.724652 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:19:50.724652 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:19:51.357071 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:19:51.357071 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:19:51.357071 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:19:51.656058 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:51.656058 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m20:19:51.656058 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:19:51.656058 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:19:51.948540 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:51.948540 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:19:51.948540 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:19:51.948540 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:19:52.105859 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:52.105859 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:19:52.105859 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:19:52.263516 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:52.263516 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 20:19:48.414580 => 20:19:52.263516
[0m20:19:52.263516 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:19:52.560452 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:19:52.560452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49b80da5-2013-4a89-a102-f17764501d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0522F1C40>]}
[0m20:19:52.560452 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 4.15s]
[0m20:19:52.560452 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:19:52.560452 [debug] [MainThread]: Using redshift connection "master"
[0m20:19:52.560452 [debug] [MainThread]: On master: BEGIN
[0m20:19:52.560452 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:19:52.560452 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:19:52.560452 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:19:54.240318 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m20:19:54.255626 [debug] [MainThread]: On master: COMMIT
[0m20:19:54.255626 [debug] [MainThread]: Using redshift connection "master"
[0m20:19:54.255626 [debug] [MainThread]: On master: COMMIT
[0m20:19:54.535330 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:54.535330 [debug] [MainThread]: On master: Close
[0m20:19:54.535330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:19:54.535330 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m20:19:54.535330 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m20:19:54.535330 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m20:19:54.535330 [info ] [MainThread]: 
[0m20:19:54.535330 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 20.86 seconds (20.86s).
[0m20:19:54.535330 [debug] [MainThread]: Command end result
[0m20:19:54.550719 [info ] [MainThread]: 
[0m20:19:54.550719 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:19:54.566627 [info ] [MainThread]: 
[0m20:19:54.568686 [error] [MainThread]:   Database Error in model vw_sales (models\views\vw_sales.sql)
  column "seller" does not exist in source_sales
  compiled Code at target\run\analytics_dbt\models\views\vw_sales.sql
[0m20:19:54.570628 [info ] [MainThread]: 
[0m20:19:54.574270 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:19:54.578311 [debug] [MainThread]: Command `dbt run` failed at 20:19:54.578311 after 21.83 seconds
[0m20:19:54.580293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A050D35B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A050D36C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05154C800>]}
[0m20:19:54.581009 [debug] [MainThread]: Flushing usage events
[0m20:20:27.759863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED9C27620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED9C27860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED9C26C60>]}


============================== 20:20:27.759863 | 9fabcc26-71bd-47d1-b822-3bee35ee8d2e ==============================
[0m20:20:27.759863 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:20:27.770872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:20:28.274439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fabcc26-71bd-47d1-b822-3bee35ee8d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED9C0B560>]}
[0m20:20:28.368563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fabcc26-71bd-47d1-b822-3bee35ee8d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED9A08E00>]}
[0m20:20:28.368563 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m20:20:28.392122 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:20:28.520568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:20:28.520568 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models\views\vw_sales.sql
[0m20:20:28.680867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fabcc26-71bd-47d1-b822-3bee35ee8d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EDA813170>]}
[0m20:20:28.696937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fabcc26-71bd-47d1-b822-3bee35ee8d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EDA944080>]}
[0m20:20:28.696937 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:20:28.696937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fabcc26-71bd-47d1-b822-3bee35ee8d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EDACB74A0>]}
[0m20:20:28.696937 [info ] [MainThread]: 
[0m20:20:28.696937 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:20:28.696937 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m20:20:28.725426 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:20:28.725426 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m20:20:28.725426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:28.742214 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:20:28.744131 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:20:30.898394 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:20:30.907065 [debug] [ThreadPool]: On list_dev: Close
[0m20:20:30.909595 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m20:20:30.928330 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:20:30.928330 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:20:30.928330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:30.928330 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:20:30.928330 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:20:32.857490 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:20:32.857490 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:20:32.859675 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m20:20:33.200828 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:33.200828 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:20:33.524787 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:20:33.559096 [debug] [MainThread]: Using redshift connection "master"
[0m20:20:33.559642 [debug] [MainThread]: On master: BEGIN
[0m20:20:33.559642 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:20:33.559642 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:20:33.559642 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:20:35.282196 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m20:20:35.283199 [debug] [MainThread]: Using redshift connection "master"
[0m20:20:35.284235 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:20:35.624339 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:35.629230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fabcc26-71bd-47d1-b822-3bee35ee8d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EDACB41A0>]}
[0m20:20:35.630218 [debug] [MainThread]: On master: ROLLBACK
[0m20:20:35.938914 [debug] [MainThread]: Using redshift connection "master"
[0m20:20:35.938914 [debug] [MainThread]: On master: BEGIN
[0m20:20:36.080658 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:36.080658 [debug] [MainThread]: On master: COMMIT
[0m20:20:36.080658 [debug] [MainThread]: Using redshift connection "master"
[0m20:20:36.080658 [debug] [MainThread]: On master: COMMIT
[0m20:20:36.369228 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:36.384544 [debug] [MainThread]: On master: Close
[0m20:20:36.384544 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:20:36.384544 [info ] [MainThread]: 
[0m20:20:36.384544 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:20:36.384544 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:20:36.400733 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.analytics_dbt.my_first_dbt_model'
[0m20:20:36.401789 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:20:36.407723 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:20:36.407723 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 20:20:36.402792 => 20:20:36.407723
[0m20:20:36.407723 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:20:36.473580 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m20:20:36.473580 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:36.473580 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:20:36.473580 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:20:36.473580 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:20:36.473580 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:20:39.086616 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m20:20:39.088599 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:39.089602 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:20:39.461923 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:39.461923 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:20:39.461923 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:39.461923 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:20:40.251640 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:20:40.251640 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:40.251640 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:20:40.424353 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:40.439991 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m20:20:40.455968 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:40.457727 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m20:20:40.795712 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:40.798712 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:20:40.800710 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:40.800710 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:20:41.333796 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:20:41.333796 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:41.333796 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:20:42.246425 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:20:42.246425 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:42.246425 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:20:43.402800 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:20:43.434251 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:20:43.434251 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:43.434251 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:20:44.133613 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:20:44.133613 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:44.133613 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:20:44.472159 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:44.472763 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m20:20:44.472763 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:44.472763 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:20:44.817344 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:44.817344 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:20:44.817344 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:44.817344 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:20:44.987218 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:44.987218 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:44.987218 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:20:45.154058 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:45.154058 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 20:20:36.407723 => 20:20:45.154058
[0m20:20:45.154058 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:20:45.504335 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:20:45.504335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fabcc26-71bd-47d1-b822-3bee35ee8d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EDB0E3DA0>]}
[0m20:20:45.504335 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 9.12s]
[0m20:20:45.504335 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:20:45.504335 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m20:20:45.504335 [info ] [Thread-1 (]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m20:20:45.504335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m20:20:45.517449 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m20:20:45.520508 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:20:45.522531 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 20:20:45.518477 => 20:20:45.522531
[0m20:20:45.523461 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m20:20:45.557784 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m20:20:45.557784 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:20:45.557784 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:20:45.557784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:45.557784 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:20:45.557784 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:20:47.467608 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:20:47.467608 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:20:47.467608 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales

),



renamed as (

    select 
        SALESID AS ID_VENDAS,
        LISTID AS ID_LISTA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        SALETIME AS DATA_VENDA
     from source_sales

)

SELECT * FROM renamed
  ) ;
[0m20:20:48.148330 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:20:48.153404 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:20:48.153404 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m20:20:48.666516 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:20:48.670589 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:20:48.671395 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:20:48.671395 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:20:49.385631 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:20:49.385631 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:20:49.385631 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:20:49.720203 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:49.721303 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales__dbt_backup"
[0m20:20:49.721303 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:20:49.721303 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m20:20:50.071381 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:50.074404 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:20:50.076394 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:20:50.077422 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:20:50.240740 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:50.240740 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:20:50.240740 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:20:50.401617 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:50.416638 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 20:20:45.524480 => 20:20:50.416638
[0m20:20:50.416638 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:20:50.756933 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m20:20:50.756933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fabcc26-71bd-47d1-b822-3bee35ee8d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EDB22FD40>]}
[0m20:20:50.756933 [info ] [Thread-1 (]: 2 of 3 OK created sql view model public.vw_sales ............................... [[32mSUCCESS[0m in 5.25s]
[0m20:20:50.765940 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m20:20:50.766924 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:20:50.766924 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:20:50.772938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m20:20:50.774745 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:20:50.774745 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:20:50.774745 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 20:20:50.774745 => 20:20:50.774745
[0m20:20:50.774745 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:20:50.787611 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m20:20:50.790814 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:20:50.790814 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:20:50.790814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:50.790814 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:20:50.790814 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:20:52.104932 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:20:52.106925 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:20:52.107980 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m20:20:52.689652 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:20:52.698324 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:20:52.698324 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:20:53.122591 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:53.139349 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:20:53.139349 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:20:53.139349 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:20:53.781661 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:20:53.786255 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:20:53.786255 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:20:54.078397 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:54.078397 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m20:20:54.086540 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:20:54.086540 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:20:54.376976 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:54.382619 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:20:54.382619 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:20:54.382619 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:20:54.536580 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:54.536917 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:20:54.536917 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:20:54.686374 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:54.686374 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 20:20:50.774745 => 20:20:54.686374
[0m20:20:54.686374 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:20:54.977012 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:20:54.977012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fabcc26-71bd-47d1-b822-3bee35ee8d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EDB25DF10>]}
[0m20:20:54.986902 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 4.21s]
[0m20:20:54.986902 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:20:54.991445 [debug] [MainThread]: Using redshift connection "master"
[0m20:20:54.991445 [debug] [MainThread]: On master: BEGIN
[0m20:20:54.991445 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:20:54.996471 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:20:54.996471 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:20:56.712744 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m20:20:56.716843 [debug] [MainThread]: On master: COMMIT
[0m20:20:56.716843 [debug] [MainThread]: Using redshift connection "master"
[0m20:20:56.716843 [debug] [MainThread]: On master: COMMIT
[0m20:20:57.006415 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:57.006415 [debug] [MainThread]: On master: Close
[0m20:20:57.006415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:57.006415 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m20:20:57.006415 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m20:20:57.006415 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m20:20:57.016808 [info ] [MainThread]: 
[0m20:20:57.016808 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 28.32 seconds (28.32s).
[0m20:20:57.016808 [debug] [MainThread]: Command end result
[0m20:20:57.046586 [info ] [MainThread]: 
[0m20:20:57.046586 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:20:57.046586 [info ] [MainThread]: 
[0m20:20:57.054847 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:20:57.056319 [debug] [MainThread]: Command `dbt run` succeeded at 20:20:57.056319 after 29.38 seconds
[0m20:20:57.056319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED95718B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED9CEAF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED94EFF80>]}
[0m20:20:57.056319 [debug] [MainThread]: Flushing usage events
[0m20:35:14.888830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C916117C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C916116BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C916116480>]}


============================== 20:35:14.894350 | a02eb81a-2fef-4e54-8eed-c594ec8b31e7 ==============================
[0m20:35:14.894350 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:35:14.895887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models views/vw_sales.sql', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:35:15.394250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a02eb81a-2fef-4e54-8eed-c594ec8b31e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C916B9CD40>]}
[0m20:35:15.501948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a02eb81a-2fef-4e54-8eed-c594ec8b31e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C916153320>]}
[0m20:35:15.504573 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m20:35:15.525783 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:35:15.679307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:35:15.679307 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:35:15.690487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a02eb81a-2fef-4e54-8eed-c594ec8b31e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C916116690>]}
[0m20:35:15.709178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a02eb81a-2fef-4e54-8eed-c594ec8b31e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C916D38200>]}
[0m20:35:15.709178 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:35:15.714196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a02eb81a-2fef-4e54-8eed-c594ec8b31e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9153B9430>]}
[0m20:35:15.714285 [warn ] [MainThread]: The selection criterion 'views/vw_sales.sql' does not match any nodes
[0m20:35:15.718688 [info ] [MainThread]: 
[0m20:35:15.721636 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:35:15.724185 [debug] [MainThread]: Command end result
[0m20:35:15.744341 [debug] [MainThread]: Command `dbt run` succeeded at 20:35:15.744341 after 0.95 seconds
[0m20:35:15.744341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9161D81A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C916773290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C916B17B00>]}
[0m20:35:15.749413 [debug] [MainThread]: Flushing usage events
[0m20:44:33.774513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F3DBE420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F3F26A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F3F26540>]}


============================== 20:44:33.782043 | 2ced4205-85cf-46bd-962d-d28d7ded5796 ==============================
[0m20:44:33.782043 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:44:33.784423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models views/vw_sales.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:44:34.290425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ced4205-85cf-46bd-962d-d28d7ded5796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F4A583B0>]}
[0m20:44:34.410943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ced4205-85cf-46bd-962d-d28d7ded5796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F45A77D0>]}
[0m20:44:34.415466 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m20:44:34.436879 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:44:34.626667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:44:34.627648 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models\views\vw_sales.sql
[0m20:44:34.806090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ced4205-85cf-46bd-962d-d28d7ded5796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F4ACB680>]}
[0m20:44:34.823342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ced4205-85cf-46bd-962d-d28d7ded5796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F4E3C080>]}
[0m20:44:34.824340 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:44:34.825923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ced4205-85cf-46bd-962d-d28d7ded5796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F4E3C170>]}
[0m20:44:34.827859 [warn ] [MainThread]: The selection criterion 'views/vw_sales.sql' does not match any nodes
[0m20:44:34.830868 [info ] [MainThread]: 
[0m20:44:34.833872 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:44:34.836380 [debug] [MainThread]: Command end result
[0m20:44:34.858006 [debug] [MainThread]: Command `dbt run` succeeded at 20:44:34.857002 after 1.17 seconds
[0m20:44:34.859258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F3E58950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F3CA1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F3DBE420>]}
[0m20:44:34.860306 [debug] [MainThread]: Flushing usage events
[0m20:45:37.735789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B790A17DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B790A15FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B790A16390>]}


============================== 20:45:37.740841 | f4c2f545-b539-4484-aaaa-0b8338f6cc37 ==============================
[0m20:45:37.740841 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:45:37.740841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:45:38.236184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4c2f545-b539-4484-aaaa-0b8338f6cc37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7909FB050>]}
[0m20:45:38.344504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4c2f545-b539-4484-aaaa-0b8338f6cc37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B791443C20>]}
[0m20:45:38.347031 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m20:45:38.363401 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:45:38.519368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:45:38.521306 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:45:38.529263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4c2f545-b539-4484-aaaa-0b8338f6cc37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B79153ABD0>]}
[0m20:45:38.544655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4c2f545-b539-4484-aaaa-0b8338f6cc37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B791637D10>]}
[0m20:45:38.546021 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:45:38.549027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4c2f545-b539-4484-aaaa-0b8338f6cc37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B791637E30>]}
[0m20:45:38.551338 [info ] [MainThread]: 
[0m20:45:38.554297 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:45:38.557880 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m20:45:38.588367 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:45:38.590519 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m20:45:38.592041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:38.596741 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:45:38.599452 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:45:40.487046 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:45:40.490043 [debug] [ThreadPool]: On list_dev: Close
[0m20:45:40.495290 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m20:45:40.505585 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:45:40.512183 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:45:40.514186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:40.515695 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:45:40.517707 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:45:42.305510 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:45:42.312652 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:45:42.314657 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m20:45:42.622928 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:42.624923 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:45:42.923884 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:45:42.936155 [debug] [MainThread]: Using redshift connection "master"
[0m20:45:42.936155 [debug] [MainThread]: On master: BEGIN
[0m20:45:42.936155 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:45:42.936155 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:45:42.936155 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:45:44.221614 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:45:44.222572 [debug] [MainThread]: Using redshift connection "master"
[0m20:45:44.223567 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:45:44.566095 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:44.566095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4c2f545-b539-4484-aaaa-0b8338f6cc37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7917B1760>]}
[0m20:45:44.566095 [debug] [MainThread]: On master: ROLLBACK
[0m20:45:44.884725 [debug] [MainThread]: Using redshift connection "master"
[0m20:45:44.887237 [debug] [MainThread]: On master: BEGIN
[0m20:45:45.028778 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:45.028778 [debug] [MainThread]: On master: COMMIT
[0m20:45:45.035953 [debug] [MainThread]: Using redshift connection "master"
[0m20:45:45.035953 [debug] [MainThread]: On master: COMMIT
[0m20:45:45.326746 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:45.328690 [debug] [MainThread]: On master: Close
[0m20:45:45.329987 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:45:45.333362 [info ] [MainThread]: 
[0m20:45:45.335874 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:45:45.335874 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:45:45.335874 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.analytics_dbt.my_first_dbt_model'
[0m20:45:45.345641 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:45:45.351653 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:45:45.355682 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 20:45:45.346689 => 20:45:45.354682
[0m20:45:45.357008 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:45:45.440933 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m20:45:45.446969 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:45.447990 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:45:45.449576 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:45:45.450589 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:45:45.451470 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:45:46.666200 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:45:46.675889 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:46.677418 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:45:47.006689 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:47.012148 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:45:47.013870 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:47.014888 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:45:48.067268 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:45:48.067268 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:48.067268 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:45:48.215056 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:48.223678 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m20:45:48.228812 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:48.228812 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m20:45:48.517852 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:48.520523 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:45:48.521520 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:48.522520 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:45:48.996172 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:48.996172 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:48.996172 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:45:49.136162 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:49.151910 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:49.153904 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:45:50.128212 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:45:50.159621 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:45:50.160567 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:50.161426 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:45:50.719980 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:45:50.721991 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:50.723047 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:45:50.996257 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:51.005893 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m20:45:51.011401 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:51.013189 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:45:51.294898 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:51.299042 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:45:51.300045 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:51.301871 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:45:51.445756 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:51.445756 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:51.445756 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:45:51.585996 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:51.593709 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 20:45:45.358033 => 20:45:51.593709
[0m20:45:51.595959 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:45:51.876242 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:45:51.878491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4c2f545-b539-4484-aaaa-0b8338f6cc37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7915F6A50>]}
[0m20:45:51.879696 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 6.54s]
[0m20:45:51.879696 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:45:51.879696 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m20:45:51.885946 [info ] [Thread-1 (]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m20:45:51.889238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m20:45:51.891257 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m20:45:51.896870 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:45:51.900821 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 20:45:51.891344 => 20:45:51.899853
[0m20:45:51.902112 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m20:45:51.935693 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m20:45:51.940213 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:45:51.941215 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:45:51.942720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:51.943730 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:45:51.946690 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:45:53.178371 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:45:53.239757 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:45:53.241656 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales

),



renamed as (

    select 
        SALESID AS ID_VENDAS,
        LISTID AS ID_LISTA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        cast(SALETIME as date) AS DATA_VENDA,
        to_char( SALETIME, 'dd/mm/yyy hh24:mi:ss') as DATA_HORA_VENDA,
        to_char( SALETIME, 'hh24:mi:ss') as HORA_VENDA,
     from source_sales

)

SELECT * FROM renamed
  ) ;
[0m20:45:53.386166 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near "from"
[0m20:45:53.386166 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:45:53.672481 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 20:45:51.903123 => 20:45:53.671335
[0m20:45:53.673405 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m20:45:53.678306 [debug] [Thread-1 (]: Database Error in model vw_sales (models\views\vw_sales.sql)
  syntax error at or near "from"
  compiled Code at target\run\analytics_dbt\models\views\vw_sales.sql
[0m20:45:53.678306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4c2f545-b539-4484-aaaa-0b8338f6cc37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B791187BF0>]}
[0m20:45:53.678306 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public.vw_sales ........................... [[31mERROR[0m in 1.79s]
[0m20:45:53.685870 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m20:45:53.685870 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:45:53.685870 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:45:53.691460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m20:45:53.692471 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:45:53.700853 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:45:53.702805 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 20:45:53.694763 => 20:45:53.702805
[0m20:45:53.704242 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:45:53.715776 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m20:45:53.720304 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:45:53.720304 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:45:53.720304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:53.720304 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:45:53.725935 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:45:54.946381 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:45:54.946381 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:45:54.946381 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m20:45:55.511680 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:45:55.515813 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:45:55.515813 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:45:55.937585 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:55.941387 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:45:55.942435 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:45:55.943388 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:45:56.565695 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:45:56.567388 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:45:56.568455 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:45:56.845998 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:56.845998 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m20:45:56.861252 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:45:56.863553 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:45:57.142547 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:57.144879 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:45:57.146107 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:45:57.146107 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:45:57.294926 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:57.296123 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:45:57.296123 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:45:57.436220 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:57.436220 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 20:45:53.705252 => 20:45:57.436220
[0m20:45:57.436220 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:45:57.722154 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:45:57.724700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4c2f545-b539-4484-aaaa-0b8338f6cc37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B791E744A0>]}
[0m20:45:57.725698 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 4.04s]
[0m20:45:57.728209 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:45:57.728209 [debug] [MainThread]: Using redshift connection "master"
[0m20:45:57.728209 [debug] [MainThread]: On master: BEGIN
[0m20:45:57.728209 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:45:57.735784 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:45:57.735784 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:45:59.016431 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:45:59.016431 [debug] [MainThread]: On master: COMMIT
[0m20:45:59.016431 [debug] [MainThread]: Using redshift connection "master"
[0m20:45:59.016431 [debug] [MainThread]: On master: COMMIT
[0m20:45:59.311079 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:59.315783 [debug] [MainThread]: On master: Close
[0m20:45:59.315783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:45:59.315783 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m20:45:59.315783 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m20:45:59.315783 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m20:45:59.315783 [info ] [MainThread]: 
[0m20:45:59.315783 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 20.76 seconds (20.76s).
[0m20:45:59.325872 [debug] [MainThread]: Command end result
[0m20:45:59.347674 [info ] [MainThread]: 
[0m20:45:59.347674 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:45:59.347674 [info ] [MainThread]: 
[0m20:45:59.347674 [error] [MainThread]:   Database Error in model vw_sales (models\views\vw_sales.sql)
  syntax error at or near "from"
  compiled Code at target\run\analytics_dbt\models\views\vw_sales.sql
[0m20:45:59.355750 [info ] [MainThread]: 
[0m20:45:59.355750 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:45:59.363851 [debug] [MainThread]: Command `dbt run` failed at 20:45:59.362838 after 21.71 seconds
[0m20:45:59.366399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B790B67080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B79034EA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7915F6C00>]}
[0m20:45:59.367928 [debug] [MainThread]: Flushing usage events
[0m20:46:14.066954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BB416210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BB4166C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BB4168D0>]}


============================== 20:46:14.066954 | 15b73c31-fa7b-4d43-9fb2-603886ac6427 ==============================
[0m20:46:14.066954 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:46:14.066954 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:46:14.474375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15b73c31-fa7b-4d43-9fb2-603886ac6427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BB3485C0>]}
[0m20:46:14.552902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15b73c31-fa7b-4d43-9fb2-603886ac6427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BBB4F860>]}
[0m20:46:14.552902 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m20:46:14.579624 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:46:14.703471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:46:14.708484 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models\views\vw_sales.sql
[0m20:46:14.834290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15b73c31-fa7b-4d43-9fb2-603886ac6427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BC3F9E50>]}
[0m20:46:14.849912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15b73c31-fa7b-4d43-9fb2-603886ac6427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BC25ECF0>]}
[0m20:46:14.849912 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:46:14.865540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15b73c31-fa7b-4d43-9fb2-603886ac6427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BC25F1D0>]}
[0m20:46:14.865540 [info ] [MainThread]: 
[0m20:46:14.871521 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:46:14.873332 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m20:46:14.895406 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:46:14.896406 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m20:46:14.897401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:14.903936 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:46:14.903936 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:46:17.122457 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:46:17.126289 [debug] [ThreadPool]: On list_dev: Close
[0m20:46:17.132290 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m20:46:17.147290 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:46:17.149289 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:46:17.150288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:17.152290 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:46:17.153288 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:46:18.937749 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:46:18.937749 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:46:18.937749 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m20:46:19.242134 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:19.242134 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:46:19.541186 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:46:19.556631 [debug] [MainThread]: Using redshift connection "master"
[0m20:46:19.556631 [debug] [MainThread]: On master: BEGIN
[0m20:46:19.556631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:46:19.556631 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:46:19.556631 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:46:20.825453 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:20.825453 [debug] [MainThread]: Using redshift connection "master"
[0m20:46:20.825453 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:46:21.171948 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:21.171948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15b73c31-fa7b-4d43-9fb2-603886ac6427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BC5E5E20>]}
[0m20:46:21.171948 [debug] [MainThread]: On master: ROLLBACK
[0m20:46:21.483184 [debug] [MainThread]: Using redshift connection "master"
[0m20:46:21.498727 [debug] [MainThread]: On master: BEGIN
[0m20:46:21.640433 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:21.640433 [debug] [MainThread]: On master: COMMIT
[0m20:46:21.640433 [debug] [MainThread]: Using redshift connection "master"
[0m20:46:21.640433 [debug] [MainThread]: On master: COMMIT
[0m20:46:21.937399 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:21.937399 [debug] [MainThread]: On master: Close
[0m20:46:21.937399 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:46:21.937399 [info ] [MainThread]: 
[0m20:46:21.955253 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:46:21.957255 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:46:21.959252 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.analytics_dbt.my_first_dbt_model'
[0m20:46:21.961431 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:46:21.961431 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:46:21.961431 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 20:46:21.961431 => 20:46:21.961431
[0m20:46:21.961431 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:46:22.027905 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m20:46:22.043842 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:22.043842 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:46:22.043842 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:46:22.043842 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:46:22.043842 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:46:23.271466 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:23.271466 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:23.271466 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:46:23.600573 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:23.600573 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:46:23.600573 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:23.600573 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:46:24.284738 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:24.284738 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:24.284738 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:46:24.426676 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:24.426676 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m20:46:24.442302 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:24.442302 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m20:46:24.730383 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:24.730383 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:46:24.730383 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:24.730383 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:46:25.231960 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:25.231960 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:25.231960 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:46:25.373238 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:25.373238 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:25.373238 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:46:26.360411 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:26.376038 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:46:26.376038 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:26.376038 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:46:27.003854 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:27.003854 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:27.003854 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:46:27.286014 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:27.286014 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m20:46:27.286014 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:27.286014 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:46:27.568623 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:27.568623 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:46:27.568623 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:27.584248 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:46:27.724675 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:27.724675 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:27.724675 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:46:27.866503 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:27.866503 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 20:46:21.961431 => 20:46:27.866503
[0m20:46:27.866503 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:46:28.149463 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:46:28.149463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15b73c31-fa7b-4d43-9fb2-603886ac6427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BC3225A0>]}
[0m20:46:28.149463 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 6.19s]
[0m20:46:28.149463 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:46:28.149463 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m20:46:28.165146 [info ] [Thread-1 (]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m20:46:28.165146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m20:46:28.169384 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m20:46:28.173400 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:46:28.176401 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 20:46:28.170400 => 20:46:28.176401
[0m20:46:28.178396 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m20:46:28.195871 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m20:46:28.214480 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:28.215463 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:46:28.217756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:28.217756 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:46:28.217756 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:46:29.432998 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:29.432998 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:29.449026 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales

),



renamed as (

    select 
        SALESID AS ID_VENDAS,
        LISTID AS ID_LISTA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        cast(SALETIME as date) AS DATA_VENDA,
        to_char( SALETIME, 'dd/mm/yyy hh24:mi:ss') as DATA_HORA_VENDA,
        to_char( SALETIME, 'hh24:mi:ss') as HORA_VENDA
     from source_sales

)

SELECT * FROM renamed
  ) ;
[0m20:46:30.015184 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:30.017359 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:46:30.018357 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:30.019356 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:46:30.672740 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:30.672740 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:30.672740 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:46:30.955003 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:30.955003 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales"
[0m20:46:30.970750 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:30.970750 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales" cascade
[0m20:46:31.254094 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:31.254094 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:46:31.254094 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:31.254094 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:46:31.753877 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:31.753877 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:31.753877 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:46:31.897833 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:31.897833 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:31.897833 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m20:46:32.742735 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:32.742735 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:46:32.742735 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:32.742735 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:46:33.369424 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:33.369424 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:33.369424 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:46:33.652241 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:33.652241 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales__dbt_backup"
[0m20:46:33.652241 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:33.662307 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m20:46:33.935636 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:33.935636 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:46:33.935636 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:33.935636 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:46:34.089864 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:34.089864 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:34.089864 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:46:34.231227 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:34.231227 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 20:46:28.180415 => 20:46:34.231227
[0m20:46:34.231227 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:46:34.514421 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m20:46:34.514421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15b73c31-fa7b-4d43-9fb2-603886ac6427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BC8E9730>]}
[0m20:46:34.565104 [info ] [Thread-1 (]: 2 of 3 OK created sql view model public.vw_sales ............................... [[32mSUCCESS[0m in 6.35s]
[0m20:46:34.568694 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m20:46:34.569758 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:46:34.570747 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:46:34.573695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m20:46:34.575510 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:46:34.577759 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:46:34.577759 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 20:46:34.577520 => 20:46:34.577759
[0m20:46:34.577759 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:46:34.577759 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m20:46:34.594251 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:46:34.596214 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:46:34.597212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:34.599214 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:46:34.599939 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:46:36.284916 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:46:36.284916 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:46:36.284916 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m20:46:36.851526 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:36.851526 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:46:36.851526 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:46:37.277432 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:37.277432 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:46:37.277432 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:46:37.277432 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:46:37.900842 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:37.900842 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:46:37.900842 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:46:38.183838 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:38.183838 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m20:46:38.183838 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:46:38.183838 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:46:38.465520 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:38.465520 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:46:38.465520 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:46:38.465520 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:46:38.623082 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:38.623082 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:46:38.623082 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:46:38.764545 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:38.764545 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 20:46:34.577759 => 20:46:38.764545
[0m20:46:38.764545 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:46:39.045798 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:46:39.045798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15b73c31-fa7b-4d43-9fb2-603886ac6427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BC87BA40>]}
[0m20:46:39.045798 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 4.47s]
[0m20:46:39.061211 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:46:39.061211 [debug] [MainThread]: Using redshift connection "master"
[0m20:46:39.061211 [debug] [MainThread]: On master: BEGIN
[0m20:46:39.061211 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:46:39.061211 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:46:39.061211 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:46:40.818454 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m20:46:40.818454 [debug] [MainThread]: On master: COMMIT
[0m20:46:40.818454 [debug] [MainThread]: Using redshift connection "master"
[0m20:46:40.818454 [debug] [MainThread]: On master: COMMIT
[0m20:46:41.114756 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:41.114756 [debug] [MainThread]: On master: Close
[0m20:46:41.114756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:46:41.114756 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m20:46:41.114756 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m20:46:41.114756 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m20:46:41.114756 [info ] [MainThread]: 
[0m20:46:41.130389 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 26.25 seconds (26.25s).
[0m20:46:41.130389 [debug] [MainThread]: Command end result
[0m20:46:41.218336 [info ] [MainThread]: 
[0m20:46:41.220320 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:46:41.221318 [info ] [MainThread]: 
[0m20:46:41.223318 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:46:41.226343 [debug] [MainThread]: Command `dbt run` succeeded at 20:46:41.226343 after 27.23 seconds
[0m20:46:41.227348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BC3B5D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BA02A900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BA0540B0>]}
[0m20:46:41.228351 [debug] [MainThread]: Flushing usage events
[0m21:48:23.986092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12F316450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12F315E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12F3158B0>]}


============================== 21:48:24.011772 | 6f78b02b-36f1-48d7-86a2-ea652ba69b9d ==============================
[0m21:48:24.011772 [info ] [MainThread]: Running with dbt=1.7.3
[0m21:48:24.015789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:48:24.745418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f78b02b-36f1-48d7-86a2-ea652ba69b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12FC4FC80>]}
[0m21:48:24.896496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f78b02b-36f1-48d7-86a2-ea652ba69b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12FEB2BD0>]}
[0m21:48:24.916882 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:48:24.957100 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m21:48:24.982231 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:48:24.986271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6f78b02b-36f1-48d7-86a2-ea652ba69b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12FE72B40>]}
[0m21:48:27.349863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f78b02b-36f1-48d7-86a2-ea652ba69b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12FEFDF10>]}
[0m21:48:27.370216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f78b02b-36f1-48d7-86a2-ea652ba69b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12FFB7E60>]}
[0m21:48:27.371806 [info ] [MainThread]: Found 4 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:48:27.372882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f78b02b-36f1-48d7-86a2-ea652ba69b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1302E5430>]}
[0m21:48:27.375902 [info ] [MainThread]: 
[0m21:48:27.378460 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:48:27.382048 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m21:48:27.416608 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m21:48:27.419542 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m21:48:27.419542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:27.428210 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:48:27.429216 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:48:31.051489 [debug] [ThreadPool]: SQL status: SUCCESS in 4.0 seconds
[0m21:48:31.072724 [debug] [ThreadPool]: On list_dev: Close
[0m21:48:31.080782 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m21:48:31.096918 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m21:48:31.098933 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m21:48:31.100624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:31.102713 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:48:31.102859 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:48:33.291218 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m21:48:33.292750 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m21:48:33.294769 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m21:48:33.603621 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:33.622702 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m21:48:33.927300 [debug] [ThreadPool]: On list_dev_public: Close
[0m21:48:33.973681 [debug] [MainThread]: Using redshift connection "master"
[0m21:48:33.974684 [debug] [MainThread]: On master: BEGIN
[0m21:48:33.975681 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:48:33.976682 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:48:33.977682 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:48:35.501526 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m21:48:35.501526 [debug] [MainThread]: Using redshift connection "master"
[0m21:48:35.505165 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:48:35.962238 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:35.983463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f78b02b-36f1-48d7-86a2-ea652ba69b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12FFF0980>]}
[0m21:48:35.984467 [debug] [MainThread]: On master: ROLLBACK
[0m21:48:36.481367 [debug] [MainThread]: Using redshift connection "master"
[0m21:48:36.483726 [debug] [MainThread]: On master: BEGIN
[0m21:48:36.703391 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:36.719684 [debug] [MainThread]: On master: COMMIT
[0m21:48:36.723321 [debug] [MainThread]: Using redshift connection "master"
[0m21:48:36.726340 [debug] [MainThread]: On master: COMMIT
[0m21:48:37.012774 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:37.026793 [debug] [MainThread]: On master: Close
[0m21:48:37.032093 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:48:37.036474 [info ] [MainThread]: 
[0m21:48:37.053439 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m21:48:37.057620 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m21:48:37.062161 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.analytics_dbt.my_first_dbt_model'
[0m21:48:37.067315 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m21:48:37.078468 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m21:48:37.085463 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 21:48:37.069594 => 21:48:37.083411
[0m21:48:37.088012 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m21:48:37.274713 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m21:48:37.281413 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:37.284462 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m21:48:37.285435 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:48:37.287979 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:48:37.290010 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:48:38.609908 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:38.627711 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:38.629734 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m21:48:38.963396 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:38.971491 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m21:48:38.973506 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:38.975547 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m21:48:39.733873 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:39.736872 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:39.738872 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m21:48:39.887397 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:39.920234 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m21:48:39.942013 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:39.944075 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m21:48:40.242733 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:40.262701 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m21:48:40.262701 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:40.268794 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m21:48:40.834555 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:40.856336 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:40.858424 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m21:48:41.170098 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:41.189257 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:41.190259 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:48:43.546131 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m21:48:43.598347 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m21:48:43.599225 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:43.601277 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m21:48:44.564441 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:44.582583 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:44.584498 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m21:48:45.324049 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:45.347716 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m21:48:45.350219 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:45.352395 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m21:48:46.135668 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:46.153574 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m21:48:46.155573 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:46.156574 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m21:48:46.348373 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:46.366680 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:46.367681 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m21:48:46.653239 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:46.653239 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 21:48:37.088636 => 21:48:46.653239
[0m21:48:46.653239 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m21:48:46.949563 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m21:48:46.968159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f78b02b-36f1-48d7-86a2-ea652ba69b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12D774080>]}
[0m21:48:46.970294 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 9.91s]
[0m21:48:46.971936 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m21:48:46.973988 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m21:48:46.976057 [info ] [Thread-1 (]: 2 of 4 START sql view model public.vw_sales .................................... [RUN]
[0m21:48:46.978021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m21:48:46.980505 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m21:48:46.984655 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m21:48:46.986646 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 21:48:46.981608 => 21:48:46.986646
[0m21:48:46.988675 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m21:48:47.037188 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m21:48:47.041756 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:47.045801 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m21:48:47.048835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:47.049843 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:48:47.052572 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:48:48.320882 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:48.338499 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:48.339648 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales

),



renamed as (

    select 
        SALESID AS ID_VENDAS,
        LISTID AS ID_LISTA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        cast(SALETIME as date) AS DATA_VENDA,
        to_char( SALETIME, 'dd/mm/yyy hh24:mi:ss') as DATA_HORA_VENDA,
        to_char( SALETIME, 'hh24:mi:ss') as HORA_VENDA
     from source_sales

)

SELECT * FROM renamed
  ) ;
[0m21:48:48.912598 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:48.931275 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m21:48:48.933218 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:48.933218 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m21:48:49.633294 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:49.650388 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:49.651483 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m21:48:49.934247 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:49.956417 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales"
[0m21:48:49.967066 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:49.968065 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales" cascade
[0m21:48:50.252847 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:50.272658 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m21:48:50.273642 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:50.274654 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m21:48:50.816527 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:50.834572 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:50.835555 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m21:48:51.021075 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:51.027717 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:51.029729 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m21:48:52.963027 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m21:48:52.972617 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m21:48:52.975634 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:52.978633 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m21:48:53.786239 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:53.805378 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:53.808933 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m21:48:54.246105 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:54.254420 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales__dbt_backup"
[0m21:48:54.258413 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:54.260412 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m21:48:54.775676 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:54.778874 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m21:48:54.781391 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:54.783599 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m21:48:55.016369 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:55.035755 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:55.037789 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m21:48:55.220849 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:55.238540 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 21:48:46.988675 => 21:48:55.237541
[0m21:48:55.241065 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m21:48:55.629332 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m21:48:55.648954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f78b02b-36f1-48d7-86a2-ea652ba69b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F130B94770>]}
[0m21:48:55.651633 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.vw_sales ............................... [[32mSUCCESS[0m in 8.67s]
[0m21:48:55.653599 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m21:48:55.654597 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m21:48:55.657601 [info ] [Thread-1 (]: 3 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m21:48:55.661311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m21:48:55.664355 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m21:48:55.672771 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m21:48:55.672771 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 21:48:55.665355 => 21:48:55.672771
[0m21:48:55.672771 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m21:48:55.688711 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m21:48:55.695823 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m21:48:55.695823 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m21:48:55.701332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:55.703381 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:48:55.704301 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:48:57.388877 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m21:48:57.405951 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m21:48:57.407969 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m21:48:57.981402 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:57.995898 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m21:48:57.995898 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:48:58.437735 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:58.443081 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m21:48:58.443081 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m21:48:58.443081 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m21:48:59.622912 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:59.634562 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m21:48:59.635531 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m21:49:00.231462 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:49:00.231462 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m21:49:00.231462 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m21:49:00.231462 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m21:49:00.645894 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:49:00.665988 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m21:49:00.666982 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m21:49:00.667988 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m21:49:00.814576 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:49:00.837925 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m21:49:00.839925 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m21:49:01.056544 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:49:01.075091 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 21:48:55.678301 => 21:49:01.075091
[0m21:49:01.077008 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m21:49:01.464674 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m21:49:01.483358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f78b02b-36f1-48d7-86a2-ea652ba69b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12D774080>]}
[0m21:49:01.485377 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 5.82s]
[0m21:49:01.493046 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m21:49:01.494058 [debug] [Thread-1 (]: Began running node model.analytics_dbt.tb_top_10_compradores
[0m21:49:01.496436 [info ] [Thread-1 (]: 4 of 4 START sql table model public.tb_top_10_compradores ...................... [RUN]
[0m21:49:01.500425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_second_dbt_model, now model.analytics_dbt.tb_top_10_compradores)
[0m21:49:01.501938 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.tb_top_10_compradores
[0m21:49:01.510371 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.tb_top_10_compradores"
[0m21:49:01.517493 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.tb_top_10_compradores (compile): 21:49:01.505390 => 21:49:01.516460
[0m21:49:01.519580 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.tb_top_10_compradores
[0m21:49:01.525107 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.tb_top_10_compradores"
[0m21:49:01.535282 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m21:49:01.537280 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: BEGIN
[0m21:49:01.539325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:01.541820 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:49:01.543849 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:49:04.536084 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m21:49:04.555309 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m21:49:04.556335 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_top_10_compradores"} */

  
    

  create  table
    "dev"."public"."tb_top_10_compradores__dbt_tmp"
    
    
    
  as (
    with sales as(
	select * from vw_sales
	--"dev"."public"."vw_sales"
),

compradores as (
	select
		(firstname||' '|| lastname) as Nome_Completo, userid
	from users
),

top_10_compradores as(
	select 
	  compradores.Nome_completo as Nome_completo,
	  sum(sales.quantidade_vendida) as Vendas_totais,
	  sales.comissao as Comissao
	from sales inner join compradores
    on sales.id_comprador = compradores.userid
    group by compradores.userid, compradores.Nome_completo, sales.comissao
    order by Vendas_totais desc
    limit 10
)

select * from top_10_compradores
  );
[0m21:49:09.877242 [debug] [Thread-1 (]: SQL status: SUCCESS in 5.0 seconds
[0m21:49:09.882447 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m21:49:09.883440 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_top_10_compradores"} */
alter table "dev"."public"."tb_top_10_compradores__dbt_tmp" rename to "tb_top_10_compradores"
[0m21:49:11.394013 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m21:49:11.416204 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m21:49:11.417205 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m21:49:11.418204 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m21:49:12.624134 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:49:12.642700 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m21:49:12.644695 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: BEGIN
[0m21:49:13.339988 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:49:13.364401 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."tb_top_10_compradores__dbt_backup"
[0m21:49:13.367386 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m21:49:13.369382 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_top_10_compradores"} */
drop table if exists "dev"."public"."tb_top_10_compradores__dbt_backup" cascade
[0m21:49:14.020336 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:49:14.038019 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m21:49:14.040047 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m21:49:14.041533 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m21:49:14.195187 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:49:14.212947 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m21:49:14.214935 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: BEGIN
[0m21:49:15.286487 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:49:15.307172 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.tb_top_10_compradores (execute): 21:49:01.519580 => 21:49:15.304940
[0m21:49:15.309716 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: ROLLBACK
[0m21:49:16.104771 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: Close
[0m21:49:16.123971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f78b02b-36f1-48d7-86a2-ea652ba69b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F130BECE90>]}
[0m21:49:16.125990 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.tb_top_10_compradores ................. [[32mSUCCESS[0m in 14.62s]
[0m21:49:16.129990 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.tb_top_10_compradores
[0m21:49:16.133535 [debug] [MainThread]: Using redshift connection "master"
[0m21:49:16.134536 [debug] [MainThread]: On master: BEGIN
[0m21:49:16.135535 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:49:16.136534 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:49:16.137533 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:49:18.267661 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m21:49:18.269659 [debug] [MainThread]: On master: COMMIT
[0m21:49:18.272259 [debug] [MainThread]: Using redshift connection "master"
[0m21:49:18.276278 [debug] [MainThread]: On master: COMMIT
[0m21:49:18.747863 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:49:18.765792 [debug] [MainThread]: On master: Close
[0m21:49:18.769813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:49:18.769813 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m21:49:18.771325 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m21:49:18.773334 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_top_10_compradores' was properly closed.
[0m21:49:18.774333 [info ] [MainThread]: 
[0m21:49:18.775764 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 51.40 seconds (51.40s).
[0m21:49:18.779780 [debug] [MainThread]: Command end result
[0m21:49:18.803415 [info ] [MainThread]: 
[0m21:49:18.806436 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:49:18.807413 [info ] [MainThread]: 
[0m21:49:18.810237 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m21:49:18.811300 [debug] [MainThread]: Command `dbt run` succeeded at 21:49:18.811300 after 54.95 seconds
[0m21:49:18.811300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12F103620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12F2FB440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12F0D2120>]}
[0m21:49:18.817826 [debug] [MainThread]: Flushing usage events
[0m22:09:26.110739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46C716AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46C715C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46C714470>]}


============================== 22:09:26.150433 | 18293239-9741-4aa9-8c5b-52ac86471722 ==============================
[0m22:09:26.150433 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:09:26.152558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:09:26.859666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18293239-9741-4aa9-8c5b-52ac86471722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46D15B950>]}
[0m22:09:26.989324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18293239-9741-4aa9-8c5b-52ac86471722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46C717380>]}
[0m22:09:27.008533 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m22:09:27.022878 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:09:27.180404 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:09:27.199509 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://models\tables\tb_vendas_primeiro_trimestre.sql
[0m22:09:27.391483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18293239-9741-4aa9-8c5b-52ac86471722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46D6A0C80>]}
[0m22:09:27.419714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18293239-9741-4aa9-8c5b-52ac86471722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46D33F830>]}
[0m22:09:27.419714 [info ] [MainThread]: Found 5 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m22:09:27.419714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18293239-9741-4aa9-8c5b-52ac86471722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46D33F7D0>]}
[0m22:09:27.431255 [info ] [MainThread]: 
[0m22:09:27.431255 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:09:27.434995 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m22:09:27.464646 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m22:09:27.464646 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m22:09:27.464646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:09:27.469223 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:09:27.476349 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:09:30.729517 [debug] [ThreadPool]: SQL status: SUCCESS in 3.0 seconds
[0m22:09:30.752029 [debug] [ThreadPool]: On list_dev: Close
[0m22:09:30.761789 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m22:09:30.775834 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:09:30.777546 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m22:09:30.777546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:09:30.777546 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:09:30.779805 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:09:33.519804 [debug] [ThreadPool]: SQL status: SUCCESS in 3.0 seconds
[0m22:09:33.541088 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:09:33.541088 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m22:09:34.279230 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m22:09:34.280287 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m22:09:34.995338 [debug] [ThreadPool]: On list_dev_public: Close
[0m22:09:35.024455 [debug] [MainThread]: Using redshift connection "master"
[0m22:09:35.024455 [debug] [MainThread]: On master: BEGIN
[0m22:09:35.024455 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:09:35.029532 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:09:35.029532 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:09:37.269686 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m22:09:37.289820 [debug] [MainThread]: Using redshift connection "master"
[0m22:09:37.289820 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:09:37.638936 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:09:37.659770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18293239-9741-4aa9-8c5b-52ac86471722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46D7A4EC0>]}
[0m22:09:37.659770 [debug] [MainThread]: On master: ROLLBACK
[0m22:09:37.964171 [debug] [MainThread]: Using redshift connection "master"
[0m22:09:37.985839 [debug] [MainThread]: On master: BEGIN
[0m22:09:38.129787 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:09:38.147031 [debug] [MainThread]: On master: COMMIT
[0m22:09:38.150908 [debug] [MainThread]: Using redshift connection "master"
[0m22:09:38.153188 [debug] [MainThread]: On master: COMMIT
[0m22:09:38.435969 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:09:38.454866 [debug] [MainThread]: On master: Close
[0m22:09:38.454866 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:09:38.459860 [info ] [MainThread]: 
[0m22:09:38.463104 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m22:09:38.468410 [info ] [Thread-1 (]: 1 of 5 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m22:09:38.470737 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.analytics_dbt.my_first_dbt_model'
[0m22:09:38.470737 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m22:09:38.479811 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m22:09:38.479811 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 22:09:38.470737 => 22:09:38.479811
[0m22:09:38.479811 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m22:09:38.559378 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m22:09:38.559378 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:09:38.559378 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m22:09:38.559378 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:09:38.559378 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:09:38.559378 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:09:40.214560 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:09:40.232742 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:09:40.235132 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m22:09:40.626084 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:09:40.643368 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:09:40.643368 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:09:40.643368 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:09:41.856023 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:09:41.873593 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:09:41.873593 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m22:09:42.260582 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:09:42.294505 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m22:09:42.301274 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:09:42.301274 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m22:09:43.493431 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:09:43.497184 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:09:43.498747 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:09:43.498747 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:09:44.106014 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:09:44.125347 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:09:44.125347 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m22:09:44.410563 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:09:44.441845 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:09:44.441845 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m22:09:45.729446 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:09:45.791428 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:09:45.796410 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:09:45.797447 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:09:46.503457 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:09:46.509641 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:09:46.509641 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m22:09:46.801792 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:09:46.826630 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m22:09:46.829644 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:09:46.834356 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m22:09:47.128460 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:09:47.149993 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:09:47.153782 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:09:47.155412 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:09:47.310231 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:09:47.311705 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:09:47.314754 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m22:09:47.459678 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:09:47.465264 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 22:09:38.479811 => 22:09:47.459678
[0m22:09:47.466780 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m22:09:47.759541 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m22:09:47.763011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18293239-9741-4aa9-8c5b-52ac86471722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46D6A13D0>]}
[0m22:09:47.763011 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 9.29s]
[0m22:09:47.767898 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m22:09:47.769430 [debug] [Thread-1 (]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
[0m22:09:47.770388 [info ] [Thread-1 (]: 2 of 5 START sql table model public.tb_vendas_primeiro_trimestre ............... [RUN]
[0m22:09:47.773901 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.tb_vendas_primeiro_trimestre)
[0m22:09:47.773901 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
[0m22:09:47.781059 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:09:47.788045 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.tb_vendas_primeiro_trimestre (compile): 22:09:47.776246 => 22:09:47.785656
[0m22:09:47.789558 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
[0m22:09:47.801115 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:09:47.809363 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:09:47.809363 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
[0m22:09:47.809363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:09:47.809363 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:09:47.809363 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:09:49.074773 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:09:49.092283 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:09:49.092283 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */

  
    

  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- cria a fonte com os dados de data e converte os nomes das colunas
WITH source_date AS (
    SELECT dateid AS id_date,
           month AS mes,
           year AS ano
    FROM date
),

-- cria uma fonte de dados unindo a tabela sales com date
sales_date AS (
    SELECT sd.mes,
           SUM(s.quantidade_vendida) AS total_vendas
    FROM source_date sd
    INNER JOIN vw_sales s ON s.id_date = sd.id_date
    WHERE sd.mes IN ('JAN', 'FEB', 'MAR')
      AND sd.ano = 2008
    GROUP BY sd.mes
)

SELECT * FROM sales_date;
  );
[0m22:09:49.238331 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near ";"
[0m22:09:49.255133 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
[0m22:09:49.537040 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.tb_vendas_primeiro_trimestre (execute): 22:09:47.789558 => 22:09:49.536234
[0m22:09:49.553405 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
[0m22:09:49.561206 [debug] [Thread-1 (]: Database Error in model tb_vendas_primeiro_trimestre (models\tables\tb_vendas_primeiro_trimestre.sql)
  syntax error at or near ";"
  compiled Code at target\run\analytics_dbt\models\tables\tb_vendas_primeiro_trimestre.sql
[0m22:09:49.565985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18293239-9741-4aa9-8c5b-52ac86471722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46DC539E0>]}
[0m22:09:49.567559 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model public.tb_vendas_primeiro_trimestre ...... [[31mERROR[0m in 1.80s]
[0m22:09:49.569569 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
[0m22:09:49.570470 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m22:09:49.573287 [info ] [Thread-1 (]: 3 of 5 START sql view model public.vw_sales .................................... [RUN]
[0m22:09:49.575524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.tb_vendas_primeiro_trimestre, now model.analytics_dbt.vw_sales)
[0m22:09:49.575524 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m22:09:49.579215 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m22:09:49.584591 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 22:09:49.575524 => 22:09:49.583594
[0m22:09:49.587374 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m22:09:49.639359 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m22:09:49.650153 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:09:49.652344 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m22:09:49.652344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:09:49.652344 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:09:49.658192 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:09:52.803826 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m22:09:52.826192 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:09:52.829824 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales

),



renamed as (

    select 
        SALESID AS ID_VENDAS,
        LISTID AS ID_LISTA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        cast(SALETIME as date) AS DATA_VENDA,
        to_char( SALETIME, 'dd/mm/yyy hh24:mi:ss') as DATA_HORA_VENDA,
        to_char( SALETIME, 'hh24:mi:ss') as HORA_VENDA
     from source_sales

)

SELECT * FROM renamed
  ) ;
[0m22:09:53.738241 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:09:53.759718 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:09:53.761532 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:09:53.761532 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:09:55.345614 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:09:55.362829 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:09:55.364970 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m22:09:55.717845 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:09:55.719424 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales"
[0m22:09:55.734062 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:09:55.736605 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales" cascade
[0m22:09:56.033200 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:09:56.050469 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:09:56.050469 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:09:56.050469 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:09:56.609888 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:09:56.627543 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:09:56.629733 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m22:09:56.779451 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:09:56.807934 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:09:56.809465 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m22:09:57.719793 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:09:57.749879 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:09:57.752057 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:09:57.752057 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:09:58.545310 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:09:58.567363 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:09:58.569474 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m22:09:59.100482 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:09:59.105043 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales__dbt_backup"
[0m22:09:59.105043 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:09:59.105043 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m22:09:59.579926 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:09:59.600997 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:09:59.600997 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:09:59.600997 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:09:59.797928 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:09:59.800340 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:09:59.800340 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m22:09:59.979514 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:10:00.002978 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 22:09:49.587374 => 22:10:00.002256
[0m22:10:00.004042 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m22:10:00.595846 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m22:10:00.617036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18293239-9741-4aa9-8c5b-52ac86471722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46DCD1460>]}
[0m22:10:00.620440 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.vw_sales ............................... [[32mSUCCESS[0m in 11.04s]
[0m22:10:00.620440 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m22:10:00.620440 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m22:10:00.620440 [info ] [Thread-1 (]: 4 of 5 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m22:10:00.620440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m22:10:00.620440 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m22:10:00.630914 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m22:10:00.633679 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 22:10:00.620440 => 22:10:00.633679
[0m22:10:00.633679 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m22:10:00.644524 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m22:10:00.653771 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:10:00.653771 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m22:10:00.658436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:00.659442 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:10:00.660365 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:10:02.934405 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:10:02.954898 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:10:02.954898 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m22:10:03.768598 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:10:03.784024 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:10:03.784024 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m22:10:04.749707 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:10:04.777210 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m22:10:04.779366 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:10:04.783585 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m22:10:05.516800 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:10:05.537216 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:10:05.537216 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m22:10:06.085648 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:10:06.169386 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m22:10:06.169386 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:10:06.173412 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m22:10:06.632892 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:10:06.639486 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m22:10:06.641820 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:10:06.643980 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m22:10:06.939530 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:10:06.955550 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:10:06.955550 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m22:10:07.096759 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:10:07.100031 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 22:10:00.636220 => 22:10:07.100031
[0m22:10:07.100031 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m22:10:07.609608 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m22:10:07.612826 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18293239-9741-4aa9-8c5b-52ac86471722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46DCF37D0>]}
[0m22:10:07.612826 [info ] [Thread-1 (]: 4 of 5 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 6.99s]
[0m22:10:07.616138 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m22:10:07.619660 [debug] [Thread-1 (]: Began running node model.analytics_dbt.tb_top_10_compradores
[0m22:10:07.619660 [info ] [Thread-1 (]: 5 of 5 START sql table model public.tb_top_10_compradores ...................... [RUN]
[0m22:10:07.619660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_second_dbt_model, now model.analytics_dbt.tb_top_10_compradores)
[0m22:10:07.619660 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.tb_top_10_compradores
[0m22:10:07.633188 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.tb_top_10_compradores"
[0m22:10:07.636344 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.tb_top_10_compradores (compile): 22:10:07.619660 => 22:10:07.633836
[0m22:10:07.636344 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.tb_top_10_compradores
[0m22:10:07.653334 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.tb_top_10_compradores"
[0m22:10:07.662357 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:10:07.663293 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: BEGIN
[0m22:10:07.663293 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:10:07.669376 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:10:07.671156 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:10:09.430866 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:10:09.439438 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:10:09.439438 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_top_10_compradores"} */

  
    

  create  table
    "dev"."public"."tb_top_10_compradores__dbt_tmp"
    
    
    
  as (
    with sales as(
	select * from vw_sales
	--"dev"."public"."vw_sales"
),

compradores as (
	select
		(firstname||' '|| lastname) as Nome_Completo, userid
	from users
),

top_10_compradores as(
	select 
	  compradores.Nome_completo as Nome_completo,
	  sum(sales.quantidade_vendida) as Vendas_totais,
	  sales.comissao as Comissao
	from sales inner join compradores
    on sales.id_comprador = compradores.userid
    group by compradores.userid, compradores.Nome_completo, sales.comissao
    order by Vendas_totais desc
    limit 10
)

select * from top_10_compradores
  );
[0m22:10:09.902718 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:10:09.919748 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:10:09.919748 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:10:09.924545 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:10:10.929713 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:10:10.949982 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:10:10.949982 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: BEGIN
[0m22:10:11.240081 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:10:11.259356 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."tb_top_10_compradores"
[0m22:10:11.259356 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:10:11.259356 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_top_10_compradores"} */
drop table if exists "dev"."public"."tb_top_10_compradores" cascade
[0m22:10:11.769524 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:10:11.788215 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:10:11.789859 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:10:11.789859 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:10:12.387304 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:10:12.389393 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:10:12.391366 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: BEGIN
[0m22:10:12.539223 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:10:12.554100 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:10:12.554100 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_top_10_compradores"} */
alter table "dev"."public"."tb_top_10_compradores__dbt_tmp" rename to "tb_top_10_compradores"
[0m22:10:14.029790 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:10:14.044456 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:10:14.044456 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:10:14.049566 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:10:14.727160 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:10:14.745697 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:10:14.749475 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: BEGIN
[0m22:10:15.049597 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:10:15.076805 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."tb_top_10_compradores__dbt_backup"
[0m22:10:15.079485 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:10:15.079485 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_top_10_compradores"} */
drop table if exists "dev"."public"."tb_top_10_compradores__dbt_backup" cascade
[0m22:10:15.380143 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:10:15.400316 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:10:15.404449 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:10:15.404449 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:10:15.566396 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:10:15.583610 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:10:15.588058 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: BEGIN
[0m22:10:15.973655 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:10:15.996820 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.tb_top_10_compradores (execute): 22:10:07.639383 => 22:10:15.996820
[0m22:10:15.999392 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: ROLLBACK
[0m22:10:16.501449 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: Close
[0m22:10:16.522665 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18293239-9741-4aa9-8c5b-52ac86471722', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46DCE4E00>]}
[0m22:10:16.529318 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.tb_top_10_compradores ................. [[32mSUCCESS[0m in 8.90s]
[0m22:10:16.533142 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.tb_top_10_compradores
[0m22:10:16.539295 [debug] [MainThread]: Using redshift connection "master"
[0m22:10:16.539295 [debug] [MainThread]: On master: BEGIN
[0m22:10:16.539295 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:10:16.549654 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:10:16.552638 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:10:18.657442 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m22:10:18.661021 [debug] [MainThread]: On master: COMMIT
[0m22:10:18.664978 [debug] [MainThread]: Using redshift connection "master"
[0m22:10:18.667980 [debug] [MainThread]: On master: COMMIT
[0m22:10:19.027937 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:10:19.048431 [debug] [MainThread]: On master: Close
[0m22:10:19.054903 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:19.058160 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m22:10:19.061104 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m22:10:19.063529 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_top_10_compradores' was properly closed.
[0m22:10:19.067558 [info ] [MainThread]: 
[0m22:10:19.070042 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 51.64 seconds (51.64s).
[0m22:10:19.077458 [debug] [MainThread]: Command end result
[0m22:10:19.120956 [info ] [MainThread]: 
[0m22:10:19.123966 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:10:19.127367 [info ] [MainThread]: 
[0m22:10:19.129593 [error] [MainThread]:   Database Error in model tb_vendas_primeiro_trimestre (models\tables\tb_vendas_primeiro_trimestre.sql)
  syntax error at or near ";"
  compiled Code at target\run\analytics_dbt\models\tables\tb_vendas_primeiro_trimestre.sql
[0m22:10:19.138229 [info ] [MainThread]: 
[0m22:10:19.141754 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m22:10:19.147772 [debug] [MainThread]: Command `dbt run` failed at 22:10:19.146781 after 53.13 seconds
[0m22:10:19.151872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46BE2F530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A46D2131D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A4686EF710>]}
[0m22:10:19.157886 [debug] [MainThread]: Flushing usage events
[0m22:10:47.055921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC4F514F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC4F515670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC4F514CB0>]}


============================== 22:10:47.078905 | f4ab2bd6-6959-41a7-ab2e-658457542767 ==============================
[0m22:10:47.078905 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:10:47.082906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:10:47.564466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4ab2bd6-6959-41a7-ab2e-658457542767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC4FE4DE20>]}
[0m22:10:47.713396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4ab2bd6-6959-41a7-ab2e-658457542767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC4F552540>]}
[0m22:10:47.715587 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m22:10:47.734246 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:10:47.901931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:10:47.902919 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models\tables\tb_vendas_primeiro_trimestre.sql
[0m22:10:48.056869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4ab2bd6-6959-41a7-ab2e-658457542767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC505F76E0>]}
[0m22:10:48.084781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4ab2bd6-6959-41a7-ab2e-658457542767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC5013BAD0>]}
[0m22:10:48.086212 [info ] [MainThread]: Found 5 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m22:10:48.086212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4ab2bd6-6959-41a7-ab2e-658457542767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC50138560>]}
[0m22:10:48.089915 [info ] [MainThread]: 
[0m22:10:48.092770 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:10:48.092770 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m22:10:48.125319 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m22:10:48.126320 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m22:10:48.127324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:48.133382 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:10:48.135385 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:10:52.201153 [debug] [ThreadPool]: SQL status: SUCCESS in 4.0 seconds
[0m22:10:52.219385 [debug] [ThreadPool]: On list_dev: Close
[0m22:10:52.224743 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m22:10:52.238912 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:10:52.239911 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m22:10:52.240906 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:52.242235 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:10:52.244243 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:10:55.333167 [debug] [ThreadPool]: SQL status: SUCCESS in 3.0 seconds
[0m22:10:55.350672 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:10:55.350672 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m22:10:56.199082 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m22:10:56.218828 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m22:10:56.851137 [debug] [ThreadPool]: On list_dev_public: Close
[0m22:10:56.891913 [debug] [MainThread]: Using redshift connection "master"
[0m22:10:56.892864 [debug] [MainThread]: On master: BEGIN
[0m22:10:56.893863 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:10:56.895870 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:10:56.896872 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:10:59.008196 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m22:10:59.009199 [debug] [MainThread]: Using redshift connection "master"
[0m22:10:59.011188 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:10:59.358849 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:10:59.368692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4ab2bd6-6959-41a7-ab2e-658457542767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC5058F3E0>]}
[0m22:10:59.368692 [debug] [MainThread]: On master: ROLLBACK
[0m22:11:00.086674 [debug] [MainThread]: Using redshift connection "master"
[0m22:11:00.089219 [debug] [MainThread]: On master: BEGIN
[0m22:11:00.598959 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:00.617281 [debug] [MainThread]: On master: COMMIT
[0m22:11:00.618803 [debug] [MainThread]: Using redshift connection "master"
[0m22:11:00.619802 [debug] [MainThread]: On master: COMMIT
[0m22:11:01.418321 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:01.435366 [debug] [MainThread]: On master: Close
[0m22:11:01.439945 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:11:01.440825 [info ] [MainThread]: 
[0m22:11:01.449988 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m22:11:01.449988 [info ] [Thread-1 (]: 1 of 5 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m22:11:01.457827 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.analytics_dbt.my_first_dbt_model'
[0m22:11:01.457827 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m22:11:01.472037 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m22:11:01.474037 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 22:11:01.457827 => 22:11:01.474037
[0m22:11:01.475036 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m22:11:01.583569 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m22:11:01.587963 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:11:01.587963 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m22:11:01.588979 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:11:01.589971 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:11:01.591029 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:11:02.873171 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:02.892511 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:11:02.894501 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m22:11:03.219225 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:03.242606 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:11:03.245294 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:11:03.246305 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:11:04.386738 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:04.406227 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:11:04.409749 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m22:11:04.554918 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:04.581587 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m22:11:04.600508 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:11:04.608217 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m22:11:05.146582 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:05.167850 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:11:05.171977 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:11:05.174001 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:11:05.796818 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:05.816624 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:11:05.819155 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m22:11:06.130003 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:06.168067 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:11:06.171592 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m22:11:08.076456 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:11:08.174302 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:11:08.176294 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:11:08.178826 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:11:09.651313 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:09.667882 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:11:09.670273 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m22:11:10.838390 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:10.871966 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m22:11:10.878515 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:11:10.881015 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m22:11:11.455744 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:11.476385 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:11:11.480219 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:11:11.483243 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:11:11.760154 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:11.782363 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:11:11.786330 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m22:11:12.051034 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:12.072995 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 22:11:01.476031 => 22:11:12.071996
[0m22:11:12.074979 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m22:11:12.682376 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m22:11:12.705330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4ab2bd6-6959-41a7-ab2e-658457542767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC50A21700>]}
[0m22:11:12.708867 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 11.25s]
[0m22:11:12.713889 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m22:11:12.717897 [debug] [Thread-1 (]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
[0m22:11:12.720444 [info ] [Thread-1 (]: 2 of 5 START sql table model public.tb_vendas_primeiro_trimestre ............... [RUN]
[0m22:11:12.726106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.tb_vendas_primeiro_trimestre)
[0m22:11:12.729143 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
[0m22:11:12.739771 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:11:12.746846 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.tb_vendas_primeiro_trimestre (compile): 22:11:12.732190 => 22:11:12.745767
[0m22:11:12.748906 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
[0m22:11:12.768271 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:11:12.784032 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:11:12.787020 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
[0m22:11:12.790583 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:12.794581 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:11:12.796584 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:11:15.041283 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:11:15.059432 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:11:15.063459 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */

  
    

  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- cria a fonte com os dados de data e converte os nomes das colunas
WITH source_date AS (
    SELECT dateid AS id_date,
           month AS mes,
           year AS ano
    FROM date
),

-- cria uma fonte de dados unindo a tabela sales com date
sales_date AS (
    SELECT sd.mes,
           SUM(s.quantidade_vendida) AS total_vendas
    FROM source_date sd
    INNER JOIN vw_sales s ON s.id_date = sd.id_date
    WHERE sd.mes IN ('JAN', 'FEB', 'MAR')
      AND sd.ano = 2008
    GROUP BY sd.mes
)

SELECT * FROM sales_date
  );
[0m22:11:19.687282 [debug] [Thread-1 (]: SQL status: SUCCESS in 5.0 seconds
[0m22:11:19.722469 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:11:19.725470 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
alter table "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp" rename to "tb_vendas_primeiro_trimestre"
[0m22:11:20.432283 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:20.458635 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
[0m22:11:20.462151 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:11:20.465432 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
[0m22:11:21.559015 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:21.586031 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:11:21.588651 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
[0m22:11:21.872238 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:21.900141 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."tb_vendas_primeiro_trimestre__dbt_backup"
[0m22:11:21.905585 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:11:21.908219 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
drop table if exists "dev"."public"."tb_vendas_primeiro_trimestre__dbt_backup" cascade
[0m22:11:22.193207 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:22.213130 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
[0m22:11:22.217779 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:11:22.217779 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
[0m22:11:22.367805 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:22.387804 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:11:22.389811 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
[0m22:11:22.532782 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:22.553147 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.tb_vendas_primeiro_trimestre (execute): 22:11:12.751141 => 22:11:22.552146
[0m22:11:22.555825 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
[0m22:11:22.841327 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
[0m22:11:22.864758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4ab2bd6-6959-41a7-ab2e-658457542767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC50A216A0>]}
[0m22:11:22.867752 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.tb_vendas_primeiro_trimestre .......... [[32mSUCCESS[0m in 10.14s]
[0m22:11:22.873115 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
[0m22:11:22.875120 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m22:11:22.877112 [info ] [Thread-1 (]: 3 of 5 START sql view model public.vw_sales .................................... [RUN]
[0m22:11:22.883723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.tb_vendas_primeiro_trimestre, now model.analytics_dbt.vw_sales)
[0m22:11:22.886408 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m22:11:22.897936 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m22:11:22.906579 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 22:11:22.890994 => 22:11:22.905530
[0m22:11:22.914206 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m22:11:23.014930 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m22:11:23.035623 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:11:23.040269 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m22:11:23.043289 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:23.047925 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:11:23.051933 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:11:25.006510 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:11:25.026012 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:11:25.030170 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales

),



renamed as (

    select 
        SALESID AS ID_VENDAS,
        LISTID AS ID_LISTA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        cast(SALETIME as date) AS DATA_VENDA,
        to_char( SALETIME, 'dd/mm/yyy hh24:mi:ss') as DATA_HORA_VENDA,
        to_char( SALETIME, 'hh24:mi:ss') as HORA_VENDA
     from source_sales

)

SELECT * FROM renamed
  ) ;
[0m22:11:25.868453 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:25.874909 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:11:25.877886 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:11:25.880462 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:11:26.582748 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:26.602380 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:11:26.604833 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m22:11:26.889196 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:26.916180 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales"
[0m22:11:26.932361 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:11:26.934329 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales" cascade
[0m22:11:27.219415 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:27.241417 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:11:27.244124 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:11:27.245605 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:11:27.748235 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:27.755531 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:11:27.758133 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m22:11:27.901253 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:27.929162 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:11:27.931297 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m22:11:28.768148 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:28.781270 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:11:28.785212 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:11:28.787978 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:11:29.474565 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:29.496351 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:11:29.498857 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m22:11:29.783589 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:29.795460 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales__dbt_backup"
[0m22:11:29.806513 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:11:29.810121 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m22:11:30.450699 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:30.474191 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:11:30.477765 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:11:30.480788 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:11:30.666292 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:30.685815 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:11:30.687806 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m22:11:31.046774 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:31.069003 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 22:11:22.918705 => 22:11:31.069003
[0m22:11:31.072027 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m22:11:31.441850 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m22:11:31.447893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4ab2bd6-6959-41a7-ab2e-658457542767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC50AA5730>]}
[0m22:11:31.453912 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.vw_sales ............................... [[32mSUCCESS[0m in 8.57s]
[0m22:11:31.458433 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m22:11:31.461740 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m22:11:31.465227 [info ] [Thread-1 (]: 4 of 5 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m22:11:31.469817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m22:11:31.473753 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m22:11:31.488164 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m22:11:31.500158 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 22:11:31.478326 => 22:11:31.498854
[0m22:11:31.500158 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m22:11:31.652313 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m22:11:31.677682 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:11:31.682039 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m22:11:31.686039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:31.689256 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:11:31.693257 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:11:33.071169 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:33.089412 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:11:33.093436 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m22:11:33.658719 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:33.689322 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:11:33.691300 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m22:11:34.118832 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:34.140567 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m22:11:34.144524 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:11:34.148177 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m22:11:34.799039 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:34.818933 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:11:34.818933 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m22:11:35.104589 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:35.132302 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m22:11:35.138444 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:11:35.141465 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m22:11:35.426804 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:35.447995 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m22:11:35.449952 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:11:35.453920 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m22:11:35.601544 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:35.605512 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:11:35.606515 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m22:11:35.749773 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:35.771526 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 22:11:31.507195 => 22:11:35.770525
[0m22:11:35.774487 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m22:11:36.057487 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m22:11:36.080609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4ab2bd6-6959-41a7-ab2e-658457542767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC50AB4500>]}
[0m22:11:36.080609 [info ] [Thread-1 (]: 4 of 5 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 4.61s]
[0m22:11:36.088749 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m22:11:36.090934 [debug] [Thread-1 (]: Began running node model.analytics_dbt.tb_top_10_compradores
[0m22:11:36.094011 [info ] [Thread-1 (]: 5 of 5 START sql table model public.tb_top_10_compradores ...................... [RUN]
[0m22:11:36.097894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_second_dbt_model, now model.analytics_dbt.tb_top_10_compradores)
[0m22:11:36.099943 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.tb_top_10_compradores
[0m22:11:36.099943 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.tb_top_10_compradores"
[0m22:11:36.111724 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.tb_top_10_compradores (compile): 22:11:36.099943 => 22:11:36.111054
[0m22:11:36.111724 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.tb_top_10_compradores
[0m22:11:36.135797 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.tb_top_10_compradores"
[0m22:11:36.154092 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:11:36.157068 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: BEGIN
[0m22:11:36.159672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:11:36.164218 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:11:36.167826 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:11:37.516071 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:37.535130 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:11:37.537128 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_top_10_compradores"} */

  
    

  create  table
    "dev"."public"."tb_top_10_compradores__dbt_tmp"
    
    
    
  as (
    with sales as(
	select * from vw_sales
	--"dev"."public"."vw_sales"
),

compradores as (
	select
		(firstname||' '|| lastname) as Nome_Completo, userid
	from users
),

top_10_compradores as(
	select 
	  compradores.Nome_completo as Nome_completo,
	  sum(sales.quantidade_vendida) as Vendas_totais,
	  sales.comissao as Comissao
	from sales inner join compradores
    on sales.id_comprador = compradores.userid
    group by compradores.userid, compradores.Nome_completo, sales.comissao
    order by Vendas_totais desc
    limit 10
)

select * from top_10_compradores
  );
[0m22:11:37.907982 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:37.932828 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:11:37.937860 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:11:37.939187 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:11:38.634059 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:38.652560 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:11:38.655549 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: BEGIN
[0m22:11:38.797883 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:38.828135 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."tb_top_10_compradores"
[0m22:11:38.833189 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:11:38.836199 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_top_10_compradores"} */
drop table if exists "dev"."public"."tb_top_10_compradores" cascade
[0m22:11:39.122206 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:39.140108 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:11:39.143130 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:11:39.146278 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:11:39.624437 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:39.644775 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:11:39.648670 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: BEGIN
[0m22:11:39.793548 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:39.820404 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:11:39.823518 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_top_10_compradores"} */
alter table "dev"."public"."tb_top_10_compradores__dbt_tmp" rename to "tb_top_10_compradores"
[0m22:11:41.868463 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:11:41.881864 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:11:41.888167 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:11:41.893688 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:11:42.914122 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:42.932944 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:11:42.932944 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: BEGIN
[0m22:11:43.297977 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:43.328137 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."tb_top_10_compradores__dbt_backup"
[0m22:11:43.338050 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:11:43.338050 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_top_10_compradores"} */
drop table if exists "dev"."public"."tb_top_10_compradores__dbt_backup" cascade
[0m22:11:43.918115 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:11:43.937999 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:11:43.944275 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:11:43.944275 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:11:44.164091 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:44.183356 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:11:44.183356 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: BEGIN
[0m22:11:44.332427 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:44.353986 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.tb_top_10_compradores (execute): 22:11:36.118127 => 22:11:44.353986
[0m22:11:44.358169 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: ROLLBACK
[0m22:11:44.870616 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: Close
[0m22:11:44.878229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4ab2bd6-6959-41a7-ab2e-658457542767', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC50A2C740>]}
[0m22:11:44.883853 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.tb_top_10_compradores ................. [[32mSUCCESS[0m in 8.78s]
[0m22:11:44.888111 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.tb_top_10_compradores
[0m22:11:44.897727 [debug] [MainThread]: Using redshift connection "master"
[0m22:11:44.902745 [debug] [MainThread]: On master: BEGIN
[0m22:11:44.902745 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:11:44.907850 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:11:44.912268 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:11:46.709680 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m22:11:46.724009 [debug] [MainThread]: On master: COMMIT
[0m22:11:46.727871 [debug] [MainThread]: Using redshift connection "master"
[0m22:11:46.730546 [debug] [MainThread]: On master: COMMIT
[0m22:11:47.031699 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:11:47.034042 [debug] [MainThread]: On master: Close
[0m22:11:47.038875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:11:47.040283 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m22:11:47.044047 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m22:11:47.047988 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_top_10_compradores' was properly closed.
[0m22:11:47.047988 [info ] [MainThread]: 
[0m22:11:47.050645 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 58.96 seconds (58.96s).
[0m22:11:47.059605 [debug] [MainThread]: Command end result
[0m22:11:47.130971 [info ] [MainThread]: 
[0m22:11:47.130971 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:11:47.141563 [info ] [MainThread]: 
[0m22:11:47.146702 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:11:47.150785 [debug] [MainThread]: Command `dbt run` succeeded at 22:11:47.150785 after 60.18 seconds
[0m22:11:47.150785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC4EB88CE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC4EB88C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC4FF987D0>]}
[0m22:11:47.157936 [debug] [MainThread]: Flushing usage events
[0m22:20:33.351814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002538A3165D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002538A3168D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002538A3160F0>]}


============================== 22:20:33.372287 | 65e974e2-e590-4e7c-90a7-a8e8bf15d791 ==============================
[0m22:20:33.372287 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:20:33.375339 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:20:33.879896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65e974e2-e590-4e7c-90a7-a8e8bf15d791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002538A43FC80>]}
[0m22:20:33.989106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65e974e2-e590-4e7c-90a7-a8e8bf15d791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002538A3158B0>]}
[0m22:20:33.997616 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m22:20:34.012209 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:20:34.178314 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:20:34.196110 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:20:34.202682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65e974e2-e590-4e7c-90a7-a8e8bf15d791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002538AE72300>]}
[0m22:20:34.218365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65e974e2-e590-4e7c-90a7-a8e8bf15d791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002538AF38230>]}
[0m22:20:34.218365 [info ] [MainThread]: Found 5 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m22:20:34.218365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65e974e2-e590-4e7c-90a7-a8e8bf15d791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002538AF382F0>]}
[0m22:20:34.222374 [info ] [MainThread]: 
[0m22:20:34.228975 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:20:34.235235 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m22:20:34.261264 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:20:34.267343 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m22:20:34.267343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:20:34.267343 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:20:34.275305 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:20:37.733492 [debug] [ThreadPool]: SQL status: SUCCESS in 3.0 seconds
[0m22:20:37.750308 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:20:37.753719 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m22:20:38.553065 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m22:20:38.571461 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m22:20:39.162637 [debug] [ThreadPool]: On list_dev_public: Close
[0m22:20:39.184365 [debug] [MainThread]: Using redshift connection "master"
[0m22:20:39.187614 [debug] [MainThread]: On master: BEGIN
[0m22:20:39.187614 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:20:39.187614 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:20:39.187614 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:20:40.846138 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m22:20:40.874542 [debug] [MainThread]: Using redshift connection "master"
[0m22:20:40.877555 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:20:41.450513 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m22:20:41.456230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65e974e2-e590-4e7c-90a7-a8e8bf15d791', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002538AF38F20>]}
[0m22:20:41.457477 [debug] [MainThread]: On master: ROLLBACK
[0m22:20:41.927458 [debug] [MainThread]: Using redshift connection "master"
[0m22:20:41.932596 [debug] [MainThread]: On master: BEGIN
[0m22:20:42.108002 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:20:42.124836 [debug] [MainThread]: On master: COMMIT
[0m22:20:42.127643 [debug] [MainThread]: Using redshift connection "master"
[0m22:20:42.127643 [debug] [MainThread]: On master: COMMIT
[0m22:20:42.418202 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:20:42.437700 [debug] [MainThread]: On master: Close
[0m22:20:42.437700 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:20:42.447633 [info ] [MainThread]: 
[0m22:20:42.457660 [debug] [Thread-1 (]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:20:42.457660 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:20:42.462791 [debug] [Thread-1 (]: Acquiring new redshift connection 'test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:20:42.462791 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:20:42.477696 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:20:42.484143 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 22:20:42.462791 => 22:20:42.484143
[0m22:20:42.487500 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:20:42.517874 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:20:42.517874 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:20:42.517874 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m22:20:42.523558 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:20:42.523558 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:20:42.527748 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:20:43.789891 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:20:43.813454 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:20:43.817512 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m22:20:44.417987 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:20:44.421053 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 22:20:42.487500 => 22:20:44.421053
[0m22:20:44.427006 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m22:20:44.711728 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:20:44.729917 [error] [Thread-1 (]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.27s]
[0m22:20:44.729917 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:20:44.729917 [debug] [Thread-1 (]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:20:44.729917 [info ] [Thread-1 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m22:20:44.740675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710, now test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778)
[0m22:20:44.740675 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:20:44.748517 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:20:44.748517 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778 (compile): 22:20:44.740675 => 22:20:44.748517
[0m22:20:44.748517 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:20:44.761752 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:20:44.761752 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:20:44.767761 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m22:20:44.767761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:44.767761 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:20:44.767761 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:20:46.067838 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:20:46.087990 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:20:46.087990 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m22:20:46.539230 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:20:46.543767 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778 (execute): 22:20:44.748517 => 22:20:46.539877
[0m22:20:46.543767 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m22:20:47.088642 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m22:20:47.113250 [info ] [Thread-1 (]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 2.37s]
[0m22:20:47.119349 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:20:47.119349 [debug] [Thread-1 (]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:20:47.119349 [info ] [Thread-1 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:20:47.123993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778, now test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321)
[0m22:20:47.126831 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:20:47.138218 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:20:47.139752 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321 (compile): 22:20:47.127841 => 22:20:47.139752
[0m22:20:47.139752 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:20:47.143770 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:20:47.150091 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:20:47.150091 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m22:20:47.150091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:47.150091 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:20:47.150091 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:20:48.841892 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:20:48.860624 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:20:48.864007 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:20:49.381649 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:20:49.399501 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321 (execute): 22:20:47.142931 => 22:20:49.399501
[0m22:20:49.399501 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m22:20:49.697843 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:20:49.717981 [info ] [Thread-1 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 2.60s]
[0m22:20:49.723239 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:20:49.723239 [debug] [Thread-1 (]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:20:49.727754 [info ] [Thread-1 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m22:20:49.731250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321, now test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493)
[0m22:20:49.733152 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:20:49.737670 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:20:49.737670 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493 (compile): 22:20:49.733152 => 22:20:49.737670
[0m22:20:49.737670 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:20:49.747601 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:20:49.747601 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:20:49.747601 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m22:20:49.747601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:20:49.747601 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:20:49.747601 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:20:52.343809 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m22:20:52.362091 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:20:52.362091 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:20:53.151670 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:20:53.153548 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493 (execute): 22:20:49.744040 => 22:20:53.153548
[0m22:20:53.153548 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m22:20:53.610694 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m22:20:53.632716 [info ] [Thread-1 (]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 3.90s]
[0m22:20:53.632716 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:20:53.638081 [debug] [MainThread]: Using redshift connection "master"
[0m22:20:53.638081 [debug] [MainThread]: On master: BEGIN
[0m22:20:53.638081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:20:53.638081 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:20:53.638081 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:20:55.678869 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m22:20:55.698015 [debug] [MainThread]: On master: COMMIT
[0m22:20:55.698015 [debug] [MainThread]: Using redshift connection "master"
[0m22:20:55.698015 [debug] [MainThread]: On master: COMMIT
[0m22:20:56.129828 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:20:56.150828 [debug] [MainThread]: On master: Close
[0m22:20:56.150828 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:20:56.150828 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m22:20:56.157868 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m22:20:56.160284 [info ] [MainThread]: 
[0m22:20:56.161803 [info ] [MainThread]: Finished running 4 tests in 0 hours 0 minutes and 21.93 seconds (21.93s).
[0m22:20:56.161803 [debug] [MainThread]: Command end result
[0m22:20:56.187880 [info ] [MainThread]: 
[0m22:20:56.187880 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:20:56.187880 [info ] [MainThread]: 
[0m22:20:56.194078 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:20:56.195610 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:20:56.197622 [info ] [MainThread]: 
[0m22:20:56.197622 [info ] [MainThread]:   compiled Code at target\compiled\analytics_dbt\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:20:56.201652 [info ] [MainThread]: 
[0m22:20:56.201944 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m22:20:56.201944 [debug] [MainThread]: Command `dbt test` failed at 22:20:56.201944 after 22.95 seconds
[0m22:20:56.207453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002538A1BFFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025389CDA1E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002538AA4FC20>]}
[0m22:20:56.207453 [debug] [MainThread]: Flushing usage events
[0m22:22:30.427286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002245F717B90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002245F717B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002245F716810>]}


============================== 22:22:30.447578 | c89c86e2-9b36-427e-a949-2611349a2a2c ==============================
[0m22:22:30.447578 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:22:30.447578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:22:30.964632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c89c86e2-9b36-427e-a949-2611349a2a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002245FF11F70>]}
[0m22:22:31.107236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c89c86e2-9b36-427e-a949-2611349a2a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002245F178E00>]}
[0m22:22:31.127333 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m22:22:31.144687 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:22:31.333789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:22:31.350281 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:22:31.358455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c89c86e2-9b36-427e-a949-2611349a2a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224602AE4B0>]}
[0m22:22:31.377524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c89c86e2-9b36-427e-a949-2611349a2a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022460338740>]}
[0m22:22:31.377524 [info ] [MainThread]: Found 5 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m22:22:31.377524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c89c86e2-9b36-427e-a949-2611349a2a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002245FE3B170>]}
[0m22:22:31.385266 [info ] [MainThread]: 
[0m22:22:31.390982 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:22:31.390982 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m22:22:31.460282 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m22:22:31.460282 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m22:22:31.467402 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:31.472437 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:22:31.477619 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:22:34.878807 [debug] [ThreadPool]: SQL status: SUCCESS in 3.0 seconds
[0m22:22:34.900521 [debug] [ThreadPool]: On list_dev: Close
[0m22:22:34.908552 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m22:22:34.930860 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:22:34.930860 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m22:22:34.937322 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:34.940942 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:22:34.940942 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:22:38.302581 [debug] [ThreadPool]: SQL status: SUCCESS in 3.0 seconds
[0m22:22:38.304002 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:22:38.307567 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m22:22:38.816718 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m22:22:38.837307 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m22:22:39.513601 [debug] [ThreadPool]: On list_dev_public: Close
[0m22:22:39.553683 [debug] [MainThread]: Using redshift connection "master"
[0m22:22:39.557278 [debug] [MainThread]: On master: BEGIN
[0m22:22:39.557278 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:22:39.559946 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:22:39.560708 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:22:41.747878 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m22:22:41.767493 [debug] [MainThread]: Using redshift connection "master"
[0m22:22:41.770036 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:22:42.157573 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:22:42.177433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c89c86e2-9b36-427e-a949-2611349a2a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002245F0A4140>]}
[0m22:22:42.177433 [debug] [MainThread]: On master: ROLLBACK
[0m22:22:42.576225 [debug] [MainThread]: Using redshift connection "master"
[0m22:22:42.579303 [debug] [MainThread]: On master: BEGIN
[0m22:22:42.718075 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:22:42.738426 [debug] [MainThread]: On master: COMMIT
[0m22:22:42.740392 [debug] [MainThread]: Using redshift connection "master"
[0m22:22:42.741909 [debug] [MainThread]: On master: COMMIT
[0m22:22:43.017325 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:22:43.017325 [debug] [MainThread]: On master: Close
[0m22:22:43.029807 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:22:43.031150 [info ] [MainThread]: 
[0m22:22:43.040403 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m22:22:43.042993 [info ] [Thread-1 (]: 1 of 5 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m22:22:43.047322 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.analytics_dbt.my_first_dbt_model'
[0m22:22:43.047322 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m22:22:43.060197 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m22:22:43.067269 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 22:22:43.047322 => 22:22:43.067269
[0m22:22:43.069124 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m22:22:43.149936 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m22:22:43.157862 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:22:43.157862 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m22:22:43.157862 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:22:43.157862 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:22:43.157862 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:22:44.484570 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:22:44.503254 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:22:44.505584 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m22:22:44.843966 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:22:44.862647 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:22:44.862647 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:22:44.862647 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:22:45.582046 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:22:45.598915 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:22:45.601981 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m22:22:45.749385 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:22:45.757489 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m22:22:45.767285 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:22:45.772340 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m22:22:46.071005 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:22:46.088193 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:22:46.088193 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:22:46.088193 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:22:46.762366 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:22:46.782755 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:22:46.785372 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m22:22:47.067307 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:22:47.085760 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:22:47.085760 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m22:22:48.604455 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:22:48.657354 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:22:48.657354 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:22:48.664315 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:22:49.737101 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:22:49.757533 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:22:49.757533 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m22:22:50.141006 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:22:50.164942 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m22:22:50.168997 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:22:50.168997 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m22:22:50.607323 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:22:50.627095 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:22:50.627095 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:22:50.632168 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m22:22:50.779435 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:22:50.804633 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m22:22:50.807184 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m22:22:50.957297 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:22:50.960501 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 22:22:43.070621 => 22:22:50.960501
[0m22:22:50.960501 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m22:22:51.258180 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m22:22:51.287579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c89c86e2-9b36-427e-a949-2611349a2a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224602AEA50>]}
[0m22:22:51.289591 [info ] [Thread-1 (]: 1 of 5 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 8.24s]
[0m22:22:51.289591 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m22:22:51.289591 [debug] [Thread-1 (]: Began running node model.analytics_dbt.tb_vendas_primeiro_trimestre
[0m22:22:51.297124 [info ] [Thread-1 (]: 2 of 5 START sql table model public.tb_vendas_primeiro_trimestre ............... [RUN]
[0m22:22:51.300235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.tb_vendas_primeiro_trimestre)
[0m22:22:51.302345 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.tb_vendas_primeiro_trimestre
[0m22:22:51.307357 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:22:51.307357 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.tb_vendas_primeiro_trimestre (compile): 22:22:51.302345 => 22:22:51.307357
[0m22:22:51.307357 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.tb_vendas_primeiro_trimestre
[0m22:22:51.324376 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:22:51.328665 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:22:51.328665 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
[0m22:22:51.335811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:22:51.337421 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:22:51.337421 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:22:52.673231 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:22:52.693043 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:22:52.693043 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */

  
    

  create  table
    "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp"
    
    
    
  as (
    -- cria a fonte com os dados de data e converte os nomes das colunas
WITH source_date AS (
    SELECT dateid AS id_date,
           month AS mes,
           year AS ano
    FROM date
),

-- cria uma fonte de dados unindo a tabela sales com date
sales_date AS (
    SELECT sd.mes,
           SUM(s.quantidade_vendida) AS total_vendas
    FROM source_date sd
    INNER JOIN vw_sales s ON s.id_date = sd.id_date
    WHERE sd.mes IN ('JAN', 'FEB', 'MAR')
      AND sd.ano = 2008
    GROUP BY sd.mes
)

SELECT * FROM sales_date
  );
[0m22:22:53.237536 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:22:53.257306 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
[0m22:22:53.262316 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:22:53.264765 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
[0m22:22:54.026668 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:22:54.046826 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:22:54.049488 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
[0m22:22:54.203421 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:22:54.238324 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."tb_vendas_primeiro_trimestre"
[0m22:22:54.247208 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:22:54.250817 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
drop table if exists "dev"."public"."tb_vendas_primeiro_trimestre" cascade
[0m22:22:54.551728 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:22:54.571446 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
[0m22:22:54.571446 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:22:54.577738 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
[0m22:22:55.135575 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:22:55.154182 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:22:55.157309 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
[0m22:22:55.307291 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:22:55.335253 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:22:55.338519 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
alter table "dev"."public"."tb_vendas_primeiro_trimestre__dbt_tmp" rename to "tb_vendas_primeiro_trimestre"
[0m22:22:56.361276 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:22:56.387536 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
[0m22:22:56.394956 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:22:56.397575 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
[0m22:22:57.204362 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:22:57.224227 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:22:57.226261 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
[0m22:22:57.677412 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:22:57.689515 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."tb_vendas_primeiro_trimestre__dbt_backup"
[0m22:22:57.693487 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:22:57.693487 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_vendas_primeiro_trimestre"} */
drop table if exists "dev"."public"."tb_vendas_primeiro_trimestre__dbt_backup" cascade
[0m22:22:58.230975 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:22:58.237266 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
[0m22:22:58.237266 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:22:58.242836 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: COMMIT
[0m22:22:58.535976 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:22:58.539918 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_vendas_primeiro_trimestre"
[0m22:22:58.542074 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: BEGIN
[0m22:22:58.690920 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:22:58.712397 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.tb_vendas_primeiro_trimestre (execute): 22:22:51.307357 => 22:22:58.711512
[0m22:22:58.713721 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: ROLLBACK
[0m22:22:59.009275 [debug] [Thread-1 (]: On model.analytics_dbt.tb_vendas_primeiro_trimestre: Close
[0m22:22:59.029871 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c89c86e2-9b36-427e-a949-2611349a2a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224607D2E10>]}
[0m22:22:59.035191 [info ] [Thread-1 (]: 2 of 5 OK created sql table model public.tb_vendas_primeiro_trimestre .......... [[32mSUCCESS[0m in 7.73s]
[0m22:22:59.040393 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.tb_vendas_primeiro_trimestre
[0m22:22:59.041926 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m22:22:59.041926 [info ] [Thread-1 (]: 3 of 5 START sql view model public.vw_sales .................................... [RUN]
[0m22:22:59.050160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.tb_vendas_primeiro_trimestre, now model.analytics_dbt.vw_sales)
[0m22:22:59.057385 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m22:22:59.067573 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m22:22:59.074170 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 22:22:59.060031 => 22:22:59.074170
[0m22:22:59.077370 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m22:22:59.157328 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m22:22:59.172081 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:22:59.177832 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m22:22:59.180359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:22:59.180359 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:22:59.189049 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:23:00.584763 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:23:00.602441 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:23:00.606182 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales

),



renamed as (

    select 
        SALESID AS ID_VENDAS,
        LISTID AS ID_LISTA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        cast(SALETIME as date) AS DATA_VENDA,
        to_char( SALETIME, 'dd/mm/yyy hh24:mi:ss') as DATA_HORA_VENDA,
        to_char( SALETIME, 'hh24:mi:ss') as HORA_VENDA
     from source_sales

)

SELECT * FROM renamed
  ) ;
[0m22:23:01.197256 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:23:01.217970 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:23:01.217970 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:23:01.223212 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:23:01.951493 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:23:01.954085 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:23:01.957608 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m22:23:02.263495 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:23:02.277294 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales"
[0m22:23:02.289655 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:23:02.297239 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales" cascade
[0m22:23:02.593341 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:23:02.597670 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:23:02.600733 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:23:02.601524 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:23:03.089093 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:23:03.113809 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:23:03.118051 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m22:23:03.268933 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:23:03.297386 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:23:03.297386 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m22:23:04.173259 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:23:04.193022 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:23:04.193022 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:23:04.193022 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:23:04.991480 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:23:05.009817 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:23:05.009817 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m22:23:05.437202 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:23:05.447454 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales__dbt_backup"
[0m22:23:05.457381 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:23:05.460604 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m22:23:06.108899 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:23:06.131915 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:23:06.135405 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:23:06.137939 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m22:23:06.840384 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:23:06.859494 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m22:23:06.859494 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m22:23:07.012667 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:23:07.018007 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 22:22:59.080097 => 22:23:07.018007
[0m22:23:07.018007 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m22:23:07.317880 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m22:23:07.339203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c89c86e2-9b36-427e-a949-2611349a2a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224607D3290>]}
[0m22:23:07.341712 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.vw_sales ............................... [[32mSUCCESS[0m in 8.29s]
[0m22:23:07.347445 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m22:23:07.349956 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m22:23:07.352300 [info ] [Thread-1 (]: 4 of 5 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m22:23:07.359675 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m22:23:07.360517 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m22:23:07.377266 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m22:23:07.383993 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 22:23:07.367121 => 22:23:07.383281
[0m22:23:07.387438 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m22:23:07.407266 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m22:23:07.420657 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:23:07.423645 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m22:23:07.427237 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:07.429304 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:23:07.431856 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:23:08.807773 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:23:08.828719 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:23:08.831839 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m22:23:09.414599 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:23:09.436297 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:23:09.437414 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m22:23:09.864084 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:23:09.889865 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m22:23:09.893485 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:23:09.893485 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m22:23:10.565762 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:23:10.587314 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:23:10.589563 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m22:23:11.068513 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:23:11.095327 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m22:23:11.101216 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:23:11.102843 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m22:23:11.561598 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:23:11.583467 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m22:23:11.586459 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:23:11.589485 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m22:23:11.847290 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:23:11.851734 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m22:23:11.855029 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m22:23:12.068547 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:23:12.075194 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 22:23:07.388647 => 22:23:12.075194
[0m22:23:12.078170 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m22:23:12.390722 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m22:23:12.400971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c89c86e2-9b36-427e-a949-2611349a2a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022460B8B5C0>]}
[0m22:23:12.407260 [info ] [Thread-1 (]: 4 of 5 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 5.04s]
[0m22:23:12.408979 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m22:23:12.408979 [debug] [Thread-1 (]: Began running node model.analytics_dbt.tb_top_10_compradores
[0m22:23:12.412508 [info ] [Thread-1 (]: 5 of 5 START sql table model public.tb_top_10_compradores ...................... [RUN]
[0m22:23:12.417750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_second_dbt_model, now model.analytics_dbt.tb_top_10_compradores)
[0m22:23:12.420096 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.tb_top_10_compradores
[0m22:23:12.431207 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.tb_top_10_compradores"
[0m22:23:12.458455 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.tb_top_10_compradores (compile): 22:23:12.423158 => 22:23:12.457546
[0m22:23:12.458455 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.tb_top_10_compradores
[0m22:23:12.480880 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.tb_top_10_compradores"
[0m22:23:12.497167 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:23:12.497167 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: BEGIN
[0m22:23:12.505532 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:12.507039 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:23:12.507039 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:23:13.887213 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:23:13.892235 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:23:13.897287 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_top_10_compradores"} */

  
    

  create  table
    "dev"."public"."tb_top_10_compradores__dbt_tmp"
    
    
    
  as (
    with sales as(
	select * from vw_sales
	--"dev"."public"."vw_sales"
),

compradores as (
	select
		(firstname||' '|| lastname) as Nome_Completo, userid
	from users
),

top_10_compradores as(
	select 
	  compradores.Nome_completo as Nome_completo,
	  sum(sales.quantidade_vendida) as Vendas_totais,
	  sales.comissao as Comissao
	from sales inner join compradores
    on sales.id_comprador = compradores.userid
    group by compradores.userid, compradores.Nome_completo, sales.comissao
    order by Vendas_totais desc
    limit 10
)

select * from top_10_compradores
  );
[0m22:23:14.268370 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:23:14.291654 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:23:14.291654 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:23:14.297190 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:23:15.016607 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:23:15.035393 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:23:15.037466 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: BEGIN
[0m22:23:15.182381 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:23:15.207784 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."tb_top_10_compradores"
[0m22:23:15.218490 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:23:15.218490 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_top_10_compradores"} */
drop table if exists "dev"."public"."tb_top_10_compradores" cascade
[0m22:23:15.512260 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:23:15.520241 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:23:15.525609 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:23:15.531294 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:23:15.997284 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:23:16.019847 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:23:16.023500 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: BEGIN
[0m22:23:16.169005 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:23:16.187279 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:23:16.189565 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_top_10_compradores"} */
alter table "dev"."public"."tb_top_10_compradores__dbt_tmp" rename to "tb_top_10_compradores"
[0m22:23:17.835073 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:23:17.857688 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:23:17.867651 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:23:17.872208 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:23:18.789658 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:23:18.808403 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:23:18.812439 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: BEGIN
[0m22:23:19.100609 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:23:19.135666 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."tb_top_10_compradores__dbt_backup"
[0m22:23:19.137289 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:23:19.145742 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_top_10_compradores"} */
drop table if exists "dev"."public"."tb_top_10_compradores__dbt_backup" cascade
[0m22:23:19.428847 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:23:19.452437 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:23:19.452437 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:23:19.457692 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m22:23:19.608010 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:23:19.629092 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m22:23:19.634498 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: BEGIN
[0m22:23:19.778398 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:23:19.800639 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.tb_top_10_compradores (execute): 22:23:12.464144 => 22:23:19.800350
[0m22:23:19.802679 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: ROLLBACK
[0m22:23:20.087740 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: Close
[0m22:23:20.110486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c89c86e2-9b36-427e-a949-2611349a2a2c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224607D2D50>]}
[0m22:23:20.110486 [info ] [Thread-1 (]: 5 of 5 OK created sql table model public.tb_top_10_compradores ................. [[32mSUCCESS[0m in 7.69s]
[0m22:23:20.117456 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.tb_top_10_compradores
[0m22:23:20.130167 [debug] [MainThread]: Using redshift connection "master"
[0m22:23:20.136297 [debug] [MainThread]: On master: BEGIN
[0m22:23:20.137444 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:23:20.142475 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:23:20.147708 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:23:21.575347 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m22:23:21.577646 [debug] [MainThread]: On master: COMMIT
[0m22:23:21.583887 [debug] [MainThread]: Using redshift connection "master"
[0m22:23:21.587255 [debug] [MainThread]: On master: COMMIT
[0m22:23:21.883654 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:23:21.902684 [debug] [MainThread]: On master: Close
[0m22:23:21.907215 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:23:21.907215 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m22:23:21.914061 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m22:23:21.914878 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_top_10_compradores' was properly closed.
[0m22:23:21.917485 [info ] [MainThread]: 
[0m22:23:21.922529 [info ] [MainThread]: Finished running 3 table models, 2 view models in 0 hours 0 minutes and 50.53 seconds (50.53s).
[0m22:23:21.934076 [debug] [MainThread]: Command end result
[0m22:23:21.987636 [info ] [MainThread]: 
[0m22:23:21.987636 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:23:21.999371 [info ] [MainThread]: 
[0m22:23:22.003863 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m22:23:22.012154 [debug] [MainThread]: Command `dbt run` succeeded at 22:23:22.008129 after 51.68 seconds
[0m22:23:22.016672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002245F5BFFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022460616870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002245E1FA330>]}
[0m22:23:22.019661 [debug] [MainThread]: Flushing usage events
[0m22:27:18.171910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A779163C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A779178C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A779170B0>]}


============================== 22:27:18.181604 | 8151fd74-fe74-4ccf-af75-b85306f53fac ==============================
[0m22:27:18.181604 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:27:18.181604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:27:18.931691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8151fd74-fe74-4ccf-af75-b85306f53fac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A778F7B00>]}
[0m22:27:19.073667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8151fd74-fe74-4ccf-af75-b85306f53fac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A784B12B0>]}
[0m22:27:19.075197 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m22:27:19.101889 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:27:19.291860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:27:19.311370 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://tests\test_singular_nao_negativo.sql
[0m22:27:19.508926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8151fd74-fe74-4ccf-af75-b85306f53fac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A788AFB90>]}
[0m22:27:19.531832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8151fd74-fe74-4ccf-af75-b85306f53fac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A785949B0>]}
[0m22:27:19.531832 [info ] [MainThread]: Found 5 models, 5 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m22:27:19.541652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8151fd74-fe74-4ccf-af75-b85306f53fac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A785946B0>]}
[0m22:27:19.541652 [info ] [MainThread]: 
[0m22:27:19.551918 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:27:19.553053 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m22:27:19.604253 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:27:19.604253 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m22:27:19.604253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:27:19.621375 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:27:19.621375 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:27:22.731989 [debug] [ThreadPool]: SQL status: SUCCESS in 3.0 seconds
[0m22:27:22.731989 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:27:22.736399 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m22:27:23.406085 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m22:27:23.411591 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m22:27:24.163119 [debug] [ThreadPool]: On list_dev_public: Close
[0m22:27:24.203712 [debug] [MainThread]: Using redshift connection "master"
[0m22:27:24.208346 [debug] [MainThread]: On master: BEGIN
[0m22:27:24.208346 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:27:24.211522 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:27:24.211522 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:27:25.864933 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m22:27:25.864933 [debug] [MainThread]: Using redshift connection "master"
[0m22:27:25.864933 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:27:26.314107 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:27:26.317803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8151fd74-fe74-4ccf-af75-b85306f53fac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A78594C50>]}
[0m22:27:26.321322 [debug] [MainThread]: On master: ROLLBACK
[0m22:27:26.931451 [debug] [MainThread]: Using redshift connection "master"
[0m22:27:26.948580 [debug] [MainThread]: On master: BEGIN
[0m22:27:27.607357 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m22:27:27.612821 [debug] [MainThread]: On master: COMMIT
[0m22:27:27.614275 [debug] [MainThread]: Using redshift connection "master"
[0m22:27:27.614275 [debug] [MainThread]: On master: COMMIT
[0m22:27:28.031884 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:27:28.053244 [debug] [MainThread]: On master: Close
[0m22:27:28.054556 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:27:28.061591 [info ] [MainThread]: 
[0m22:27:28.070198 [debug] [Thread-1 (]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:27:28.071782 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:27:28.075817 [debug] [Thread-1 (]: Acquiring new redshift connection 'test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:27:28.075817 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:27:28.096394 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:27:28.102343 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 22:27:28.077917 => 22:27:28.102343
[0m22:27:28.102343 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:27:28.131424 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:27:28.141569 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:27:28.141569 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m22:27:28.143501 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:27:28.143501 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:27:28.143501 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:27:29.431821 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:27:29.435526 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:27:29.436584 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m22:27:29.761983 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:27:29.785784 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 22:27:28.102343 => 22:27:29.785784
[0m22:27:29.791942 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m22:27:30.093222 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:27:30.111683 [error] [Thread-1 (]: 1 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.04s]
[0m22:27:30.116773 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:27:30.116773 [debug] [Thread-1 (]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:27:30.120786 [info ] [Thread-1 (]: 2 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m22:27:30.122184 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710, now test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778)
[0m22:27:30.124186 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:27:30.133810 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:27:30.138555 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778 (compile): 22:27:30.124186 => 22:27:30.138555
[0m22:27:30.140588 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:27:30.141693 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:27:30.146573 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:27:30.151829 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m22:27:30.152751 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:30.152751 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:27:30.156767 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:27:31.463657 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:27:31.481658 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:27:31.481658 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m22:27:32.053753 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:27:32.073666 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778 (execute): 22:27:30.141693 => 22:27:32.073666
[0m22:27:32.073666 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m22:27:32.811761 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m22:27:32.831523 [info ] [Thread-1 (]: 2 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 2.71s]
[0m22:27:32.836567 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:27:32.841997 [debug] [Thread-1 (]: Began running node test.analytics_dbt.test_singular_nao_negativo
[0m22:27:32.843945 [info ] [Thread-1 (]: 3 of 5 START test test_singular_nao_negativo ................................... [RUN]
[0m22:27:32.852246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778, now test.analytics_dbt.test_singular_nao_negativo)
[0m22:27:32.855613 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
[0m22:27:32.855613 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m22:27:32.861796 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.test_singular_nao_negativo (compile): 22:27:32.855613 => 22:27:32.861796
[0m22:27:32.867180 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.test_singular_nao_negativo
[0m22:27:32.871454 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.test_singular_nao_negativo"
[0m22:27:32.881683 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m22:27:32.885350 [debug] [Thread-1 (]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
[0m22:27:32.885350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:32.888812 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:27:32.891947 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:27:34.672598 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:27:34.689495 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m22:27:34.689495 [debug] [Thread-1 (]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      --testa se existe valores menores que zero (negativos)
select *
    from tb_10_compradores
    where vendas_totais < 0
      
    ) dbt_internal_test
[0m22:27:34.893620 [debug] [Thread-1 (]: Redshift adapter: Redshift error: relation "tb_10_compradores" does not exist
[0m22:27:34.897620 [debug] [Thread-1 (]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
[0m22:27:35.287898 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.test_singular_nao_negativo (execute): 22:27:32.868940 => 22:27:35.286673
[0m22:27:35.304876 [debug] [Thread-1 (]: On test.analytics_dbt.test_singular_nao_negativo: Close
[0m22:27:35.311706 [debug] [Thread-1 (]: Database Error in test test_singular_nao_negativo (tests\test_singular_nao_negativo.sql)
  relation "tb_10_compradores" does not exist
  compiled Code at target\run\analytics_dbt\tests\test_singular_nao_negativo.sql
[0m22:27:35.311706 [error] [Thread-1 (]: 3 of 5 ERROR test_singular_nao_negativo ........................................ [[31mERROR[0m in 2.46s]
[0m22:27:35.316762 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.test_singular_nao_negativo
[0m22:27:35.316762 [debug] [Thread-1 (]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:27:35.316762 [info ] [Thread-1 (]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:27:35.323170 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.test_singular_nao_negativo, now test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321)
[0m22:27:35.324863 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:27:35.338029 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:27:35.341904 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321 (compile): 22:27:35.324863 => 22:27:35.341904
[0m22:27:35.341904 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:27:35.351553 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:27:35.358643 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:27:35.359986 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m22:27:35.363755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:35.363755 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:27:35.363755 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:27:37.981631 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m22:27:38.005470 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:27:38.005470 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:27:38.440206 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:27:38.461582 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321 (execute): 22:27:35.341904 => 22:27:38.461582
[0m22:27:38.461582 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m22:27:39.184140 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:27:39.191661 [info ] [Thread-1 (]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 3.86s]
[0m22:27:39.191885 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:27:39.191885 [debug] [Thread-1 (]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:27:39.191885 [info ] [Thread-1 (]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m22:27:39.199333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321, now test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493)
[0m22:27:39.201357 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:27:39.205217 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:27:39.205217 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493 (compile): 22:27:39.201357 => 22:27:39.205217
[0m22:27:39.211792 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:27:39.223554 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:27:39.231822 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:27:39.231822 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m22:27:39.234445 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:27:39.234445 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:27:39.234445 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:27:42.663342 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m22:27:42.663342 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:27:42.671416 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:27:43.144225 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:27:43.152364 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493 (execute): 22:27:39.211792 => 22:27:43.152364
[0m22:27:43.152364 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m22:27:43.726606 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m22:27:43.744500 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 4.55s]
[0m22:27:43.762608 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:27:43.768844 [debug] [MainThread]: Using redshift connection "master"
[0m22:27:43.773230 [debug] [MainThread]: On master: BEGIN
[0m22:27:43.773230 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:27:43.776756 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:27:43.776756 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:27:45.941748 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m22:27:45.961590 [debug] [MainThread]: On master: COMMIT
[0m22:27:45.961590 [debug] [MainThread]: Using redshift connection "master"
[0m22:27:45.961590 [debug] [MainThread]: On master: COMMIT
[0m22:27:46.241813 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:27:46.262121 [debug] [MainThread]: On master: Close
[0m22:27:46.262121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:27:46.262121 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m22:27:46.269149 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m22:27:46.269149 [info ] [MainThread]: 
[0m22:27:46.271661 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 26.73 seconds (26.73s).
[0m22:27:46.273256 [debug] [MainThread]: Command end result
[0m22:27:46.291972 [info ] [MainThread]: 
[0m22:27:46.297349 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:27:46.302048 [info ] [MainThread]: 
[0m22:27:46.305026 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:27:46.305026 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:27:46.308540 [info ] [MainThread]: 
[0m22:27:46.312244 [info ] [MainThread]:   compiled Code at target\compiled\analytics_dbt\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:27:46.315071 [info ] [MainThread]: 
[0m22:27:46.316978 [error] [MainThread]:   Database Error in test test_singular_nao_negativo (tests\test_singular_nao_negativo.sql)
  relation "tb_10_compradores" does not exist
  compiled Code at target\run\analytics_dbt\tests\test_singular_nao_negativo.sql
[0m22:27:46.321457 [info ] [MainThread]: 
[0m22:27:46.324327 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m22:27:46.328116 [debug] [MainThread]: Command `dbt test` failed at 22:27:46.328116 after 28.28 seconds
[0m22:27:46.332804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A77686630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A78310E90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A77953200>]}
[0m22:27:46.333886 [debug] [MainThread]: Flushing usage events
[0m22:28:15.608682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7883164B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F788317D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F788316ED0>]}


============================== 22:28:15.633784 | 6d8d08e7-6c55-478e-9f7a-f97a07b428ee ==============================
[0m22:28:15.633784 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:28:15.642084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:28:16.274507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d8d08e7-6c55-478e-9f7a-f97a07b428ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7881BFC80>]}
[0m22:28:16.401738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d8d08e7-6c55-478e-9f7a-f97a07b428ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F788314980>]}
[0m22:28:16.421364 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m22:28:16.465328 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:28:16.695625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:28:16.713710 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://tests\test_singular_nao_negativo.sql
[0m22:28:16.872413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d8d08e7-6c55-478e-9f7a-f97a07b428ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7892A10A0>]}
[0m22:28:16.891922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d8d08e7-6c55-478e-9f7a-f97a07b428ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F788F948F0>]}
[0m22:28:16.891922 [info ] [MainThread]: Found 5 models, 5 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m22:28:16.891922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d8d08e7-6c55-478e-9f7a-f97a07b428ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F788F94560>]}
[0m22:28:16.899492 [info ] [MainThread]: 
[0m22:28:16.902989 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:28:16.906891 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m22:28:16.941599 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:28:16.941599 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m22:28:16.941599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:28:16.947457 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:28:16.952456 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:28:19.463496 [debug] [ThreadPool]: SQL status: SUCCESS in 3.0 seconds
[0m22:28:19.465422 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:28:19.468466 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m22:28:19.827243 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m22:28:19.832376 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m22:28:20.131476 [debug] [ThreadPool]: On list_dev_public: Close
[0m22:28:20.179404 [debug] [MainThread]: Using redshift connection "master"
[0m22:28:20.181592 [debug] [MainThread]: On master: BEGIN
[0m22:28:20.184229 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:28:20.185980 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:28:20.185980 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:28:21.518628 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m22:28:21.535121 [debug] [MainThread]: Using redshift connection "master"
[0m22:28:21.535121 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:28:21.871777 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:28:21.895699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d8d08e7-6c55-478e-9f7a-f97a07b428ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F788F950D0>]}
[0m22:28:21.895699 [debug] [MainThread]: On master: ROLLBACK
[0m22:28:22.216142 [debug] [MainThread]: Using redshift connection "master"
[0m22:28:22.234236 [debug] [MainThread]: On master: BEGIN
[0m22:28:22.372017 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:28:22.395339 [debug] [MainThread]: On master: COMMIT
[0m22:28:22.397355 [debug] [MainThread]: Using redshift connection "master"
[0m22:28:22.400301 [debug] [MainThread]: On master: COMMIT
[0m22:28:22.685827 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:28:22.685827 [debug] [MainThread]: On master: Close
[0m22:28:22.691429 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:28:22.692442 [info ] [MainThread]: 
[0m22:28:22.703033 [debug] [Thread-1 (]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:28:22.708550 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:28:22.711454 [debug] [Thread-1 (]: Acquiring new redshift connection 'test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:28:22.711454 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:28:22.741488 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:28:22.754040 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 22:28:22.714867 => 22:28:22.754040
[0m22:28:22.757701 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:28:22.802594 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:28:22.809658 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:28:22.812219 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m22:28:22.812219 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:28:22.817239 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:28:22.820286 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:28:24.481890 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:28:24.504006 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:28:24.506960 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m22:28:24.841552 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:28:24.861620 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 22:28:22.757701 => 22:28:24.861620
[0m22:28:24.861620 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m22:28:25.328569 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:28:25.331837 [error] [Thread-1 (]: 1 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.62s]
[0m22:28:25.336924 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:28:25.340415 [debug] [Thread-1 (]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:28:25.342584 [info ] [Thread-1 (]: 2 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m22:28:25.346104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710, now test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778)
[0m22:28:25.349790 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:28:25.364314 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:28:25.371494 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778 (compile): 22:28:25.353784 => 22:28:25.371494
[0m22:28:25.373408 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:28:25.386581 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:28:25.393632 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:28:25.396287 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m22:28:25.399799 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:28:25.403789 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:28:25.407892 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:28:26.771799 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:28:26.773340 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:28:26.773340 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m22:28:27.071460 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:28:27.093342 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778 (execute): 22:28:25.376921 => 22:28:27.093342
[0m22:28:27.099841 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m22:28:27.393890 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m22:28:27.401651 [info ] [Thread-1 (]: 2 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 2.06s]
[0m22:28:27.401651 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:28:27.412605 [debug] [Thread-1 (]: Began running node test.analytics_dbt.test_singular_nao_negativo
[0m22:28:27.416632 [info ] [Thread-1 (]: 3 of 5 START test test_singular_nao_negativo ................................... [RUN]
[0m22:28:27.421953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778, now test.analytics_dbt.test_singular_nao_negativo)
[0m22:28:27.426476 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
[0m22:28:27.433307 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m22:28:27.448554 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.test_singular_nao_negativo (compile): 22:28:27.426476 => 22:28:27.442497
[0m22:28:27.452101 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.test_singular_nao_negativo
[0m22:28:27.471545 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.test_singular_nao_negativo"
[0m22:28:27.483815 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m22:28:27.489835 [debug] [Thread-1 (]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
[0m22:28:27.491486 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:28:27.496511 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:28:27.498029 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:28:30.271547 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m22:28:30.294881 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m22:28:30.298128 [debug] [Thread-1 (]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      --testa se existe valores menores que zero (negativos)
select *
    from tb_top_10_compradores
    where vendas_totais < 0
      
    ) dbt_internal_test
[0m22:28:31.131462 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:28:31.155667 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.test_singular_nao_negativo (execute): 22:28:27.454485 => 22:28:31.155667
[0m22:28:31.161751 [debug] [Thread-1 (]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
[0m22:28:31.651462 [debug] [Thread-1 (]: On test.analytics_dbt.test_singular_nao_negativo: Close
[0m22:28:31.672559 [info ] [Thread-1 (]: 3 of 5 PASS test_singular_nao_negativo ......................................... [[32mPASS[0m in 4.25s]
[0m22:28:31.672559 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.test_singular_nao_negativo
[0m22:28:31.685271 [debug] [Thread-1 (]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:28:31.687103 [info ] [Thread-1 (]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:28:31.691254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.test_singular_nao_negativo, now test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321)
[0m22:28:31.691254 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:28:31.732986 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:28:31.745490 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321 (compile): 22:28:31.701334 => 22:28:31.744435
[0m22:28:31.748658 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:28:31.765319 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:28:31.772436 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:28:31.782906 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m22:28:31.786443 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:28:31.791688 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:28:31.791688 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:28:33.698721 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:28:33.698721 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:28:33.704366 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:28:33.988925 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:28:34.016876 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321 (execute): 22:28:31.751699 => 22:28:34.015847
[0m22:28:34.017567 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m22:28:34.300134 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:28:34.325969 [info ] [Thread-1 (]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 2.63s]
[0m22:28:34.325969 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:28:34.325969 [debug] [Thread-1 (]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:28:34.343761 [info ] [Thread-1 (]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m22:28:34.352205 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321, now test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493)
[0m22:28:34.352205 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:28:34.373140 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:28:34.386843 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493 (compile): 22:28:34.352205 => 22:28:34.381326
[0m22:28:34.389406 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:28:34.404602 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:28:34.421107 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:28:34.421107 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m22:28:34.429161 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:28:34.431737 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:28:34.437349 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:28:35.920283 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:28:35.923478 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:28:35.926916 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:28:36.222339 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:28:36.231492 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493 (execute): 22:28:34.389406 => 22:28:36.231492
[0m22:28:36.233908 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m22:28:36.527657 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m22:28:36.553269 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 2.20s]
[0m22:28:36.560377 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:28:36.570489 [debug] [MainThread]: Using redshift connection "master"
[0m22:28:36.575820 [debug] [MainThread]: On master: BEGIN
[0m22:28:36.580698 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:28:36.584543 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:28:36.588409 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:28:37.964663 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m22:28:37.966372 [debug] [MainThread]: On master: COMMIT
[0m22:28:37.971984 [debug] [MainThread]: Using redshift connection "master"
[0m22:28:37.973776 [debug] [MainThread]: On master: COMMIT
[0m22:28:38.257556 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:28:38.274873 [debug] [MainThread]: On master: Close
[0m22:28:38.281279 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:28:38.284369 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m22:28:38.286690 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m22:28:38.290673 [info ] [MainThread]: 
[0m22:28:38.293667 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 21.39 seconds (21.39s).
[0m22:28:38.304034 [debug] [MainThread]: Command end result
[0m22:28:38.356485 [info ] [MainThread]: 
[0m22:28:38.363872 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:28:38.368572 [info ] [MainThread]: 
[0m22:28:38.372137 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:28:38.377690 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:28:38.384668 [info ] [MainThread]: 
[0m22:28:38.389250 [info ] [MainThread]:   compiled Code at target\compiled\analytics_dbt\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:28:38.392295 [info ] [MainThread]: 
[0m22:28:38.399215 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m22:28:38.408177 [debug] [MainThread]: Command `dbt test` failed at 22:28:38.405887 after 22.93 seconds
[0m22:28:38.412298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7885875F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7881EEA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F788224B90>]}
[0m22:28:38.417827 [debug] [MainThread]: Flushing usage events
[0m22:39:02.207828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C90615E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C906152B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C90614DA0>]}


============================== 22:39:02.232056 | 6a8e12f9-6b96-4654-8d53-8b18f1752cc2 ==============================
[0m22:39:02.232056 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:39:02.234815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m22:39:02.918333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a8e12f9-6b96-4654-8d53-8b18f1752cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C902EF350>]}
[0m22:39:03.080021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a8e12f9-6b96-4654-8d53-8b18f1752cc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C902A0E00>]}
[0m22:39:03.083315 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m22:39:03.105502 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:39:03.293206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m22:39:03.293206 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://macros\test_nao_negativo.sql
[0m22:39:03.298233 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models\example\schema.yml
[0m22:39:03.581650 [error] [MainThread]: Encountered an error:
Compilation Error in test nao_negativo_tb_top_10_compradores_vendas_totais (models\example\schema.yml)
  macro 'dbt_macro__test_nao_negativo' takes no keyword argument 'column_name'
[0m22:39:03.583244 [debug] [MainThread]: Command `dbt test` failed at 22:39:03.583244 after 1.48 seconds
[0m22:39:03.583244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C90003230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C903FB3E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C90BCCC20>]}
[0m22:39:03.583244 [debug] [MainThread]: Flushing usage events
[0m22:39:43.627044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC29DCC230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC29F36840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC29F36A20>]}


============================== 22:39:43.651908 | 3b836c74-f196-4528-9819-f0851174e342 ==============================
[0m22:39:43.651908 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:39:43.656970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:39:44.247138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b836c74-f196-4528-9819-f0851174e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2AB10800>]}
[0m22:39:44.416023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b836c74-f196-4528-9819-f0851174e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC29F73B00>]}
[0m22:39:44.433791 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m22:39:44.466088 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:39:44.666211 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m22:39:44.687338 [debug] [MainThread]: Partial parsing: added file: analytics_dbt://macros\test_nao_negativo.sql
[0m22:39:44.687338 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models\example\schema.yml
[0m22:39:44.966353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b836c74-f196-4528-9819-f0851174e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2B07DD90>]}
[0m22:39:44.993332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b836c74-f196-4528-9819-f0851174e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2AFDFF80>]}
[0m22:39:44.994961 [info ] [MainThread]: Found 5 models, 7 tests, 0 sources, 0 exposures, 0 metrics, 456 macros, 0 groups, 0 semantic models
[0m22:39:44.996850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b836c74-f196-4528-9819-f0851174e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC29DAD2E0>]}
[0m22:39:45.001379 [info ] [MainThread]: 
[0m22:39:45.004759 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:39:45.009071 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m22:39:45.036637 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:39:45.039494 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m22:39:45.042041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:39:45.046108 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:39:45.052172 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:39:47.949732 [debug] [ThreadPool]: SQL status: SUCCESS in 3.0 seconds
[0m22:39:47.952098 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:39:47.953969 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m22:39:48.521256 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m22:39:48.541690 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m22:39:49.340320 [debug] [ThreadPool]: On list_dev_public: Close
[0m22:39:49.387025 [debug] [MainThread]: Using redshift connection "master"
[0m22:39:49.389452 [debug] [MainThread]: On master: BEGIN
[0m22:39:49.389452 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:39:49.389452 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:39:49.396109 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:39:51.728953 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m22:39:51.728953 [debug] [MainThread]: Using redshift connection "master"
[0m22:39:51.728953 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:39:52.410737 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m22:39:52.416447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b836c74-f196-4528-9819-f0851174e342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2AFDFC20>]}
[0m22:39:52.417807 [debug] [MainThread]: On master: ROLLBACK
[0m22:39:52.967519 [debug] [MainThread]: Using redshift connection "master"
[0m22:39:52.986172 [debug] [MainThread]: On master: BEGIN
[0m22:39:53.226066 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:39:53.237206 [debug] [MainThread]: On master: COMMIT
[0m22:39:53.241309 [debug] [MainThread]: Using redshift connection "master"
[0m22:39:53.241309 [debug] [MainThread]: On master: COMMIT
[0m22:39:54.066127 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m22:39:54.083978 [debug] [MainThread]: On master: Close
[0m22:39:54.087361 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:39:54.090463 [info ] [MainThread]: 
[0m22:39:54.097508 [debug] [Thread-1 (]: Began running node test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9
[0m22:39:54.097508 [info ] [Thread-1 (]: 1 of 7 START test nao_negativo_tb_top_10_compradores_vendas_totais ............. [RUN]
[0m22:39:54.097508 [debug] [Thread-1 (]: Acquiring new redshift connection 'test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9'
[0m22:39:54.097508 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9
[0m22:39:54.107218 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9"
[0m22:39:54.109408 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9 (compile): 22:39:54.097508 => 22:39:54.109408
[0m22:39:54.109408 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9
[0m22:39:54.126081 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9"
[0m22:39:54.138829 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9"
[0m22:39:54.143025 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9: BEGIN
[0m22:39:54.143025 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:39:54.146057 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:39:54.146057 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:39:56.221020 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:39:56.225449 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9"
[0m22:39:56.226016 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select *
from "dev"."public"."tb_top_10_compradores"
where vendas_totais < 0


      
    ) dbt_internal_test
[0m22:39:56.525741 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:39:56.576230 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9 (execute): 22:39:54.109408 => 22:39:56.576230
[0m22:39:57.018314 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9: ROLLBACK
[0m22:39:57.323491 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9: Close
[0m22:39:57.326010 [info ] [Thread-1 (]: 1 of 7 PASS nao_negativo_tb_top_10_compradores_vendas_totais ................... [[32mPASS[0m in 3.23s]
[0m22:39:57.326010 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9
[0m22:39:57.326010 [debug] [Thread-1 (]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:39:57.326010 [info ] [Thread-1 (]: 2 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:39:57.335975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9, now test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710)
[0m22:39:57.338871 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:39:57.362153 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:39:57.366164 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 22:39:57.340749 => 22:39:57.362153
[0m22:39:57.366164 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:39:57.376691 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:39:57.376691 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:39:57.376691 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m22:39:57.376691 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:39:57.386231 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:39:57.386231 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:39:58.643505 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:39:58.660364 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:39:58.660364 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m22:39:58.944999 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:39:58.967679 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 22:39:57.366164 => 22:39:58.967679
[0m22:39:58.967679 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m22:39:59.252869 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:39:59.256255 [error] [Thread-1 (]: 2 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.92s]
[0m22:39:59.258084 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:39:59.258084 [debug] [Thread-1 (]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:39:59.261097 [info ] [Thread-1 (]: 3 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m22:39:59.263717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710, now test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778)
[0m22:39:59.266618 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:39:59.280020 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:39:59.282063 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778 (compile): 22:39:59.267924 => 22:39:59.282063
[0m22:39:59.282063 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:39:59.290447 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:39:59.296476 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:39:59.296476 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m22:39:59.296476 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:39:59.296476 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:39:59.305350 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:40:01.221379 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:40:01.245427 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:40:01.246476 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m22:40:01.877381 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:40:01.911062 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778 (execute): 22:39:59.286129 => 22:40:01.906037
[0m22:40:01.915310 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m22:40:02.490390 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m22:40:02.496405 [info ] [Thread-1 (]: 3 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 3.23s]
[0m22:40:02.496405 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:40:02.502773 [debug] [Thread-1 (]: Began running node test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687
[0m22:40:02.505570 [info ] [Thread-1 (]: 4 of 7 START test not_null_tb_top_10_compradores_vendas_totais ................. [RUN]
[0m22:40:02.509710 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778, now test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687)
[0m22:40:02.511722 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687
[0m22:40:02.566162 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687"
[0m22:40:02.572276 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687 (compile): 22:40:02.558149 => 22:40:02.572276
[0m22:40:02.572276 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687
[0m22:40:02.577864 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687"
[0m22:40:02.585201 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687"
[0m22:40:02.586276 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687: BEGIN
[0m22:40:02.589867 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:02.589867 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:40:02.589867 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:40:04.906606 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:40:04.946654 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687"
[0m22:40:04.950281 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_top_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
[0m22:40:05.829336 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:40:05.861149 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687 (execute): 22:40:02.576353 => 22:40:05.861149
[0m22:40:05.866278 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687: ROLLBACK
[0m22:40:06.341546 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687: Close
[0m22:40:06.369704 [info ] [Thread-1 (]: 4 of 7 PASS not_null_tb_top_10_compradores_vendas_totais ....................... [[32mPASS[0m in 3.86s]
[0m22:40:06.373351 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687
[0m22:40:06.377127 [debug] [Thread-1 (]: Began running node test.analytics_dbt.test_singular_nao_negativo
[0m22:40:06.377127 [info ] [Thread-1 (]: 5 of 7 START test test_singular_nao_negativo ................................... [RUN]
[0m22:40:06.380417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687, now test.analytics_dbt.test_singular_nao_negativo)
[0m22:40:06.382346 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
[0m22:40:06.388080 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m22:40:06.392444 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.test_singular_nao_negativo (compile): 22:40:06.383676 => 22:40:06.391872
[0m22:40:06.393804 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.test_singular_nao_negativo
[0m22:40:06.398920 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.test_singular_nao_negativo"
[0m22:40:06.398920 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m22:40:06.403959 [debug] [Thread-1 (]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
[0m22:40:06.405931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:06.409622 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:40:06.409622 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:40:08.421443 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:40:08.440302 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m22:40:08.440302 [debug] [Thread-1 (]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      --testa se existe valores menores que zero (negativos)
select *
    from tb_top_10_compradores
    where vendas_totais < 0
      
    ) dbt_internal_test
[0m22:40:08.738287 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:40:08.738287 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.test_singular_nao_negativo (execute): 22:40:06.396394 => 22:40:08.738287
[0m22:40:08.738287 [debug] [Thread-1 (]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
[0m22:40:09.036099 [debug] [Thread-1 (]: On test.analytics_dbt.test_singular_nao_negativo: Close
[0m22:40:09.054605 [info ] [Thread-1 (]: 5 of 7 PASS test_singular_nao_negativo ......................................... [[32mPASS[0m in 2.68s]
[0m22:40:09.056262 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.test_singular_nao_negativo
[0m22:40:09.056262 [debug] [Thread-1 (]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:40:09.056262 [info ] [Thread-1 (]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:40:09.063066 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.test_singular_nao_negativo, now test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321)
[0m22:40:09.063066 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:40:09.076076 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:40:09.076076 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321 (compile): 22:40:09.065127 => 22:40:09.076076
[0m22:40:09.076076 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:40:09.076076 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:40:09.088347 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:40:09.093787 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m22:40:09.096377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:09.096377 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:40:09.096377 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:40:10.636217 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:40:10.656528 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:40:10.698127 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:40:11.306125 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:40:11.311895 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321 (execute): 22:40:09.076076 => 22:40:11.311895
[0m22:40:11.311895 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m22:40:11.874310 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:40:11.895930 [info ] [Thread-1 (]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 2.84s]
[0m22:40:11.895930 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:40:11.895930 [debug] [Thread-1 (]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:40:11.895930 [info ] [Thread-1 (]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m22:40:11.895930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321, now test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493)
[0m22:40:11.895930 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:40:11.910169 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:40:11.916238 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493 (compile): 22:40:11.895930 => 22:40:11.916238
[0m22:40:11.916238 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:40:11.922471 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:40:11.926306 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:40:11.926306 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m22:40:11.926306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:40:11.926306 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:40:11.926306 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:40:13.712655 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:40:13.736290 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:40:13.738416 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:40:14.036031 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:40:14.061707 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493 (execute): 22:40:11.916238 => 22:40:14.056012
[0m22:40:14.061707 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m22:40:14.626466 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m22:40:14.656239 [info ] [Thread-1 (]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 2.76s]
[0m22:40:14.661904 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:40:14.666605 [debug] [MainThread]: Using redshift connection "master"
[0m22:40:14.666605 [debug] [MainThread]: On master: BEGIN
[0m22:40:14.671129 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:40:14.671129 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:40:14.676212 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:40:16.546190 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m22:40:16.566238 [debug] [MainThread]: On master: COMMIT
[0m22:40:16.572229 [debug] [MainThread]: Using redshift connection "master"
[0m22:40:16.572229 [debug] [MainThread]: On master: COMMIT
[0m22:40:16.855867 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:40:16.879704 [debug] [MainThread]: On master: Close
[0m22:40:16.879704 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:40:16.879704 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m22:40:16.879704 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m22:40:16.879704 [info ] [MainThread]: 
[0m22:40:16.879704 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 31.88 seconds (31.88s).
[0m22:40:16.888901 [debug] [MainThread]: Command end result
[0m22:40:17.009442 [info ] [MainThread]: 
[0m22:40:17.009442 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:40:17.009442 [info ] [MainThread]: 
[0m22:40:17.015964 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:40:17.018560 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:40:17.022920 [info ] [MainThread]: 
[0m22:40:17.022920 [info ] [MainThread]:   compiled Code at target\compiled\analytics_dbt\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:40:17.025993 [info ] [MainThread]: 
[0m22:40:17.025993 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m22:40:17.025993 [debug] [MainThread]: Command `dbt test` failed at 22:40:17.025993 after 33.55 seconds
[0m22:40:17.025993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC29E47EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC29DCE4E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC2A641460>]}
[0m22:40:17.035952 [debug] [MainThread]: Flushing usage events
[0m22:42:48.282834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C41FF25DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C41FF26CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C41FF24530>]}


============================== 22:42:48.287452 | 81f7d720-b3ba-424e-aa8f-fceb4512d1fb ==============================
[0m22:42:48.287452 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:42:48.287452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:42:48.917506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81f7d720-b3ba-424e-aa8f-fceb4512d1fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C41F7D8F80>]}
[0m22:42:49.039231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81f7d720-b3ba-424e-aa8f-fceb4512d1fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C420B0B9E0>]}
[0m22:42:49.056430 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m22:42:49.079066 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:42:49.105836 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading analytics_dbt: example\schema.yml - Runtime Error
    Syntax error near line 39
    ------------------------------
    36 |         tests:
    37 |           - nao_negativo
    38 |           - not_null
    39 |       -name: comissao
    40 |       description: "comissão de vendas"
    41 |       tests:
    42 |           -nao_negativo
    
    Raw Error:
    ------------------------------
    while parsing a block collection
      in "<unicode string>", line 34, column 7
    did not find expected '-' indicator
      in "<unicode string>", line 39, column 7
[0m22:42:49.115272 [debug] [MainThread]: Command `dbt test` failed at 22:42:49.115272 after 0.94 seconds
[0m22:42:49.118828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C41FDE48F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C41FF625D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C420B71070>]}
[0m22:42:49.118828 [debug] [MainThread]: Flushing usage events
[0m22:43:33.335887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219C2816990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219C2816630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219C28157C0>]}


============================== 22:43:33.335887 | 17ce311a-cf12-4366-8564-7f0c12b548d8 ==============================
[0m22:43:33.335887 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:43:33.335887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:43:33.832420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17ce311a-cf12-4366-8564-7f0c12b548d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219C3312B70>]}
[0m22:43:33.959045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17ce311a-cf12-4366-8564-7f0c12b548d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219C2817470>]}
[0m22:43:33.959045 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m22:43:33.975374 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:43:34.157663 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:43:34.173280 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models\example\schema.yml
[0m22:43:34.252192 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\example\schema.yml @ models: {'name': 'vw_sales', 'description': 'View com informações de vendas', 'columns': [{'name': 'valor_pago', 'description': 'Valor pago na compra', 'tests': ['nao_negativo', 'not_null']}, {'name': 'comissao', 'description': 'comissão de vendas', 'tests': '-nao_negativo -not_null'}], 'original_file_path': 'models\\example\\schema.yml', 'yaml_key': 'models', 'package_name': 'analytics_dbt'} - at path ['columns'][1]['tests']: '-nao_negativo -not_null' is not of type 'array'
[0m22:43:34.252192 [debug] [MainThread]: Command `dbt test` failed at 22:43:34.252192 after 1.02 seconds
[0m22:43:34.252192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219C20ED880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219C37AA900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219C3372C60>]}
[0m22:43:34.252192 [debug] [MainThread]: Flushing usage events
[0m22:45:21.170763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E110617800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E110616CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E110615250>]}


============================== 22:45:21.195823 | ef54d5e2-2b44-4df2-a5f9-db550b43ded4 ==============================
[0m22:45:21.195823 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:45:21.195823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:45:21.895873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef54d5e2-2b44-4df2-a5f9-db550b43ded4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E11064A870>]}
[0m22:45:22.046131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef54d5e2-2b44-4df2-a5f9-db550b43ded4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1110D94F0>]}
[0m22:45:22.066602 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m22:45:22.089362 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:45:22.305966 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:45:22.323800 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models\example\schema.yml
[0m22:45:22.595970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef54d5e2-2b44-4df2-a5f9-db550b43ded4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1116A3950>]}
[0m22:45:22.615726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef54d5e2-2b44-4df2-a5f9-db550b43ded4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E11162E270>]}
[0m22:45:22.615726 [info ] [MainThread]: Found 5 models, 9 tests, 0 sources, 0 exposures, 0 metrics, 456 macros, 0 groups, 0 semantic models
[0m22:45:22.615726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef54d5e2-2b44-4df2-a5f9-db550b43ded4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E11109C650>]}
[0m22:45:22.620847 [info ] [MainThread]: 
[0m22:45:22.627038 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:45:22.628876 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m22:45:22.666001 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:45:22.667029 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m22:45:22.667029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:45:22.675884 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:45:22.680991 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:45:26.752656 [debug] [ThreadPool]: SQL status: SUCCESS in 4.0 seconds
[0m22:45:26.770681 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:45:26.770681 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m22:45:27.251565 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m22:45:27.275913 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m22:45:27.681073 [debug] [ThreadPool]: On list_dev_public: Close
[0m22:45:27.725853 [debug] [MainThread]: Using redshift connection "master"
[0m22:45:27.728896 [debug] [MainThread]: On master: BEGIN
[0m22:45:27.730366 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:45:27.730366 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:45:27.730366 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:45:29.309977 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m22:45:29.314821 [debug] [MainThread]: Using redshift connection "master"
[0m22:45:29.315892 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:45:29.649418 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:45:29.657464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef54d5e2-2b44-4df2-a5f9-db550b43ded4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E11103B560>]}
[0m22:45:29.660199 [debug] [MainThread]: On master: ROLLBACK
[0m22:45:29.960744 [debug] [MainThread]: Using redshift connection "master"
[0m22:45:29.960744 [debug] [MainThread]: On master: BEGIN
[0m22:45:30.106107 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:45:30.107624 [debug] [MainThread]: On master: COMMIT
[0m22:45:30.109686 [debug] [MainThread]: Using redshift connection "master"
[0m22:45:30.109686 [debug] [MainThread]: On master: COMMIT
[0m22:45:30.390288 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:45:30.391197 [debug] [MainThread]: On master: Close
[0m22:45:30.395692 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:45:30.399567 [info ] [MainThread]: 
[0m22:45:30.409155 [debug] [Thread-1 (]: Began running node test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9
[0m22:45:30.411847 [info ] [Thread-1 (]: 1 of 9 START test nao_negativo_tb_top_10_compradores_vendas_totais ............. [RUN]
[0m22:45:30.419996 [debug] [Thread-1 (]: Acquiring new redshift connection 'test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9'
[0m22:45:30.422481 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9
[0m22:45:30.436889 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9"
[0m22:45:30.446800 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9 (compile): 22:45:30.426530 => 22:45:30.445517
[0m22:45:30.446800 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9
[0m22:45:30.517345 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9"
[0m22:45:30.527405 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9"
[0m22:45:30.530176 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9: BEGIN
[0m22:45:30.530176 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:45:30.530176 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:45:30.530176 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:45:31.861033 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:45:31.866194 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9"
[0m22:45:31.866194 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select *
from "dev"."public"."tb_top_10_compradores"
where vendas_totais < 0


      
    ) dbt_internal_test
[0m22:45:32.159735 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:45:32.185787 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9 (execute): 22:45:30.451527 => 22:45:32.185787
[0m22:45:32.185787 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9: ROLLBACK
[0m22:45:32.478065 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9: Close
[0m22:45:32.498191 [info ] [Thread-1 (]: 1 of 9 PASS nao_negativo_tb_top_10_compradores_vendas_totais ................... [[32mPASS[0m in 2.08s]
[0m22:45:32.503931 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9
[0m22:45:32.503931 [debug] [Thread-1 (]: Began running node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
[0m22:45:32.506207 [info ] [Thread-1 (]: 2 of 9 START test nao_negativo_vw_sales_valor_pago ............................. [RUN]
[0m22:45:32.506207 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9, now test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10)
[0m22:45:32.506207 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
[0m22:45:32.516238 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
[0m22:45:32.518401 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10 (compile): 22:45:32.506207 => 22:45:32.518401
[0m22:45:32.521976 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
[0m22:45:32.526415 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
[0m22:45:32.531068 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
[0m22:45:32.533209 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: BEGIN
[0m22:45:32.534512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:45:32.538437 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:45:32.538437 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:45:34.433739 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:45:34.436299 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
[0m22:45:34.438740 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select *
from "dev"."public"."vw_sales"
where valor_pago < 0


      
    ) dbt_internal_test
[0m22:45:38.427332 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.0 seconds
[0m22:45:38.455712 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10 (execute): 22:45:32.521976 => 22:45:38.453613
[0m22:45:38.455712 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: ROLLBACK
[0m22:45:38.936419 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: Close
[0m22:45:38.941073 [info ] [Thread-1 (]: 2 of 9 PASS nao_negativo_vw_sales_valor_pago ................................... [[32mPASS[0m in 6.43s]
[0m22:45:38.945986 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
[0m22:45:38.945986 [debug] [Thread-1 (]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:45:38.945986 [info ] [Thread-1 (]: 3 of 9 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:45:38.952849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10, now test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710)
[0m22:45:38.955838 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:45:38.967463 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:45:38.971448 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 22:45:38.955838 => 22:45:38.971448
[0m22:45:38.976069 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:45:38.980903 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:45:38.988796 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:45:38.988796 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m22:45:38.988796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:45:38.988796 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:45:38.996021 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:45:41.327500 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:45:41.327500 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:45:41.333259 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m22:45:41.620691 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:45:41.638629 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 22:45:38.976238 => 22:45:41.638629
[0m22:45:41.638629 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m22:45:41.920976 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:45:41.940924 [error] [Thread-1 (]: 3 of 9 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.99s]
[0m22:45:41.940924 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:45:41.946018 [debug] [Thread-1 (]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:45:41.946018 [info ] [Thread-1 (]: 4 of 9 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m22:45:41.951096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710, now test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778)
[0m22:45:41.952513 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:45:41.956258 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:45:41.960905 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778 (compile): 22:45:41.952513 => 22:45:41.960905
[0m22:45:41.960905 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:45:41.965997 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:45:41.967257 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:45:41.967257 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m22:45:41.967257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:45:41.975949 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:45:41.975949 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:45:43.256270 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:45:43.276228 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:45:43.279813 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m22:45:43.856594 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:45:43.877022 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778 (execute): 22:45:41.960905 => 22:45:43.877022
[0m22:45:43.877022 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m22:45:44.750742 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m22:45:44.773842 [info ] [Thread-1 (]: 4 of 9 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 2.83s]
[0m22:45:44.780773 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:45:44.782850 [debug] [Thread-1 (]: Began running node test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687
[0m22:45:44.790066 [info ] [Thread-1 (]: 5 of 9 START test not_null_tb_top_10_compradores_vendas_totais ................. [RUN]
[0m22:45:44.795794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778, now test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687)
[0m22:45:44.800768 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687
[0m22:45:44.823377 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687"
[0m22:45:44.831022 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687 (compile): 22:45:44.806022 => 22:45:44.825997
[0m22:45:44.831022 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687
[0m22:45:44.838943 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687"
[0m22:45:44.856380 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687"
[0m22:45:44.857982 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687: BEGIN
[0m22:45:44.857982 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:45:44.867346 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:45:44.867346 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:45:47.748440 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m22:45:47.748440 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687"
[0m22:45:47.755591 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_top_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
[0m22:45:48.462231 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:45:48.485916 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687 (execute): 22:45:44.834556 => 22:45:48.484275
[0m22:45:48.485916 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687: ROLLBACK
[0m22:45:49.076998 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687: Close
[0m22:45:49.082034 [info ] [Thread-1 (]: 5 of 9 PASS not_null_tb_top_10_compradores_vendas_totais ....................... [[32mPASS[0m in 4.29s]
[0m22:45:49.086134 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687
[0m22:45:49.090647 [debug] [Thread-1 (]: Began running node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
[0m22:45:49.090647 [info ] [Thread-1 (]: 6 of 9 START test not_null_vw_sales_valor_pago ................................. [RUN]
[0m22:45:49.098147 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687, now test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26)
[0m22:45:49.101010 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
[0m22:45:49.119912 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
[0m22:45:49.128514 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26 (compile): 22:45:49.106113 => 22:45:49.125680
[0m22:45:49.131762 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
[0m22:45:49.142352 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
[0m22:45:49.155983 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
[0m22:45:49.160924 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: BEGIN
[0m22:45:49.168505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:45:49.175917 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:45:49.180815 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:45:52.455448 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m22:45:52.473136 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
[0m22:45:52.478922 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valor_pago
from "dev"."public"."vw_sales"
where valor_pago is null



      
    ) dbt_internal_test
[0m22:45:53.171820 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:45:53.203381 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26 (execute): 22:45:49.135657 => 22:45:53.201897
[0m22:45:53.206845 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: ROLLBACK
[0m22:45:54.199796 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: Close
[0m22:45:54.219487 [info ] [Thread-1 (]: 6 of 9 PASS not_null_vw_sales_valor_pago ....................................... [[32mPASS[0m in 5.12s]
[0m22:45:54.224103 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
[0m22:45:54.225124 [debug] [Thread-1 (]: Began running node test.analytics_dbt.test_singular_nao_negativo
[0m22:45:54.225124 [info ] [Thread-1 (]: 7 of 9 START test test_singular_nao_negativo ................................... [RUN]
[0m22:45:54.229468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26, now test.analytics_dbt.test_singular_nao_negativo)
[0m22:45:54.231171 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
[0m22:45:54.236719 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m22:45:54.236719 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.test_singular_nao_negativo (compile): 22:45:54.233352 => 22:45:54.236719
[0m22:45:54.236719 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.test_singular_nao_negativo
[0m22:45:54.250469 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.test_singular_nao_negativo"
[0m22:45:54.253829 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m22:45:54.253829 [debug] [Thread-1 (]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
[0m22:45:54.253829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:45:54.253829 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:45:54.253829 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:45:56.401382 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:45:56.425880 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m22:45:56.427985 [debug] [Thread-1 (]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      --testa se existe valores menores que zero (negativos)
select *
    from tb_top_10_compradores
    where vendas_totais < 0
      
    ) dbt_internal_test
[0m22:45:58.324860 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:45:58.341918 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.test_singular_nao_negativo (execute): 22:45:54.236719 => 22:45:58.341918
[0m22:45:58.341918 [debug] [Thread-1 (]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
[0m22:45:59.104156 [debug] [Thread-1 (]: On test.analytics_dbt.test_singular_nao_negativo: Close
[0m22:45:59.116751 [info ] [Thread-1 (]: 7 of 9 PASS test_singular_nao_negativo ......................................... [[32mPASS[0m in 4.89s]
[0m22:45:59.116751 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.test_singular_nao_negativo
[0m22:45:59.116751 [debug] [Thread-1 (]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:45:59.116751 [info ] [Thread-1 (]: 8 of 9 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:45:59.124767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.test_singular_nao_negativo, now test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321)
[0m22:45:59.129182 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:45:59.189074 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:45:59.197097 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321 (compile): 22:45:59.129182 => 22:45:59.197097
[0m22:45:59.199697 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:45:59.199697 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:45:59.205305 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:45:59.205305 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m22:45:59.205305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:45:59.205305 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:45:59.205305 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:46:02.476731 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m22:46:02.508142 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:46:02.508142 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:46:03.169086 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:46:03.200053 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321 (execute): 22:45:59.199697 => 22:46:03.200053
[0m22:46:03.204079 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m22:46:03.924278 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:46:03.942342 [info ] [Thread-1 (]: 8 of 9 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 4.82s]
[0m22:46:03.946510 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:46:03.946510 [debug] [Thread-1 (]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:46:03.946510 [info ] [Thread-1 (]: 9 of 9 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m22:46:03.950819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321, now test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493)
[0m22:46:03.950819 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:46:03.954330 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:46:03.954330 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493 (compile): 22:46:03.950819 => 22:46:03.954330
[0m22:46:03.954330 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:46:03.962340 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:46:03.969550 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:46:03.969550 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m22:46:03.969550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:46:03.978061 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:46:03.978061 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:46:06.781643 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m22:46:06.781643 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:46:06.781643 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:46:07.907216 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:46:07.938185 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493 (execute): 22:46:03.962340 => 22:46:07.936171
[0m22:46:07.938185 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m22:46:08.430530 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m22:46:08.448900 [info ] [Thread-1 (]: 9 of 9 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 4.50s]
[0m22:46:08.448900 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:46:08.448900 [debug] [MainThread]: Using redshift connection "master"
[0m22:46:08.448900 [debug] [MainThread]: On master: BEGIN
[0m22:46:08.448900 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:46:08.448900 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:46:08.448900 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:46:10.874558 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m22:46:10.905133 [debug] [MainThread]: On master: COMMIT
[0m22:46:10.906820 [debug] [MainThread]: Using redshift connection "master"
[0m22:46:10.907886 [debug] [MainThread]: On master: COMMIT
[0m22:46:11.437190 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m22:46:11.456934 [debug] [MainThread]: On master: Close
[0m22:46:11.456934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:46:11.456934 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m22:46:11.460944 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m22:46:11.460944 [info ] [MainThread]: 
[0m22:46:11.460944 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 48.83 seconds (48.83s).
[0m22:46:11.460944 [debug] [MainThread]: Command end result
[0m22:46:11.485474 [info ] [MainThread]: 
[0m22:46:11.485474 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:46:11.485474 [info ] [MainThread]: 
[0m22:46:11.485474 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:46:11.498992 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:46:11.503384 [info ] [MainThread]: 
[0m22:46:11.503384 [info ] [MainThread]:   compiled Code at target\compiled\analytics_dbt\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:46:11.503384 [info ] [MainThread]: 
[0m22:46:11.503384 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m22:46:11.516239 [debug] [MainThread]: Command `dbt test` failed at 22:46:11.514901 after 50.45 seconds
[0m22:46:11.516239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E10FDC3C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E110C0E0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1103A1C40>]}
[0m22:46:11.520569 [debug] [MainThread]: Flushing usage events
[0m22:46:46.217237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F37540BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3A0168A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3A017E60>]}


============================== 22:46:46.253216 | b0c4a1cf-7bf7-406b-b75c-09db52240104 ==============================
[0m22:46:46.253216 [info ] [MainThread]: Running with dbt=1.7.3
[0m22:46:46.253216 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:46:47.986754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0c4a1cf-7bf7-406b-b75c-09db52240104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3AA5A0F0>]}
[0m22:46:48.364335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0c4a1cf-7bf7-406b-b75c-09db52240104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F39853C80>]}
[0m22:46:48.394561 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m22:46:48.440074 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m22:46:48.958921 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:46:48.977747 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models\example\schema.yml
[0m22:46:50.207209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0c4a1cf-7bf7-406b-b75c-09db52240104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3B0C1FA0>]}
[0m22:46:50.256319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0c4a1cf-7bf7-406b-b75c-09db52240104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3B420200>]}
[0m22:46:50.260361 [info ] [MainThread]: Found 5 models, 11 tests, 0 sources, 0 exposures, 0 metrics, 456 macros, 0 groups, 0 semantic models
[0m22:46:50.265317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0c4a1cf-7bf7-406b-b75c-09db52240104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3AACFCE0>]}
[0m22:46:50.273314 [info ] [MainThread]: 
[0m22:46:50.278748 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m22:46:50.284762 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m22:46:50.365406 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:46:50.371043 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m22:46:50.371043 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:46:50.390903 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:46:50.393897 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:46:54.454925 [debug] [ThreadPool]: SQL status: SUCCESS in 4.0 seconds
[0m22:46:54.474314 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m22:46:54.478419 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m22:46:55.023589 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m22:46:55.035788 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m22:46:56.046997 [debug] [ThreadPool]: On list_dev_public: Close
[0m22:46:56.113462 [debug] [MainThread]: Using redshift connection "master"
[0m22:46:56.117018 [debug] [MainThread]: On master: BEGIN
[0m22:46:56.121018 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:46:56.125022 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:46:56.129018 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:46:59.630908 [debug] [MainThread]: SQL status: SUCCESS in 4.0 seconds
[0m22:46:59.633912 [debug] [MainThread]: Using redshift connection "master"
[0m22:46:59.637908 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m22:47:00.085726 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:47:00.110966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0c4a1cf-7bf7-406b-b75c-09db52240104', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3AC39220>]}
[0m22:47:00.113963 [debug] [MainThread]: On master: ROLLBACK
[0m22:47:00.861342 [debug] [MainThread]: Using redshift connection "master"
[0m22:47:00.880143 [debug] [MainThread]: On master: BEGIN
[0m22:47:01.042584 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:47:01.061616 [debug] [MainThread]: On master: COMMIT
[0m22:47:01.064981 [debug] [MainThread]: Using redshift connection "master"
[0m22:47:01.069059 [debug] [MainThread]: On master: COMMIT
[0m22:47:01.653390 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m22:47:01.672964 [debug] [MainThread]: On master: Close
[0m22:47:01.680048 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:47:01.684163 [info ] [MainThread]: 
[0m22:47:01.704649 [debug] [Thread-1 (]: Began running node test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9
[0m22:47:01.708651 [info ] [Thread-1 (]: 1 of 11 START test nao_negativo_tb_top_10_compradores_vendas_totais ............ [RUN]
[0m22:47:01.716046 [debug] [Thread-1 (]: Acquiring new redshift connection 'test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9'
[0m22:47:01.740813 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9
[0m22:47:01.761979 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9"
[0m22:47:01.770968 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9 (compile): 22:47:01.742949 => 22:47:01.769976
[0m22:47:01.774985 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9
[0m22:47:01.838936 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9"
[0m22:47:01.852941 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9"
[0m22:47:01.855951 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9: BEGIN
[0m22:47:01.859938 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:47:01.863939 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:01.868334 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:47:07.043103 [debug] [Thread-1 (]: SQL status: SUCCESS in 5.0 seconds
[0m22:47:07.064438 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9"
[0m22:47:07.068158 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select *
from "dev"."public"."tb_top_10_compradores"
where vendas_totais < 0


      
    ) dbt_internal_test
[0m22:47:07.367062 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:47:07.380057 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9 (execute): 22:47:01.775966 => 22:47:07.379066
[0m22:47:07.383219 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9: ROLLBACK
[0m22:47:07.678718 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9: Close
[0m22:47:07.697748 [info ] [Thread-1 (]: 1 of 11 PASS nao_negativo_tb_top_10_compradores_vendas_totais .................. [[32mPASS[0m in 5.98s]
[0m22:47:07.697748 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9
[0m22:47:07.711625 [debug] [Thread-1 (]: Began running node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
[0m22:47:07.716633 [info ] [Thread-1 (]: 2 of 11 START test nao_negativo_vw_sales_comissao .............................. [RUN]
[0m22:47:07.723623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.nao_negativo_tb_top_10_compradores_vendas_totais.a7f9f144d9, now test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db)
[0m22:47:07.727622 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
[0m22:47:07.759375 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
[0m22:47:07.768442 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db (compile): 22:47:07.731111 => 22:47:07.766446
[0m22:47:07.771865 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
[0m22:47:07.903705 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
[0m22:47:07.928974 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
[0m22:47:07.939591 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: BEGIN
[0m22:47:07.955558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:47:07.959891 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:07.963666 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:47:09.365065 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:47:09.393298 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"
[0m22:47:09.397300 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select *
from "dev"."public"."vw_sales"
where comissao < 0


      
    ) dbt_internal_test
[0m22:47:13.237583 [debug] [Thread-1 (]: SQL status: SUCCESS in 4.0 seconds
[0m22:47:13.266091 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db (execute): 22:47:07.771865 => 22:47:13.265086
[0m22:47:13.267086 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: ROLLBACK
[0m22:47:13.546689 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db: Close
[0m22:47:13.573676 [info ] [Thread-1 (]: 2 of 11 PASS nao_negativo_vw_sales_comissao .................................... [[32mPASS[0m in 5.85s]
[0m22:47:13.577779 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db
[0m22:47:13.581122 [debug] [Thread-1 (]: Began running node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
[0m22:47:13.625474 [info ] [Thread-1 (]: 3 of 11 START test nao_negativo_vw_sales_valor_pago ............................ [RUN]
[0m22:47:13.630807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.nao_negativo_vw_sales_comissao.c9561fd7db, now test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10)
[0m22:47:13.634807 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
[0m22:47:13.647197 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
[0m22:47:13.649294 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10 (compile): 22:47:13.636531 => 22:47:13.649294
[0m22:47:13.649294 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
[0m22:47:13.664740 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
[0m22:47:13.666575 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
[0m22:47:13.666575 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: BEGIN
[0m22:47:13.666575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:47:13.666575 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:13.676740 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:47:15.070852 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:47:15.096362 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"
[0m22:47:15.098362 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select *
from "dev"."public"."vw_sales"
where valor_pago < 0


      
    ) dbt_internal_test
[0m22:47:15.395161 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:47:15.401162 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10 (execute): 22:47:13.649294 => 22:47:15.400165
[0m22:47:15.403514 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: ROLLBACK
[0m22:47:15.698090 [debug] [Thread-1 (]: On test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10: Close
[0m22:47:15.702264 [info ] [Thread-1 (]: 3 of 11 PASS nao_negativo_vw_sales_valor_pago .................................. [[32mPASS[0m in 2.07s]
[0m22:47:15.705513 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10
[0m22:47:15.707514 [debug] [Thread-1 (]: Began running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:47:15.709740 [info ] [Thread-1 (]: 4 of 11 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m22:47:15.713932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.nao_negativo_vw_sales_valor_pago.7a9d055b10, now test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710)
[0m22:47:15.717942 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:47:15.737933 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:47:15.779678 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 22:47:15.721937 => 22:47:15.776686
[0m22:47:15.782835 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:47:15.791065 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:47:15.799065 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:47:15.801072 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
[0m22:47:15.803065 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:47:15.804064 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:15.806068 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:47:17.122972 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:47:17.140749 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:47:17.143763 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m22:47:17.438363 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:47:17.484897 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 22:47:15.783850 => 22:47:17.483929
[0m22:47:17.486892 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
[0m22:47:17.779851 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:47:17.785850 [error] [Thread-1 (]: 4 of 11 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 2.07s]
[0m22:47:17.789391 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:47:17.791387 [debug] [Thread-1 (]: Began running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:47:17.793594 [info ] [Thread-1 (]: 5 of 11 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m22:47:17.797611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.not_null_my_first_dbt_model_id.5fb22c2710, now test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778)
[0m22:47:17.799621 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:47:17.813045 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:47:17.817058 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778 (compile): 22:47:17.800611 => 22:47:17.817058
[0m22:47:17.819060 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:47:17.826061 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:47:17.835346 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:47:17.837364 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: BEGIN
[0m22:47:17.839363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:47:17.841416 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:17.844371 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:47:19.659042 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:47:19.661583 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m22:47:19.665585 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "dev"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
[0m22:47:19.966655 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:47:19.972236 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778 (execute): 22:47:17.820067 => 22:47:19.972236
[0m22:47:19.974186 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
[0m22:47:20.265827 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778: Close
[0m22:47:20.280033 [info ] [Thread-1 (]: 5 of 11 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 2.48s]
[0m22:47:20.284878 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m22:47:20.286926 [debug] [Thread-1 (]: Began running node test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687
[0m22:47:20.288909 [info ] [Thread-1 (]: 6 of 11 START test not_null_tb_top_10_compradores_vendas_totais ................ [RUN]
[0m22:47:20.290518 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.not_null_my_second_dbt_model_id.151b76d778, now test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687)
[0m22:47:20.294542 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687
[0m22:47:20.307165 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687"
[0m22:47:20.311867 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687 (compile): 22:47:20.298535 => 22:47:20.310702
[0m22:47:20.314878 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687
[0m22:47:20.325382 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687"
[0m22:47:20.335989 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687"
[0m22:47:20.338061 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687: BEGIN
[0m22:47:20.339993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:47:20.341681 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:20.343679 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:47:21.623979 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:47:21.626945 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687"
[0m22:47:21.627951 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select vendas_totais
from "dev"."public"."tb_top_10_compradores"
where vendas_totais is null



      
    ) dbt_internal_test
[0m22:47:21.910124 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:47:21.930849 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687 (execute): 22:47:20.318756 => 22:47:21.930299
[0m22:47:21.934079 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687: ROLLBACK
[0m22:47:22.214924 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687: Close
[0m22:47:22.218918 [info ] [Thread-1 (]: 6 of 11 PASS not_null_tb_top_10_compradores_vendas_totais ...................... [[32mPASS[0m in 1.93s]
[0m22:47:22.221442 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687
[0m22:47:22.222454 [debug] [Thread-1 (]: Began running node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
[0m22:47:22.224454 [info ] [Thread-1 (]: 7 of 11 START test not_null_vw_sales_comissao .................................. [RUN]
[0m22:47:22.227480 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.not_null_tb_top_10_compradores_vendas_totais.b6375ef687, now test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab)
[0m22:47:22.228476 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
[0m22:47:22.243816 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
[0m22:47:22.248757 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab (compile): 22:47:22.229985 => 22:47:22.247755
[0m22:47:22.251417 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
[0m22:47:22.256099 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
[0m22:47:22.260608 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
[0m22:47:22.263151 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: BEGIN
[0m22:47:22.266505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:47:22.268702 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:22.270257 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:47:23.587121 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:47:23.589099 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"
[0m22:47:23.592722 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select comissao
from "dev"."public"."vw_sales"
where comissao is null



      
    ) dbt_internal_test
[0m22:47:24.050126 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:47:24.056057 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab (execute): 22:47:22.252089 => 22:47:24.055059
[0m22:47:24.058075 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: ROLLBACK
[0m22:47:24.534221 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab: Close
[0m22:47:24.554771 [info ] [Thread-1 (]: 7 of 11 PASS not_null_vw_sales_comissao ........................................ [[32mPASS[0m in 2.33s]
[0m22:47:24.557822 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab
[0m22:47:24.560348 [debug] [Thread-1 (]: Began running node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
[0m22:47:24.562304 [info ] [Thread-1 (]: 8 of 11 START test not_null_vw_sales_valor_pago ................................ [RUN]
[0m22:47:24.566619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.not_null_vw_sales_comissao.d9b6c254ab, now test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26)
[0m22:47:24.568906 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
[0m22:47:24.578227 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
[0m22:47:24.581678 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26 (compile): 22:47:24.570415 => 22:47:24.581678
[0m22:47:24.581678 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
[0m22:47:24.590189 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
[0m22:47:24.599824 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
[0m22:47:24.600883 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: BEGIN
[0m22:47:24.600883 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:47:24.605489 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:24.605489 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:47:26.412124 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:47:26.415181 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"
[0m22:47:26.417158 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select valor_pago
from "dev"."public"."vw_sales"
where valor_pago is null



      
    ) dbt_internal_test
[0m22:47:26.714108 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:47:26.733552 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26 (execute): 22:47:24.581678 => 22:47:26.732540
[0m22:47:26.734555 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: ROLLBACK
[0m22:47:27.029451 [debug] [Thread-1 (]: On test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26: Close
[0m22:47:27.050548 [info ] [Thread-1 (]: 8 of 11 PASS not_null_vw_sales_valor_pago ...................................... [[32mPASS[0m in 2.48s]
[0m22:47:27.052469 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26
[0m22:47:27.052469 [debug] [Thread-1 (]: Began running node test.analytics_dbt.test_singular_nao_negativo
[0m22:47:27.052469 [info ] [Thread-1 (]: 9 of 11 START test test_singular_nao_negativo .................................. [RUN]
[0m22:47:27.052469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.not_null_vw_sales_valor_pago.5cd141ad26, now test.analytics_dbt.test_singular_nao_negativo)
[0m22:47:27.052469 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.test_singular_nao_negativo
[0m22:47:27.062267 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.test_singular_nao_negativo"
[0m22:47:27.064383 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.test_singular_nao_negativo (compile): 22:47:27.052469 => 22:47:27.064383
[0m22:47:27.064383 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.test_singular_nao_negativo
[0m22:47:27.075162 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.test_singular_nao_negativo"
[0m22:47:27.081461 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m22:47:27.083504 [debug] [Thread-1 (]: On test.analytics_dbt.test_singular_nao_negativo: BEGIN
[0m22:47:27.085502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:47:27.086556 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:27.087502 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:47:28.340602 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:47:28.361203 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.test_singular_nao_negativo"
[0m22:47:28.361203 [debug] [Thread-1 (]: On test.analytics_dbt.test_singular_nao_negativo: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.test_singular_nao_negativo"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      --testa se existe valores menores que zero (negativos)
select *
    from tb_top_10_compradores
    where vendas_totais < 0
      
    ) dbt_internal_test
[0m22:47:28.646818 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m22:47:28.666006 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.test_singular_nao_negativo (execute): 22:47:27.069953 => 22:47:28.666006
[0m22:47:28.667003 [debug] [Thread-1 (]: On test.analytics_dbt.test_singular_nao_negativo: ROLLBACK
[0m22:47:28.948924 [debug] [Thread-1 (]: On test.analytics_dbt.test_singular_nao_negativo: Close
[0m22:47:28.969011 [info ] [Thread-1 (]: 9 of 11 PASS test_singular_nao_negativo ........................................ [[32mPASS[0m in 1.92s]
[0m22:47:28.971546 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.test_singular_nao_negativo
[0m22:47:28.972556 [debug] [Thread-1 (]: Began running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:47:28.974608 [info ] [Thread-1 (]: 10 of 11 START test unique_my_first_dbt_model_id ............................... [RUN]
[0m22:47:28.978560 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.test_singular_nao_negativo, now test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321)
[0m22:47:28.981132 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:47:28.994109 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:47:28.999162 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321 (compile): 22:47:28.983139 => 22:47:28.998122
[0m22:47:29.000628 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:47:29.005636 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:47:29.010248 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:47:29.013530 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: BEGIN
[0m22:47:29.016541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:47:29.017537 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:29.019146 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:47:30.803304 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:47:30.822558 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m22:47:30.825589 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:47:31.543748 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:47:31.563972 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321 (execute): 22:47:29.001661 => 22:47:31.562968
[0m22:47:31.565013 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
[0m22:47:32.059959 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:47:32.080724 [info ] [Thread-1 (]: 10 of 11 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 3.10s]
[0m22:47:32.083770 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321
[0m22:47:32.084745 [debug] [Thread-1 (]: Began running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:47:32.085767 [info ] [Thread-1 (]: 11 of 11 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m22:47:32.088746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.analytics_dbt.unique_my_first_dbt_model_id.16e066b321, now test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493)
[0m22:47:32.090509 [debug] [Thread-1 (]: Began compiling node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:47:32.102116 [debug] [Thread-1 (]: Writing injected SQL for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:47:32.106058 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493 (compile): 22:47:32.091370 => 22:47:32.105052
[0m22:47:32.107054 [debug] [Thread-1 (]: Began executing node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:47:32.114104 [debug] [Thread-1 (]: Writing runtime sql for node "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:47:32.119112 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:47:32.120113 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
[0m22:47:32.121446 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:47:32.122445 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:32.123447 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:47:34.040233 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m22:47:34.046577 [debug] [Thread-1 (]: Using redshift connection "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:47:34.048979 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "dev"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:47:34.734222 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m22:47:34.738219 [debug] [Thread-1 (]: Timing info for test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493 (execute): 22:47:32.108053 => 22:47:34.738219
[0m22:47:34.740220 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
[0m22:47:35.376161 [debug] [Thread-1 (]: On test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m22:47:35.382065 [info ] [Thread-1 (]: 11 of 11 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 3.29s]
[0m22:47:35.386552 [debug] [Thread-1 (]: Finished running node test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m22:47:35.395099 [debug] [MainThread]: Using redshift connection "master"
[0m22:47:35.397096 [debug] [MainThread]: On master: BEGIN
[0m22:47:35.400623 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:47:35.403718 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m22:47:35.406682 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m22:47:36.921371 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m22:47:36.923783 [debug] [MainThread]: On master: COMMIT
[0m22:47:36.946067 [debug] [MainThread]: Using redshift connection "master"
[0m22:47:36.948967 [debug] [MainThread]: On master: COMMIT
[0m22:47:37.233287 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m22:47:37.233287 [debug] [MainThread]: On master: Close
[0m22:47:37.236300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:47:37.239867 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m22:47:37.239867 [debug] [MainThread]: Connection 'test.analytics_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m22:47:37.239867 [info ] [MainThread]: 
[0m22:47:37.245015 [info ] [MainThread]: Finished running 11 tests in 0 hours 0 minutes and 46.96 seconds (46.96s).
[0m22:47:37.255103 [debug] [MainThread]: Command end result
[0m22:47:37.300357 [info ] [MainThread]: 
[0m22:47:37.302976 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:47:37.305663 [info ] [MainThread]: 
[0m22:47:37.305663 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:47:37.310195 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:47:37.314593 [info ] [MainThread]: 
[0m22:47:37.317985 [info ] [MainThread]:   compiled Code at target\compiled\analytics_dbt\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:47:37.320722 [info ] [MainThread]: 
[0m22:47:37.320722 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=1 SKIP=0 TOTAL=11
[0m22:47:37.329847 [debug] [MainThread]: Command `dbt test` failed at 22:47:37.329331 after 51.27 seconds
[0m22:47:37.332109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F39E9E060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3994D970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3B636DE0>]}
[0m22:47:37.335066 [debug] [MainThread]: Flushing usage events
