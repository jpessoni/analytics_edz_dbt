[0m10:50:08.358851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028878417470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028878417740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000288784144A0>]}


============================== 10:50:08.358851 | fa686cfd-34e3-4630-96f1-adf9c5dec30d ==============================
[0m10:50:08.358851 [info ] [MainThread]: Running with dbt=1.7.3
[0m10:50:08.358851 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:50:08.358851 [info ] [MainThread]: dbt version: 1.7.3
[0m10:50:08.358851 [info ] [MainThread]: python version: 3.12.0
[0m10:50:08.375054 [info ] [MainThread]: python path: C:\Josi\Cursos e Treinamentos\Stack\DBT\dbt_env\dbt_env\Scripts\python.exe
[0m10:50:08.377098 [info ] [MainThread]: os info: Windows-11-10.0.22621-SP0
[0m10:50:08.666698 [info ] [MainThread]: Using profiles dir at C:\Users\jpess\.dbt
[0m10:50:08.668976 [info ] [MainThread]: Using profiles.yml file at C:\Users\jpess\.dbt\profiles.yml
[0m10:50:08.671015 [info ] [MainThread]: Using dbt_project.yml file at C:\Josi\Cursos e Treinamentos\Stack\DBT\dbt_env\analytics_dbt\dbt_project.yml
[0m10:50:08.672265 [info ] [MainThread]: adapter type: redshift
[0m10:50:08.672265 [info ] [MainThread]: adapter version: 1.7.0
[0m10:50:08.768604 [info ] [MainThread]: Configuration:
[0m10:50:08.770438 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:50:08.772438 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:50:08.773696 [info ] [MainThread]: Required dependencies:
[0m10:50:08.775715 [debug] [MainThread]: Executing "git --help"
[0m10:50:08.839550 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c name=value]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   reset      Reset current HEAD to the specified state\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   branch     List, create, or delete branches\n   checkout   Switch branches or restore working tree files\n   commit     Record changes to the repository\n   diff       Show changes between commits, commit and working tree, etc\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\n""
[0m10:50:08.840864 [debug] [MainThread]: STDERR: "b''"
[0m10:50:08.840864 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:50:08.840864 [info ] [MainThread]: Connection:
[0m10:50:08.840864 [info ] [MainThread]:   host: redshift-cluster-1.cfqk4kc9vmtx.us-east-1.redshift.amazonaws.com
[0m10:50:08.840864 [info ] [MainThread]:   user: awsuser
[0m10:50:08.840864 [info ] [MainThread]:   port: 5439
[0m10:50:08.840864 [info ] [MainThread]:   database: dev
[0m10:50:08.840864 [info ] [MainThread]:   method: database
[0m10:50:08.840864 [info ] [MainThread]:   cluster_id: None
[0m10:50:08.856213 [info ] [MainThread]:   iam_profile: None
[0m10:50:08.857206 [info ] [MainThread]:   schema: public
[0m10:50:08.859204 [info ] [MainThread]:   sslmode: prefer
[0m10:50:08.860615 [info ] [MainThread]:   region: None
[0m10:50:08.860615 [info ] [MainThread]:   sslmode: prefer
[0m10:50:08.860615 [info ] [MainThread]:   region: None
[0m10:50:08.860615 [info ] [MainThread]:   iam_profile: None
[0m10:50:08.860615 [info ] [MainThread]:   autocreate: False
[0m10:50:08.860615 [info ] [MainThread]:   db_groups: []
[0m10:50:08.860615 [info ] [MainThread]:   ra3_node: False
[0m10:50:08.872901 [info ] [MainThread]:   connect_timeout: None
[0m10:50:08.874903 [info ] [MainThread]:   role: None
[0m10:50:08.875906 [info ] [MainThread]:   retries: 1
[0m10:50:08.878045 [info ] [MainThread]:   autocommit: True
[0m10:50:08.878045 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m10:50:08.878045 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m10:50:08.878045 [debug] [MainThread]: Using redshift connection "debug"
[0m10:50:08.889713 [debug] [MainThread]: On debug: select 1 as id
[0m10:50:08.890712 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:50:08.893966 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m10:50:08.893966 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m10:50:14.089489 [debug] [MainThread]: SQL status: SUCCESS in 5.0 seconds
[0m10:50:14.089489 [debug] [MainThread]: On debug: Close
[0m10:50:14.089489 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:50:14.089489 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:50:14.108859 [debug] [MainThread]: Command `dbt debug` succeeded at 10:50:14.108859 after 5.82 seconds
[0m10:50:14.110855 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:50:14.111856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028878E94B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028877D4C8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028878AF0560>]}
[0m10:50:14.113856 [debug] [MainThread]: Flushing usage events
[0m19:37:28.796868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028637037680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286370376B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028637035550>]}


============================== 19:37:28.813053 | a853b104-d0a8-4cd9-8f94-5735cb85d7c5 ==============================
[0m19:37:28.813053 [info ] [MainThread]: Running with dbt=1.7.3
[0m19:37:28.813053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:37:28.813053 [info ] [MainThread]: dbt version: 1.7.3
[0m19:37:28.813053 [info ] [MainThread]: python version: 3.12.0
[0m19:37:28.813053 [info ] [MainThread]: python path: C:\Josi\Cursos e Treinamentos\Stack\DBT\dbt_env\dbt_env\Scripts\python.exe
[0m19:37:28.823464 [info ] [MainThread]: os info: Windows-11-10.0.22621-SP0
[0m19:37:29.157329 [info ] [MainThread]: Using profiles dir at C:\Users\jpess\.dbt
[0m19:37:29.157329 [info ] [MainThread]: Using profiles.yml file at C:\Users\jpess\.dbt\profiles.yml
[0m19:37:29.157329 [info ] [MainThread]: Using dbt_project.yml file at C:\Josi\Cursos e Treinamentos\Stack\DBT\dbt_env\analytics_edz_dbt\dbt_project.yml
[0m19:37:29.157329 [info ] [MainThread]: adapter type: redshift
[0m19:37:29.157329 [info ] [MainThread]: adapter version: 1.7.0
[0m19:37:29.282489 [info ] [MainThread]: Configuration:
[0m19:37:29.282489 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:37:29.282489 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:37:29.282489 [info ] [MainThread]: Required dependencies:
[0m19:37:29.282489 [debug] [MainThread]: Executing "git --help"
[0m19:37:29.350453 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c name=value]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   reset      Reset current HEAD to the specified state\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   branch     List, create, or delete branches\n   checkout   Switch branches or restore working tree files\n   commit     Record changes to the repository\n   diff       Show changes between commits, commit and working tree, etc\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\n""
[0m19:37:29.364718 [debug] [MainThread]: STDERR: "b''"
[0m19:37:29.365730 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:37:29.367737 [info ] [MainThread]: Connection:
[0m19:37:29.368728 [info ] [MainThread]:   host: redshift-cluster-1.cfqk4kc9vmtx.us-east-1.redshift.amazonaws.com
[0m19:37:29.370050 [info ] [MainThread]:   user: awsuser
[0m19:37:29.372071 [info ] [MainThread]:   port: 5439
[0m19:37:29.373065 [info ] [MainThread]:   database: dev
[0m19:37:29.375071 [info ] [MainThread]:   method: database
[0m19:37:29.377074 [info ] [MainThread]:   cluster_id: None
[0m19:37:29.377769 [info ] [MainThread]:   iam_profile: None
[0m19:37:29.381385 [info ] [MainThread]:   schema: public
[0m19:37:29.383400 [info ] [MainThread]:   sslmode: prefer
[0m19:37:29.385398 [info ] [MainThread]:   region: None
[0m19:37:29.386398 [info ] [MainThread]:   sslmode: prefer
[0m19:37:29.387793 [info ] [MainThread]:   region: None
[0m19:37:29.387793 [info ] [MainThread]:   iam_profile: None
[0m19:37:29.387793 [info ] [MainThread]:   autocreate: False
[0m19:37:29.387793 [info ] [MainThread]:   db_groups: []
[0m19:37:29.387793 [info ] [MainThread]:   ra3_node: False
[0m19:37:29.387793 [info ] [MainThread]:   connect_timeout: None
[0m19:37:29.387793 [info ] [MainThread]:   role: None
[0m19:37:29.399099 [info ] [MainThread]:   retries: 1
[0m19:37:29.401099 [info ] [MainThread]:   autocommit: True
[0m19:37:29.403096 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m19:37:29.405092 [debug] [MainThread]: Acquiring new redshift connection 'debug'
[0m19:37:29.411140 [debug] [MainThread]: Using redshift connection "debug"
[0m19:37:29.411140 [debug] [MainThread]: On debug: select 1 as id
[0m19:37:29.411140 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:37:29.419498 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:37:29.420477 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:37:31.655067 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m19:37:31.657069 [debug] [MainThread]: On debug: Close
[0m19:37:31.660066 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:37:31.662066 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:37:31.664615 [debug] [MainThread]: Command `dbt debug` succeeded at 19:37:31.664615 after 2.93 seconds
[0m19:37:31.664615 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:37:31.664615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286368ED730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286368EF080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028636D38680>]}
[0m19:37:31.664615 [debug] [MainThread]: Flushing usage events
[0m19:48:12.742637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A99D16000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A99D17740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A99D148C0>]}


============================== 19:48:12.751189 | 5f82e58e-5704-44bd-81a0-bf351451eb4b ==============================
[0m19:48:12.751189 [info ] [MainThread]: Running with dbt=1.7.3
[0m19:48:12.753160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m19:48:13.416273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f82e58e-5704-44bd-81a0-bf351451eb4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A9A759670>]}
[0m19:48:13.538314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f82e58e-5704-44bd-81a0-bf351451eb4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A9A2E2600>]}
[0m19:48:13.539828 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m19:48:13.549229 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m19:48:13.560122 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m19:48:13.562091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5f82e58e-5704-44bd-81a0-bf351451eb4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A9A8704D0>]}
[0m19:48:15.349036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f82e58e-5704-44bd-81a0-bf351451eb4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A9AD5B320>]}
[0m19:48:15.369027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f82e58e-5704-44bd-81a0-bf351451eb4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A9A98FE60>]}
[0m19:48:15.370066 [info ] [MainThread]: Found 2 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m19:48:15.372047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f82e58e-5704-44bd-81a0-bf351451eb4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A9A8727E0>]}
[0m19:48:15.375115 [info ] [MainThread]: 
[0m19:48:15.375115 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m19:48:15.379133 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m19:48:15.419020 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m19:48:15.419020 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m19:48:15.419020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:15.427082 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:48:15.429082 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:48:18.192002 [debug] [ThreadPool]: SQL status: SUCCESS in 3.0 seconds
[0m19:48:18.196948 [debug] [ThreadPool]: On list_dev: Close
[0m19:48:18.201657 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m19:48:18.219018 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m19:48:18.219018 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m19:48:18.219018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:48:18.226506 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:48:18.229225 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:48:20.039726 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m19:48:20.042443 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m19:48:20.043459 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m19:48:20.351475 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:20.355333 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m19:48:20.651236 [debug] [ThreadPool]: On list_dev_public: Close
[0m19:48:20.669311 [debug] [MainThread]: Using redshift connection "master"
[0m19:48:20.670837 [debug] [MainThread]: On master: BEGIN
[0m19:48:20.672837 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:48:20.673838 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:48:20.676071 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:48:22.493507 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m19:48:22.495928 [debug] [MainThread]: Using redshift connection "master"
[0m19:48:22.497254 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m19:48:22.837806 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:22.841254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f82e58e-5704-44bd-81a0-bf351451eb4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A9AD50AD0>]}
[0m19:48:22.841254 [debug] [MainThread]: On master: ROLLBACK
[0m19:48:23.149086 [debug] [MainThread]: Using redshift connection "master"
[0m19:48:23.149086 [debug] [MainThread]: On master: BEGIN
[0m19:48:23.303191 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:23.304221 [debug] [MainThread]: On master: COMMIT
[0m19:48:23.306174 [debug] [MainThread]: Using redshift connection "master"
[0m19:48:23.307175 [debug] [MainThread]: On master: COMMIT
[0m19:48:23.597050 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:23.598098 [debug] [MainThread]: On master: Close
[0m19:48:23.600261 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:48:23.602811 [info ] [MainThread]: 
[0m19:48:23.627872 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m19:48:23.629459 [info ] [Thread-1 (]: 1 of 2 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m19:48:23.631474 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.analytics_dbt.my_first_dbt_model'
[0m19:48:23.633472 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m19:48:23.637547 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m19:48:23.644692 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 19:48:23.633472 => 19:48:23.643694
[0m19:48:23.645744 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m19:48:23.718290 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m19:48:23.725324 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:48:23.727354 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:48:23.728945 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:48:23.730681 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:48:23.732678 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:48:25.421344 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m19:48:25.423362 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:48:25.425325 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m19:48:26.151102 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:48:26.162408 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:48:26.163243 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m19:48:26.865301 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:48:26.909224 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:48:26.911739 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:48:26.915638 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:48:27.673172 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:48:27.674854 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:48:27.676514 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:48:27.956203 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:27.967151 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m19:48:27.975707 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:48:27.978368 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m19:48:28.257604 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:28.260376 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:48:28.261401 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:48:28.262402 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m19:48:28.409207 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:28.411073 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m19:48:28.413119 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m19:48:28.554583 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:28.558333 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 19:48:23.647523 => 19:48:28.558333
[0m19:48:28.560816 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m19:48:28.841437 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m19:48:28.844624 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f82e58e-5704-44bd-81a0-bf351451eb4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A9AC54440>]}
[0m19:48:28.846628 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 5.21s]
[0m19:48:28.850143 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m19:48:28.853144 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m19:48:28.856147 [info ] [Thread-1 (]: 2 of 2 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m19:48:28.859658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.my_second_dbt_model)
[0m19:48:28.861334 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m19:48:28.865714 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m19:48:28.867731 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 19:48:28.862704 => 19:48:28.867731
[0m19:48:28.869319 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m19:48:28.904520 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m19:48:28.909179 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:48:28.911070 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:48:28.912152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:48:28.914082 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:48:28.915389 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:48:30.141429 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:48:30.142677 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:48:30.144493 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m19:48:30.705297 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:48:30.714380 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:48:30.715395 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m19:48:31.134673 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:31.139262 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:48:31.141221 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:48:31.143271 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:48:31.881088 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m19:48:31.883630 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:48:31.884659 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:48:32.165919 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:32.172517 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m19:48:32.180124 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:48:32.182258 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m19:48:32.461338 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:32.463233 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:48:32.464253 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:48:32.465846 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m19:48:32.610924 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:32.613511 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m19:48:32.614600 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m19:48:32.749344 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:32.758100 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 19:48:28.869319 => 19:48:32.758100
[0m19:48:32.759411 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m19:48:33.039289 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m19:48:33.042197 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f82e58e-5704-44bd-81a0-bf351451eb4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A9B567080>]}
[0m19:48:33.044195 [info ] [Thread-1 (]: 2 of 2 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 4.18s]
[0m19:48:33.047193 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m19:48:33.050626 [debug] [MainThread]: Using redshift connection "master"
[0m19:48:33.051628 [debug] [MainThread]: On master: BEGIN
[0m19:48:33.052609 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:48:33.053606 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m19:48:33.056604 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m19:48:34.739038 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m19:48:34.741564 [debug] [MainThread]: On master: COMMIT
[0m19:48:34.742565 [debug] [MainThread]: Using redshift connection "master"
[0m19:48:34.744583 [debug] [MainThread]: On master: COMMIT
[0m19:48:35.025930 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m19:48:35.027929 [debug] [MainThread]: On master: Close
[0m19:48:35.030049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:48:35.031023 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m19:48:35.032071 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m19:48:35.033043 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m19:48:35.034047 [info ] [MainThread]: 
[0m19:48:35.036024 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 19.66 seconds (19.66s).
[0m19:48:35.038046 [debug] [MainThread]: Command end result
[0m19:48:35.055685 [info ] [MainThread]: 
[0m19:48:35.058047 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:48:35.060568 [info ] [MainThread]: 
[0m19:48:35.062613 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:48:35.065976 [debug] [MainThread]: Command `dbt run` succeeded at 19:48:35.065976 after 22.41 seconds
[0m19:48:35.067273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A99A87DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A99CFB890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016A9A2E2600>]}
[0m19:48:35.068282 [debug] [MainThread]: Flushing usage events
[0m20:08:19.777670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E23FB470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E23FB680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E23FB380>]}


============================== 20:08:19.785362 | 405dc903-6053-4092-8050-6bd78af8f7d7 ==============================
[0m20:08:19.785362 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:08:19.787795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models views/vw_sales.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:08:20.298776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '405dc903-6053-4092-8050-6bd78af8f7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E2415F70>]}
[0m20:08:20.408089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '405dc903-6053-4092-8050-6bd78af8f7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E2FAE900>]}
[0m20:08:20.408089 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m20:08:20.430970 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:08:20.442523 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:08:20.442523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '405dc903-6053-4092-8050-6bd78af8f7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E2F3AB40>]}
[0m20:08:22.056466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '405dc903-6053-4092-8050-6bd78af8f7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E34BA360>]}
[0m20:08:22.072780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '405dc903-6053-4092-8050-6bd78af8f7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E31BEAB0>]}
[0m20:08:22.072780 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:08:22.072780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '405dc903-6053-4092-8050-6bd78af8f7d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E34561E0>]}
[0m20:08:22.077362 [warn ] [MainThread]: The selection criterion 'views/vw_sales.sql' does not match any nodes
[0m20:08:22.077362 [info ] [MainThread]: 
[0m20:08:22.077362 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:08:22.084821 [debug] [MainThread]: Command end result
[0m20:08:22.100523 [debug] [MainThread]: Command `dbt run` succeeded at 20:08:22.100523 after 2.41 seconds
[0m20:08:22.100523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E1B2D880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E319D130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D5E23FB380>]}
[0m20:08:22.107537 [debug] [MainThread]: Flushing usage events
[0m20:09:25.512434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9DB37A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9DB37C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9DB36090>]}


============================== 20:09:25.519711 | be4ef566-625a-4736-bcd4-3d4a6f55aaac ==============================
[0m20:09:25.519711 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:09:25.522078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:09:26.014837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be4ef566-625a-4736-bcd4-3d4a6f55aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9E712000>]}
[0m20:09:26.123610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be4ef566-625a-4736-bcd4-3d4a6f55aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9BEBA7E0>]}
[0m20:09:26.126337 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m20:09:26.139545 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:09:26.297394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:09:26.297394 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:09:26.309856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be4ef566-625a-4736-bcd4-3d4a6f55aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9E6DB950>]}
[0m20:09:26.324460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be4ef566-625a-4736-bcd4-3d4a6f55aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9E85EFF0>]}
[0m20:09:26.325061 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:09:26.327075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be4ef566-625a-4736-bcd4-3d4a6f55aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9DBF8620>]}
[0m20:09:26.329074 [info ] [MainThread]: 
[0m20:09:26.331159 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:09:26.334758 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m20:09:26.360307 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:09:26.361307 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m20:09:26.362310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:26.369753 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:09:26.371753 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:09:28.257600 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:09:28.260121 [debug] [ThreadPool]: On list_dev: Close
[0m20:09:28.264369 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m20:09:28.285631 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:09:28.287650 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:09:28.288646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:09:28.289641 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:09:28.290644 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:09:30.056667 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:09:30.057686 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:09:30.058678 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m20:09:30.369276 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:30.372300 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:09:30.671914 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:09:30.692385 [debug] [MainThread]: Using redshift connection "master"
[0m20:09:30.694394 [debug] [MainThread]: On master: BEGIN
[0m20:09:30.696201 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:09:30.697894 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:09:30.699414 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:09:32.496780 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m20:09:32.499365 [debug] [MainThread]: Using redshift connection "master"
[0m20:09:32.499365 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:09:32.834460 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:32.846272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be4ef566-625a-4736-bcd4-3d4a6f55aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9E9B10A0>]}
[0m20:09:32.848797 [debug] [MainThread]: On master: ROLLBACK
[0m20:09:33.161192 [debug] [MainThread]: Using redshift connection "master"
[0m20:09:33.161192 [debug] [MainThread]: On master: BEGIN
[0m20:09:33.305111 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:33.305111 [debug] [MainThread]: On master: COMMIT
[0m20:09:33.313364 [debug] [MainThread]: Using redshift connection "master"
[0m20:09:33.314259 [debug] [MainThread]: On master: COMMIT
[0m20:09:33.604845 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:33.604845 [debug] [MainThread]: On master: Close
[0m20:09:33.604845 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:09:33.604845 [info ] [MainThread]: 
[0m20:09:33.620145 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:09:33.621146 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:09:33.623151 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.analytics_dbt.my_first_dbt_model'
[0m20:09:33.624766 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:09:33.632249 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:09:33.636842 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 20:09:33.625690 => 20:09:33.635791
[0m20:09:33.638561 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:09:33.712583 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m20:09:33.717276 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:33.718311 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:09:33.719279 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:09:33.720279 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:09:33.721286 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:09:35.422271 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:09:35.424267 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:35.425879 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:09:35.748982 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:35.752954 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:09:35.754574 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:35.755475 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:09:36.496547 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:09:36.496547 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:36.496547 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:09:36.644749 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:36.658210 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m20:09:36.664588 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:36.664588 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m20:09:36.952801 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:36.955309 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:09:36.957332 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:36.957332 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:09:37.496968 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:09:37.496968 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:37.504625 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:09:37.647257 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:37.658933 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:37.659884 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:09:38.634796 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:09:38.674653 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:09:38.675544 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:38.676553 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:09:39.247863 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:09:39.250860 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:39.251908 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:09:39.532909 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:39.538553 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m20:09:39.540541 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:39.541553 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:09:39.822356 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:39.824974 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:09:39.827059 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:39.827059 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:09:39.974964 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:39.974964 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:09:39.979625 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:09:40.122192 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:40.125772 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 20:09:33.638561 => 20:09:40.124755
[0m20:09:40.127780 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:09:40.405179 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:09:40.413490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be4ef566-625a-4736-bcd4-3d4a6f55aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9ED596A0>]}
[0m20:09:40.415588 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 6.79s]
[0m20:09:40.417639 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:09:40.418641 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m20:09:40.419660 [info ] [Thread-1 (]: 2 of 3 START sql views model public.vw_sales ................................... [RUN]
[0m20:09:40.421681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m20:09:40.422687 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m20:09:40.426191 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:09:40.429530 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 20:09:40.423673 => 20:09:40.428710
[0m20:09:40.429530 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m20:09:40.429530 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 20:09:40.429530 => 20:09:40.429530
[0m20:09:40.434889 [debug] [Thread-1 (]: Compilation Error in model vw_sales (models\views\vw_sales.sql)
  No materialization 'views' was found for adapter redshift! (searched types 'default' and 'redshift')
[0m20:09:40.434889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be4ef566-625a-4736-bcd4-3d4a6f55aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9ECD5D00>]}
[0m20:09:40.434889 [error] [Thread-1 (]: 2 of 3 ERROR creating sql views model public.vw_sales .......................... [[31mERROR[0m in 0.01s]
[0m20:09:40.434889 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m20:09:40.434889 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:09:40.434889 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:09:40.444473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m20:09:40.445892 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:09:40.452005 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:09:40.455547 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 20:09:40.446947 => 20:09:40.454535
[0m20:09:40.456547 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:09:40.487924 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m20:09:40.490905 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:09:40.491932 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:09:40.491932 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:09:40.492862 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:09:40.492862 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:09:42.234955 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:09:42.234955 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:09:42.234955 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m20:09:42.825685 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:09:42.830617 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:09:42.830617 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:09:43.264219 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:43.271945 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:09:43.274453 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:09:43.274453 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:09:43.931626 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:09:43.934439 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:09:43.936307 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:09:44.227697 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:44.234358 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m20:09:44.234358 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:09:44.234358 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:09:44.529377 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:44.534538 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:09:44.534538 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:09:44.534538 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:09:44.688668 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:44.690704 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:09:44.691718 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:09:44.838087 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:44.840040 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 20:09:40.456547 => 20:09:44.838998
[0m20:09:44.840040 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:09:45.130061 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:09:45.130061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be4ef566-625a-4736-bcd4-3d4a6f55aaac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9F02EFF0>]}
[0m20:09:45.134688 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 4.70s]
[0m20:09:45.134688 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:09:45.134688 [debug] [MainThread]: Using redshift connection "master"
[0m20:09:45.134688 [debug] [MainThread]: On master: BEGIN
[0m20:09:45.134688 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:09:45.134688 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:09:45.134688 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:09:46.414318 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:09:46.416455 [debug] [MainThread]: On master: COMMIT
[0m20:09:46.417513 [debug] [MainThread]: Using redshift connection "master"
[0m20:09:46.418532 [debug] [MainThread]: On master: COMMIT
[0m20:09:46.709771 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:09:46.713141 [debug] [MainThread]: On master: Close
[0m20:09:46.715840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:09:46.716694 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m20:09:46.717735 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m20:09:46.717735 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m20:09:46.718692 [info ] [MainThread]: 
[0m20:09:46.719722 [info ] [MainThread]: Finished running 1 table model, 1 views model, 1 view model in 0 hours 0 minutes and 20.39 seconds (20.39s).
[0m20:09:46.722306 [debug] [MainThread]: Command end result
[0m20:09:46.734812 [info ] [MainThread]: 
[0m20:09:46.734812 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:09:46.734812 [info ] [MainThread]: 
[0m20:09:46.734812 [error] [MainThread]:   Compilation Error in model vw_sales (models\views\vw_sales.sql)
  No materialization 'views' was found for adapter redshift! (searched types 'default' and 'redshift')
[0m20:09:46.744675 [info ] [MainThread]: 
[0m20:09:46.748098 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:09:46.751114 [debug] [MainThread]: Command `dbt run` failed at 20:09:46.751114 after 21.32 seconds
[0m20:09:46.753062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9D8CB620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9D38A2D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C9D38A570>]}
[0m20:09:46.754631 [debug] [MainThread]: Flushing usage events
[0m20:12:27.205289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CE7147D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CE714050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CE7178F0>]}


============================== 20:12:27.220984 | 61615b28-9d94-4c6c-86b6-af59745b6aa8 ==============================
[0m20:12:27.220984 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:12:27.220984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:12:27.713605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61615b28-9d94-4c6c-86b6-af59745b6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CEC77C80>]}
[0m20:12:27.802100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61615b28-9d94-4c6c-86b6-af59745b6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CE6FEDE0>]}
[0m20:12:27.802100 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m20:12:27.820838 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:12:27.839240 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m20:12:27.839240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '61615b28-9d94-4c6c-86b6-af59745b6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CF239EE0>]}
[0m20:12:29.261429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61615b28-9d94-4c6c-86b6-af59745b6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CF76E690>]}
[0m20:12:29.277047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61615b28-9d94-4c6c-86b6-af59745b6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CF3ED940>]}
[0m20:12:29.277047 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:12:29.277047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61615b28-9d94-4c6c-86b6-af59745b6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CF340800>]}
[0m20:12:29.277047 [info ] [MainThread]: 
[0m20:12:29.291340 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:12:29.293333 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m20:12:29.320680 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:12:29.322674 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m20:12:29.323673 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:29.324935 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:12:29.324935 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:12:31.422605 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:12:31.422605 [debug] [ThreadPool]: On list_dev: Close
[0m20:12:31.438237 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m20:12:31.454268 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:12:31.454268 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:12:31.454268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:31.454268 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:12:31.454268 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:12:33.180152 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:12:33.180152 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:12:33.180152 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m20:12:33.483368 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:33.487376 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:12:33.774393 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:12:33.788444 [debug] [MainThread]: Using redshift connection "master"
[0m20:12:33.789445 [debug] [MainThread]: On master: BEGIN
[0m20:12:33.790455 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:12:33.791214 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:12:33.792225 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:12:35.533485 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m20:12:35.533485 [debug] [MainThread]: Using redshift connection "master"
[0m20:12:35.533485 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:12:35.877660 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:35.877660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61615b28-9d94-4c6c-86b6-af59745b6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CF7503E0>]}
[0m20:12:35.877660 [debug] [MainThread]: On master: ROLLBACK
[0m20:12:36.192045 [debug] [MainThread]: Using redshift connection "master"
[0m20:12:36.192045 [debug] [MainThread]: On master: BEGIN
[0m20:12:36.332476 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:36.332476 [debug] [MainThread]: On master: COMMIT
[0m20:12:36.332476 [debug] [MainThread]: Using redshift connection "master"
[0m20:12:36.332476 [debug] [MainThread]: On master: COMMIT
[0m20:12:36.631275 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:36.631275 [debug] [MainThread]: On master: Close
[0m20:12:36.631275 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:12:36.631275 [info ] [MainThread]: 
[0m20:12:36.648020 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:12:36.649083 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:12:36.652086 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.analytics_dbt.my_first_dbt_model'
[0m20:12:36.653505 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:12:36.653505 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:12:36.661121 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 20:12:36.653505 => 20:12:36.661121
[0m20:12:36.661121 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:12:36.720049 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m20:12:36.720049 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:36.720049 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:12:36.720049 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:12:36.720049 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:12:36.734637 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:12:38.492890 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:12:38.494825 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:38.495825 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:12:38.820015 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:38.835666 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:12:38.835666 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:38.835666 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:12:39.545970 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:12:39.561513 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:39.561513 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:12:39.703060 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:39.718660 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m20:12:39.718660 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:39.718660 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m20:12:40.016295 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:40.031763 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:12:40.031763 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:40.031763 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:12:40.533847 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:12:40.549548 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:40.549548 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:12:40.691596 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:40.707072 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:40.707072 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:12:41.726917 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:12:41.757991 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:12:41.757991 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:41.757991 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:12:42.401258 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:12:42.401258 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:42.401258 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:12:42.698427 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:42.698427 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m20:12:42.698427 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:42.713753 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:12:42.997501 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:42.997501 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:12:42.997501 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:42.997501 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:12:43.162940 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:43.164522 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:12:43.165537 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:12:43.308890 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:43.308890 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 20:12:36.661121 => 20:12:43.308890
[0m20:12:43.308890 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:12:43.607861 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:12:43.607861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61615b28-9d94-4c6c-86b6-af59745b6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CF67BB00>]}
[0m20:12:43.607861 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 6.96s]
[0m20:12:43.607861 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:12:43.607861 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m20:12:43.607861 [info ] [Thread-1 (]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m20:12:43.607861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m20:12:43.622552 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m20:12:43.625561 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:12:43.627561 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 20:12:43.623564 => 20:12:43.627561
[0m20:12:43.628563 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m20:12:43.659563 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m20:12:43.668522 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:12:43.669119 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:12:43.669119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:43.669119 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:12:43.669119 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:12:45.347396 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:12:45.347396 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:12:45.347396 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales
),

renamed as (

    select 
        SALESID AS ID_VENDAS,
        LISTID AS ID_LISTA,
        SALLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMISSION AS COMISSAO,
        SALETIME AS DATA_VENDA
    
    from source_sales
)

SELECT * FROM renamed
  ) ;
[0m20:12:45.491170 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column "sallerid" does not exist in source_sales
[0m20:12:45.491170 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:12:45.765814 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 20:12:43.629562 => 20:12:45.765814
[0m20:12:45.765814 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m20:12:45.781292 [debug] [Thread-1 (]: Database Error in model vw_sales (models\views\vw_sales.sql)
  column "sallerid" does not exist in source_sales
  compiled Code at target\run\analytics_dbt\models\views\vw_sales.sql
[0m20:12:45.781292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61615b28-9d94-4c6c-86b6-af59745b6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CFC9ABD0>]}
[0m20:12:45.791389 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public.vw_sales ........................... [[31mERROR[0m in 2.17s]
[0m20:12:45.791389 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m20:12:45.791389 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:12:45.791389 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:12:45.798786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m20:12:45.798786 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:12:45.805937 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:12:45.806346 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 20:12:45.800927 => 20:12:45.806346
[0m20:12:45.806346 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:12:45.806346 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m20:12:45.820502 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:12:45.820502 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:12:45.820502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:12:45.820502 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:12:45.820502 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:12:47.529503 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:12:47.529503 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:12:47.544911 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m20:12:48.129132 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:12:48.135214 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:12:48.137133 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:12:48.563070 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:48.563070 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:12:48.563070 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:12:48.578465 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:12:49.189480 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:12:49.189480 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:12:49.189480 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:12:49.472716 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:49.488085 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m20:12:49.488085 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:12:49.488085 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:12:49.785835 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:49.785835 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:12:49.785835 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:12:49.785835 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:12:49.939444 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:49.939444 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:12:49.939444 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:12:50.092921 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:50.095937 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 20:12:45.806346 => 20:12:50.094950
[0m20:12:50.096928 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:12:50.384973 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:12:50.384973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61615b28-9d94-4c6c-86b6-af59745b6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258D0035940>]}
[0m20:12:50.384973 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 4.59s]
[0m20:12:50.384973 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:12:50.384973 [debug] [MainThread]: Using redshift connection "master"
[0m20:12:50.384973 [debug] [MainThread]: On master: BEGIN
[0m20:12:50.384973 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:12:50.384973 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:12:50.384973 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:12:51.652343 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:12:51.652343 [debug] [MainThread]: On master: COMMIT
[0m20:12:51.667924 [debug] [MainThread]: Using redshift connection "master"
[0m20:12:51.667924 [debug] [MainThread]: On master: COMMIT
[0m20:12:51.951478 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:12:51.953502 [debug] [MainThread]: On master: Close
[0m20:12:51.955517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:12:51.956475 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m20:12:51.957483 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m20:12:51.958480 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m20:12:51.959520 [info ] [MainThread]: 
[0m20:12:51.961805 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 22.68 seconds (22.68s).
[0m20:12:51.964421 [debug] [MainThread]: Command end result
[0m20:12:51.982421 [info ] [MainThread]: 
[0m20:12:51.984425 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:12:51.986425 [info ] [MainThread]: 
[0m20:12:51.987420 [error] [MainThread]:   Database Error in model vw_sales (models\views\vw_sales.sql)
  column "sallerid" does not exist in source_sales
  compiled Code at target\run\analytics_dbt\models\views\vw_sales.sql
[0m20:12:51.989705 [info ] [MainThread]: 
[0m20:12:51.989705 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:12:51.989705 [debug] [MainThread]: Command `dbt run` failed at 20:12:51.989705 after 24.86 seconds
[0m20:12:51.989705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CD0FA330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CF67BB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258CF75F2F0>]}
[0m20:12:51.989705 [debug] [MainThread]: Flushing usage events
[0m20:13:05.788564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C2E16600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C2E16ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C2E16450>]}


============================== 20:13:05.804228 | 4ca0963e-3bfd-458b-bf1f-88c567877503 ==============================
[0m20:13:05.804228 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:13:05.804228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:13:06.304382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ca0963e-3bfd-458b-bf1f-88c567877503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C354FC80>]}
[0m20:13:06.383199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ca0963e-3bfd-458b-bf1f-88c567877503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C390D400>]}
[0m20:13:06.383199 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m20:13:06.402537 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:13:06.532950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:13:06.532950 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:13:06.548552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ca0963e-3bfd-458b-bf1f-88c567877503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C33E2B10>]}
[0m20:13:06.564583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ca0963e-3bfd-458b-bf1f-88c567877503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C3A3F920>]}
[0m20:13:06.564583 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:13:06.564583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ca0963e-3bfd-458b-bf1f-88c567877503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C2F43E00>]}
[0m20:13:06.564583 [info ] [MainThread]: 
[0m20:13:06.564583 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:13:06.564583 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m20:13:06.596072 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:13:06.597781 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m20:13:06.598848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:06.599973 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:13:06.599973 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:13:08.716569 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:13:08.716569 [debug] [ThreadPool]: On list_dev: Close
[0m20:13:08.732197 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m20:13:08.751581 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:13:08.752582 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:13:08.753575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:13:08.755573 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:13:08.756582 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:13:10.462683 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:13:10.462683 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:13:10.462683 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m20:13:10.763890 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:10.763890 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:13:11.041124 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:13:11.065964 [debug] [MainThread]: Using redshift connection "master"
[0m20:13:11.065964 [debug] [MainThread]: On master: BEGIN
[0m20:13:11.065964 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:13:11.065964 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:13:11.065964 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:13:12.782006 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m20:13:12.829166 [debug] [MainThread]: Using redshift connection "master"
[0m20:13:12.829166 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:13:13.157359 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:13.174049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ca0963e-3bfd-458b-bf1f-88c567877503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C3BB15E0>]}
[0m20:13:13.174049 [debug] [MainThread]: On master: ROLLBACK
[0m20:13:13.483299 [debug] [MainThread]: Using redshift connection "master"
[0m20:13:13.483299 [debug] [MainThread]: On master: BEGIN
[0m20:13:13.628950 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:13.628950 [debug] [MainThread]: On master: COMMIT
[0m20:13:13.628950 [debug] [MainThread]: Using redshift connection "master"
[0m20:13:13.628950 [debug] [MainThread]: On master: COMMIT
[0m20:13:13.926021 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:13.926021 [debug] [MainThread]: On master: Close
[0m20:13:13.926021 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:13:13.926021 [info ] [MainThread]: 
[0m20:13:13.944147 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:13:13.945162 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:13:13.948092 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.analytics_dbt.my_first_dbt_model'
[0m20:13:13.949999 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:13:13.953153 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:13:13.953153 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 20:13:13.951916 => 20:13:13.953153
[0m20:13:13.953153 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:13:14.022902 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m20:13:14.026982 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:14.028529 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:13:14.029539 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:13:14.030549 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:13:14.031844 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:13:15.281286 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:13:15.281286 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:15.281286 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:13:15.620606 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:15.620606 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:13:15.620606 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:15.620606 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:13:16.529937 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:13:16.529937 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:16.529937 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:13:16.686918 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:16.686918 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m20:13:16.702644 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:16.704301 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m20:13:16.999965 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:16.999965 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:13:16.999965 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:16.999965 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:13:17.501314 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:13:17.501314 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:17.501314 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:13:17.643043 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:17.658288 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:17.658288 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:13:18.671934 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:13:18.706498 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:13:18.707817 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:18.708829 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:13:19.381864 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:13:19.397656 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:19.397656 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:13:19.680693 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:19.680693 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m20:13:19.696020 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:19.697587 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:13:19.978054 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:19.978054 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:13:19.978054 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:19.993726 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:13:20.135719 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:20.135719 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:13:20.135719 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:13:20.292592 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:20.292592 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 20:13:13.953153 => 20:13:20.292592
[0m20:13:20.299649 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:13:20.589472 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:13:20.589472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ca0963e-3bfd-458b-bf1f-88c567877503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C39D6270>]}
[0m20:13:20.589472 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 6.64s]
[0m20:13:20.589472 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:13:20.589472 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m20:13:20.589472 [info ] [Thread-1 (]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m20:13:20.600488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m20:13:20.600488 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m20:13:20.605607 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:13:20.608294 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 20:13:20.600488 => 20:13:20.607283
[0m20:13:20.609360 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m20:13:20.636527 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m20:13:20.636527 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:13:20.636527 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:13:20.636527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:20.636527 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:13:20.649723 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:13:21.860621 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:13:21.860621 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:13:21.860621 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales
),

renamed as (

    select 
        SALESID AS ID_VENDAS,
        LISTID AS ID_LISTA,
        SALLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMISSION AS COMISSAO,
        SALETIME AS DATA_VENDA
    
    from source_sales
)

SELECT * FROM renamed
  ) ;
[0m20:13:22.006489 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column "sallerid" does not exist in source_sales
[0m20:13:22.006489 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:13:22.284728 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 20:13:20.610291 => 20:13:22.284728
[0m20:13:22.284728 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m20:13:22.284728 [debug] [Thread-1 (]: Database Error in model vw_sales (models\views\vw_sales.sql)
  column "sallerid" does not exist in source_sales
  compiled Code at target\run\analytics_dbt\models\views\vw_sales.sql
[0m20:13:22.284728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ca0963e-3bfd-458b-bf1f-88c567877503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C39F5370>]}
[0m20:13:22.300153 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public.vw_sales ........................... [[31mERROR[0m in 1.68s]
[0m20:13:22.300153 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m20:13:22.300153 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:13:22.300153 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:13:22.308589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m20:13:22.309654 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:13:22.316484 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:13:22.318551 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 20:13:22.310647 => 20:13:22.318551
[0m20:13:22.318551 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:13:22.318551 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m20:13:22.332025 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:13:22.333040 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:13:22.335043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:13:22.336035 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:13:22.338037 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:13:24.011469 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:13:24.011469 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:13:24.012981 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m20:13:24.566770 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:13:24.566770 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:13:24.566770 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:13:24.997387 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:24.997387 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:13:24.997387 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:13:24.997387 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:13:25.670611 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:13:25.670611 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:13:25.685966 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:13:25.951844 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:25.967515 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m20:13:25.967515 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:13:25.967515 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:13:26.256205 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:26.258404 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:13:26.259268 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:13:26.260485 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:13:26.406996 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:26.406996 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:13:26.406996 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:13:26.550443 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:26.552991 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 20:13:22.318551 => 20:13:26.551953
[0m20:13:26.553965 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:13:26.834358 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:13:26.836404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ca0963e-3bfd-458b-bf1f-88c567877503', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C4212030>]}
[0m20:13:26.837432 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 4.53s]
[0m20:13:26.839816 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:13:26.842874 [debug] [MainThread]: Using redshift connection "master"
[0m20:13:26.844817 [debug] [MainThread]: On master: BEGIN
[0m20:13:26.845825 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:13:26.847818 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:13:26.848821 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:13:28.057082 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:13:28.058132 [debug] [MainThread]: On master: COMMIT
[0m20:13:28.059122 [debug] [MainThread]: Using redshift connection "master"
[0m20:13:28.060762 [debug] [MainThread]: On master: COMMIT
[0m20:13:28.333950 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:13:28.333950 [debug] [MainThread]: On master: Close
[0m20:13:28.333950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:13:28.333950 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m20:13:28.333950 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m20:13:28.333950 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m20:13:28.333950 [info ] [MainThread]: 
[0m20:13:28.333950 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 21.77 seconds (21.77s).
[0m20:13:28.349628 [debug] [MainThread]: Command end result
[0m20:13:28.349628 [info ] [MainThread]: 
[0m20:13:28.366757 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:13:28.368772 [info ] [MainThread]: 
[0m20:13:28.370780 [error] [MainThread]:   Database Error in model vw_sales (models\views\vw_sales.sql)
  column "sallerid" does not exist in source_sales
  compiled Code at target\run\analytics_dbt\models\views\vw_sales.sql
[0m20:13:28.373381 [info ] [MainThread]: 
[0m20:13:28.373381 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:13:28.373381 [debug] [MainThread]: Command `dbt run` failed at 20:13:28.373381 after 22.66 seconds
[0m20:13:28.382487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C2710830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C385F050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C2B86A80>]}
[0m20:13:28.383488 [debug] [MainThread]: Flushing usage events
[0m20:16:57.212209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5FF446A20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5FF447B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5FF444D10>]}


============================== 20:16:57.212209 | e7d1fc16-9760-4fc5-bd2f-6fa99b905b4d ==============================
[0m20:16:57.212209 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:16:57.212209 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:16:57.619400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7d1fc16-9760-4fc5-bd2f-6fa99b905b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5FFB46780>]}
[0m20:16:57.704035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e7d1fc16-9760-4fc5-bd2f-6fa99b905b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5FFE39730>]}
[0m20:16:57.704035 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m20:16:57.722340 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:16:57.854749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:16:57.855751 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models\views\vw_sales.sql
[0m20:16:57.993558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7d1fc16-9760-4fc5-bd2f-6fa99b905b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5804B7B30>]}
[0m20:16:58.004570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7d1fc16-9760-4fc5-bd2f-6fa99b905b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5801344D0>]}
[0m20:16:58.009578 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:16:58.009578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7d1fc16-9760-4fc5-bd2f-6fa99b905b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5804F02C0>]}
[0m20:16:58.009578 [info ] [MainThread]: 
[0m20:16:58.009578 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:16:58.009578 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m20:16:58.040382 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:16:58.041316 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m20:16:58.042606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:58.042606 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:16:58.042606 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:16:59.957099 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:16:59.959144 [debug] [ThreadPool]: On list_dev: Close
[0m20:16:59.965358 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m20:16:59.978369 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:16:59.978369 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:16:59.984442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:59.986290 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:16:59.986290 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:17:01.291801 [debug] [ThreadPool]: SQL status: SUCCESS in 1.0 seconds
[0m20:17:01.291801 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:17:01.291801 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m20:17:01.599774 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:01.599774 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:17:01.898911 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:17:01.919034 [debug] [MainThread]: Using redshift connection "master"
[0m20:17:01.919034 [debug] [MainThread]: On master: BEGIN
[0m20:17:01.919034 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:17:01.922458 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:17:01.922458 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:17:03.643237 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m20:17:03.643237 [debug] [MainThread]: Using redshift connection "master"
[0m20:17:03.643237 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:17:03.970593 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:03.985815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7d1fc16-9760-4fc5-bd2f-6fa99b905b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5808E5700>]}
[0m20:17:03.985815 [debug] [MainThread]: On master: ROLLBACK
[0m20:17:04.282099 [debug] [MainThread]: Using redshift connection "master"
[0m20:17:04.282099 [debug] [MainThread]: On master: BEGIN
[0m20:17:04.423804 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:04.423804 [debug] [MainThread]: On master: COMMIT
[0m20:17:04.423804 [debug] [MainThread]: Using redshift connection "master"
[0m20:17:04.423804 [debug] [MainThread]: On master: COMMIT
[0m20:17:04.716183 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:04.716183 [debug] [MainThread]: On master: Close
[0m20:17:04.719542 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:17:04.720551 [info ] [MainThread]: 
[0m20:17:04.727035 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:17:04.728006 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:17:04.730011 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.analytics_dbt.my_first_dbt_model'
[0m20:17:04.731009 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:17:04.735686 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:17:04.735686 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 20:17:04.732013 => 20:17:04.735686
[0m20:17:04.735686 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:17:04.786007 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m20:17:04.802591 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:04.802591 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:17:04.802591 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:17:04.802591 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:17:04.802591 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:17:06.540149 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:17:06.540149 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:06.540149 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:17:06.884019 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:06.884019 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:17:06.884019 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:06.884019 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:17:07.655820 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:17:07.655820 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:07.655820 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:17:07.812875 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:07.812875 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m20:17:07.827493 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:07.829096 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m20:17:08.124901 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:08.128411 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:17:08.128411 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:08.128411 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:17:08.642682 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:17:08.642682 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:08.642682 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:17:08.800014 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:08.800014 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:08.800014 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:17:09.865765 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:17:09.897358 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:17:09.897358 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:09.897358 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:17:10.512917 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:17:10.512917 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:10.528273 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:17:10.820056 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:10.820056 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m20:17:10.820056 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:10.820056 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:17:11.118651 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:11.118651 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:17:11.118651 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:11.118651 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:17:11.260910 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:11.276224 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:17:11.276224 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:17:11.418457 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:11.418457 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 20:17:04.735686 => 20:17:11.418457
[0m20:17:11.418457 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:17:11.713640 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:17:11.713640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d1fc16-9760-4fc5-bd2f-6fa99b905b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5805A8C20>]}
[0m20:17:11.728969 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 6.98s]
[0m20:17:11.728969 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:17:11.728969 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m20:17:11.728969 [info ] [Thread-1 (]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m20:17:11.737541 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m20:17:11.738625 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m20:17:11.741687 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:17:11.741687 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 20:17:11.739674 => 20:17:11.741687
[0m20:17:11.741687 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m20:17:11.773774 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m20:17:11.779727 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:17:11.780728 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:17:11.781728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:11.782727 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:17:11.783753 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:17:13.487883 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:17:13.487883 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:17:13.487883 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales

),



renamed as (

    select 
        SALESID AS ID_VENDAS,
        LISTID AS ID_LISTA,
        SALLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMISSION AS COMISSAO,
        SALETIME AS DATA_VENDA
     from source_sales

)

SELECT * FROM renamed
  ) ;
[0m20:17:13.629941 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column "sallerid" does not exist in source_sales
[0m20:17:13.629941 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:17:13.909050 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 20:17:11.741687 => 20:17:13.909050
[0m20:17:13.924354 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m20:17:13.924354 [debug] [Thread-1 (]: Database Error in model vw_sales (models\views\vw_sales.sql)
  column "sallerid" does not exist in source_sales
  compiled Code at target\run\analytics_dbt\models\views\vw_sales.sql
[0m20:17:13.924354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d1fc16-9760-4fc5-bd2f-6fa99b905b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E580A2D1C0>]}
[0m20:17:13.924354 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public.vw_sales ........................... [[31mERROR[0m in 2.20s]
[0m20:17:13.924354 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m20:17:13.924354 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:17:13.924354 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:17:13.924354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m20:17:13.924354 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:17:13.943830 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:17:13.945761 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 20:17:13.924354 => 20:17:13.945761
[0m20:17:13.947711 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:17:13.954697 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m20:17:13.954697 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:17:13.954697 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:17:13.954697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:17:13.954697 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:17:13.954697 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:17:15.650567 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:17:15.650567 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:17:15.650567 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m20:17:16.216885 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:17:16.216885 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:17:16.216885 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:17:16.639024 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:16.654264 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:17:16.654264 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:17:16.654264 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:17:17.298759 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:17:17.298759 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:17:17.298759 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:17:17.578563 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:17.578563 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m20:17:17.594263 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:17:17.594263 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:17:17.865045 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:17.878569 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:17:17.878569 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:17:17.878569 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:17:18.018387 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:18.018387 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:17:18.033966 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:17:18.165524 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:18.176088 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 20:17:13.947711 => 20:17:18.176088
[0m20:17:18.176088 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:17:18.460476 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:17:18.460476 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e7d1fc16-9760-4fc5-bd2f-6fa99b905b4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E580A2CA40>]}
[0m20:17:18.460476 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 4.54s]
[0m20:17:18.466067 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:17:18.466067 [debug] [MainThread]: Using redshift connection "master"
[0m20:17:18.466067 [debug] [MainThread]: On master: BEGIN
[0m20:17:18.466067 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:17:18.466067 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:17:18.466067 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:17:20.180049 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m20:17:20.180049 [debug] [MainThread]: On master: COMMIT
[0m20:17:20.180049 [debug] [MainThread]: Using redshift connection "master"
[0m20:17:20.180049 [debug] [MainThread]: On master: COMMIT
[0m20:17:20.479569 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:17:20.479569 [debug] [MainThread]: On master: Close
[0m20:17:20.479569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:17:20.479569 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m20:17:20.479569 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m20:17:20.479569 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m20:17:20.479569 [info ] [MainThread]: 
[0m20:17:20.479569 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 22.47 seconds (22.47s).
[0m20:17:20.479569 [debug] [MainThread]: Command end result
[0m20:17:20.503391 [info ] [MainThread]: 
[0m20:17:20.503391 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:17:20.503391 [info ] [MainThread]: 
[0m20:17:20.503391 [error] [MainThread]:   Database Error in model vw_sales (models\views\vw_sales.sql)
  column "sallerid" does not exist in source_sales
  compiled Code at target\run\analytics_dbt\models\views\vw_sales.sql
[0m20:17:20.503391 [info ] [MainThread]: 
[0m20:17:20.503391 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:17:20.518265 [debug] [MainThread]: Command `dbt run` failed at 20:17:20.518265 after 23.38 seconds
[0m20:17:20.518265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5FF42F440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E580987E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E580A4B170>]}
[0m20:17:20.518265 [debug] [MainThread]: Flushing usage events
[0m20:19:32.818940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A050D35B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A050D36C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A050D35BB0>]}


============================== 20:19:32.818940 | 49b80da5-2013-4a89-a102-f17764501d1c ==============================
[0m20:19:32.818940 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:19:32.818940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:19:33.240602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49b80da5-2013-4a89-a102-f17764501d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0505EFC80>]}
[0m20:19:33.336381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49b80da5-2013-4a89-a102-f17764501d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A050D1AFC0>]}
[0m20:19:33.336381 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m20:19:33.356281 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:19:33.491042 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:19:33.491042 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models\views\vw_sales.sql
[0m20:19:33.663953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49b80da5-2013-4a89-a102-f17764501d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A050D1AFF0>]}
[0m20:19:33.679578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49b80da5-2013-4a89-a102-f17764501d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A051C380B0>]}
[0m20:19:33.679578 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:19:33.679578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49b80da5-2013-4a89-a102-f17764501d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0518CF4A0>]}
[0m20:19:33.679578 [info ] [MainThread]: 
[0m20:19:33.679578 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:19:33.696773 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m20:19:33.711752 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:19:33.711752 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m20:19:33.711752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:33.728761 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:19:33.729719 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:19:35.538764 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:19:35.541765 [debug] [ThreadPool]: On list_dev: Close
[0m20:19:35.546870 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m20:19:35.558938 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:19:35.558938 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:19:35.558938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:35.558938 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:19:35.558938 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:19:37.270918 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:19:37.270918 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:19:37.270918 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m20:19:37.570274 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:37.570274 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:19:37.853585 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:19:37.869336 [debug] [MainThread]: Using redshift connection "master"
[0m20:19:37.869336 [debug] [MainThread]: On master: BEGIN
[0m20:19:37.869336 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:19:37.869336 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:19:37.869336 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:19:39.091055 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:19:39.091055 [debug] [MainThread]: Using redshift connection "master"
[0m20:19:39.091055 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:19:39.422774 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:39.422774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49b80da5-2013-4a89-a102-f17764501d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05185E000>]}
[0m20:19:39.422774 [debug] [MainThread]: On master: ROLLBACK
[0m20:19:39.718382 [debug] [MainThread]: Using redshift connection "master"
[0m20:19:39.718382 [debug] [MainThread]: On master: BEGIN
[0m20:19:39.860252 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:39.875886 [debug] [MainThread]: On master: COMMIT
[0m20:19:39.875886 [debug] [MainThread]: Using redshift connection "master"
[0m20:19:39.875886 [debug] [MainThread]: On master: COMMIT
[0m20:19:40.157601 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:40.157601 [debug] [MainThread]: On master: Close
[0m20:19:40.157601 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:19:40.157601 [info ] [MainThread]: 
[0m20:19:40.157601 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:19:40.157601 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:19:40.174830 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.analytics_dbt.my_first_dbt_model'
[0m20:19:40.176889 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:19:40.181906 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:19:40.184458 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 20:19:40.177897 => 20:19:40.184458
[0m20:19:40.185701 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:19:40.292520 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m20:19:40.292520 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:40.292520 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:19:40.292520 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:19:40.308147 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:19:40.308147 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:19:41.584757 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:19:41.584757 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:41.584757 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:19:41.929305 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:41.929305 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:19:41.929305 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:41.929305 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:19:42.636701 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:19:42.636701 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:42.636701 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:19:42.776044 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:42.791164 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m20:19:42.791164 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:42.791164 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m20:19:43.091060 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:43.091060 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:19:43.091060 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:43.091060 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:19:43.624210 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:19:43.624210 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:43.624210 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:19:43.769420 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:43.781527 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:43.781527 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:19:44.799732 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:19:44.815155 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:19:44.815155 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:44.815155 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:19:45.425246 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:19:45.425246 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:45.425246 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:19:45.723065 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:45.723065 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m20:19:45.723065 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:45.723065 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:19:46.020959 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:46.020959 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:19:46.020959 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:46.020959 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:19:46.178434 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:46.178434 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:19:46.178434 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:19:46.328621 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:46.328621 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 20:19:40.186671 => 20:19:46.328621
[0m20:19:46.328621 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:19:46.617063 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:19:46.617063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49b80da5-2013-4a89-a102-f17764501d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A051FE2F90>]}
[0m20:19:46.632482 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 6.44s]
[0m20:19:46.632482 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:19:46.632482 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m20:19:46.632482 [info ] [Thread-1 (]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m20:19:46.632482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m20:19:46.632482 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m20:19:46.632482 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:19:46.632482 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 20:19:46.632482 => 20:19:46.632482
[0m20:19:46.632482 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m20:19:46.680137 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m20:19:46.680137 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:19:46.680137 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:19:46.680137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:46.680137 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:19:46.692396 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:19:47.935708 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:19:47.935708 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:19:47.951067 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales

),



renamed as (

    select 
        SALESID AS ID_VENDAS,
        LISTID AS ID_LISTA,
        SELLER AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        SALETIME AS DATA_VENDA
     from source_sales

)

SELECT * FROM renamed
  ) ;
[0m20:19:48.091050 [debug] [Thread-1 (]: Redshift adapter: Redshift error: column "seller" does not exist in source_sales
[0m20:19:48.091050 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:19:48.390345 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 20:19:46.648073 => 20:19:48.390345
[0m20:19:48.390345 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m20:19:48.390345 [debug] [Thread-1 (]: Database Error in model vw_sales (models\views\vw_sales.sql)
  column "seller" does not exist in source_sales
  compiled Code at target\run\analytics_dbt\models\views\vw_sales.sql
[0m20:19:48.390345 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49b80da5-2013-4a89-a102-f17764501d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05232AC60>]}
[0m20:19:48.390345 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public.vw_sales ........................... [[31mERROR[0m in 1.76s]
[0m20:19:48.390345 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m20:19:48.390345 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:19:48.405987 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:19:48.409382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m20:19:48.410399 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:19:48.414580 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:19:48.414580 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 20:19:48.411454 => 20:19:48.414580
[0m20:19:48.414580 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:19:48.428465 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m20:19:48.428465 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:19:48.428465 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:19:48.428465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:48.428465 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:19:48.428465 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:19:49.692573 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:19:49.692573 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:19:49.692573 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m20:19:50.286017 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:19:50.286017 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:19:50.294533 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:19:50.724652 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:50.724652 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:19:50.724652 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:19:50.724652 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:19:51.357071 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:19:51.357071 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:19:51.357071 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:19:51.656058 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:51.656058 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m20:19:51.656058 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:19:51.656058 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:19:51.948540 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:51.948540 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:19:51.948540 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:19:51.948540 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:19:52.105859 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:52.105859 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:19:52.105859 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:19:52.263516 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:52.263516 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 20:19:48.414580 => 20:19:52.263516
[0m20:19:52.263516 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:19:52.560452 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:19:52.560452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49b80da5-2013-4a89-a102-f17764501d1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A0522F1C40>]}
[0m20:19:52.560452 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 4.15s]
[0m20:19:52.560452 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:19:52.560452 [debug] [MainThread]: Using redshift connection "master"
[0m20:19:52.560452 [debug] [MainThread]: On master: BEGIN
[0m20:19:52.560452 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:19:52.560452 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:19:52.560452 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:19:54.240318 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m20:19:54.255626 [debug] [MainThread]: On master: COMMIT
[0m20:19:54.255626 [debug] [MainThread]: Using redshift connection "master"
[0m20:19:54.255626 [debug] [MainThread]: On master: COMMIT
[0m20:19:54.535330 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:19:54.535330 [debug] [MainThread]: On master: Close
[0m20:19:54.535330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:19:54.535330 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m20:19:54.535330 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m20:19:54.535330 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m20:19:54.535330 [info ] [MainThread]: 
[0m20:19:54.535330 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 20.86 seconds (20.86s).
[0m20:19:54.535330 [debug] [MainThread]: Command end result
[0m20:19:54.550719 [info ] [MainThread]: 
[0m20:19:54.550719 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:19:54.566627 [info ] [MainThread]: 
[0m20:19:54.568686 [error] [MainThread]:   Database Error in model vw_sales (models\views\vw_sales.sql)
  column "seller" does not exist in source_sales
  compiled Code at target\run\analytics_dbt\models\views\vw_sales.sql
[0m20:19:54.570628 [info ] [MainThread]: 
[0m20:19:54.574270 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:19:54.578311 [debug] [MainThread]: Command `dbt run` failed at 20:19:54.578311 after 21.83 seconds
[0m20:19:54.580293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A050D35B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A050D36C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A05154C800>]}
[0m20:19:54.581009 [debug] [MainThread]: Flushing usage events
[0m20:20:27.759863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED9C27620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED9C27860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED9C26C60>]}


============================== 20:20:27.759863 | 9fabcc26-71bd-47d1-b822-3bee35ee8d2e ==============================
[0m20:20:27.759863 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:20:27.770872 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:20:28.274439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fabcc26-71bd-47d1-b822-3bee35ee8d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED9C0B560>]}
[0m20:20:28.368563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fabcc26-71bd-47d1-b822-3bee35ee8d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED9A08E00>]}
[0m20:20:28.368563 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m20:20:28.392122 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:20:28.520568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:20:28.520568 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models\views\vw_sales.sql
[0m20:20:28.680867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fabcc26-71bd-47d1-b822-3bee35ee8d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EDA813170>]}
[0m20:20:28.696937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fabcc26-71bd-47d1-b822-3bee35ee8d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EDA944080>]}
[0m20:20:28.696937 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:20:28.696937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fabcc26-71bd-47d1-b822-3bee35ee8d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EDACB74A0>]}
[0m20:20:28.696937 [info ] [MainThread]: 
[0m20:20:28.696937 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:20:28.696937 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m20:20:28.725426 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:20:28.725426 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m20:20:28.725426 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:28.742214 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:20:28.744131 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:20:30.898394 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:20:30.907065 [debug] [ThreadPool]: On list_dev: Close
[0m20:20:30.909595 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m20:20:30.928330 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:20:30.928330 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:20:30.928330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:30.928330 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:20:30.928330 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:20:32.857490 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:20:32.857490 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:20:32.859675 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m20:20:33.200828 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:33.200828 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:20:33.524787 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:20:33.559096 [debug] [MainThread]: Using redshift connection "master"
[0m20:20:33.559642 [debug] [MainThread]: On master: BEGIN
[0m20:20:33.559642 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:20:33.559642 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:20:33.559642 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:20:35.282196 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m20:20:35.283199 [debug] [MainThread]: Using redshift connection "master"
[0m20:20:35.284235 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:20:35.624339 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:35.629230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fabcc26-71bd-47d1-b822-3bee35ee8d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EDACB41A0>]}
[0m20:20:35.630218 [debug] [MainThread]: On master: ROLLBACK
[0m20:20:35.938914 [debug] [MainThread]: Using redshift connection "master"
[0m20:20:35.938914 [debug] [MainThread]: On master: BEGIN
[0m20:20:36.080658 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:36.080658 [debug] [MainThread]: On master: COMMIT
[0m20:20:36.080658 [debug] [MainThread]: Using redshift connection "master"
[0m20:20:36.080658 [debug] [MainThread]: On master: COMMIT
[0m20:20:36.369228 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:36.384544 [debug] [MainThread]: On master: Close
[0m20:20:36.384544 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:20:36.384544 [info ] [MainThread]: 
[0m20:20:36.384544 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:20:36.384544 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:20:36.400733 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.analytics_dbt.my_first_dbt_model'
[0m20:20:36.401789 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:20:36.407723 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:20:36.407723 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 20:20:36.402792 => 20:20:36.407723
[0m20:20:36.407723 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:20:36.473580 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m20:20:36.473580 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:36.473580 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:20:36.473580 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:20:36.473580 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:20:36.473580 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:20:39.086616 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m20:20:39.088599 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:39.089602 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:20:39.461923 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:39.461923 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:20:39.461923 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:39.461923 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:20:40.251640 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:20:40.251640 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:40.251640 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:20:40.424353 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:40.439991 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m20:20:40.455968 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:40.457727 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m20:20:40.795712 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:40.798712 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:20:40.800710 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:40.800710 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:20:41.333796 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:20:41.333796 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:41.333796 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:20:42.246425 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:20:42.246425 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:42.246425 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:20:43.402800 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:20:43.434251 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:20:43.434251 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:43.434251 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:20:44.133613 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:20:44.133613 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:44.133613 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:20:44.472159 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:44.472763 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m20:20:44.472763 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:44.472763 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:20:44.817344 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:44.817344 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:20:44.817344 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:44.817344 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:20:44.987218 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:44.987218 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:20:44.987218 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:20:45.154058 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:45.154058 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 20:20:36.407723 => 20:20:45.154058
[0m20:20:45.154058 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:20:45.504335 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:20:45.504335 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fabcc26-71bd-47d1-b822-3bee35ee8d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EDB0E3DA0>]}
[0m20:20:45.504335 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 9.12s]
[0m20:20:45.504335 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:20:45.504335 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m20:20:45.504335 [info ] [Thread-1 (]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m20:20:45.504335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m20:20:45.517449 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m20:20:45.520508 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:20:45.522531 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 20:20:45.518477 => 20:20:45.522531
[0m20:20:45.523461 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m20:20:45.557784 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m20:20:45.557784 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:20:45.557784 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:20:45.557784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:45.557784 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:20:45.557784 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:20:47.467608 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:20:47.467608 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:20:47.467608 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales

),



renamed as (

    select 
        SALESID AS ID_VENDAS,
        LISTID AS ID_LISTA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        SALETIME AS DATA_VENDA
     from source_sales

)

SELECT * FROM renamed
  ) ;
[0m20:20:48.148330 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:20:48.153404 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:20:48.153404 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m20:20:48.666516 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:20:48.670589 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:20:48.671395 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:20:48.671395 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:20:49.385631 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:20:49.385631 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:20:49.385631 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:20:49.720203 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:49.721303 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales__dbt_backup"
[0m20:20:49.721303 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:20:49.721303 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m20:20:50.071381 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:50.074404 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:20:50.076394 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:20:50.077422 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:20:50.240740 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:50.240740 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:20:50.240740 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:20:50.401617 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:50.416638 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 20:20:45.524480 => 20:20:50.416638
[0m20:20:50.416638 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:20:50.756933 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m20:20:50.756933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fabcc26-71bd-47d1-b822-3bee35ee8d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EDB22FD40>]}
[0m20:20:50.756933 [info ] [Thread-1 (]: 2 of 3 OK created sql view model public.vw_sales ............................... [[32mSUCCESS[0m in 5.25s]
[0m20:20:50.765940 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m20:20:50.766924 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:20:50.766924 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:20:50.772938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m20:20:50.774745 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:20:50.774745 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:20:50.774745 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 20:20:50.774745 => 20:20:50.774745
[0m20:20:50.774745 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:20:50.787611 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m20:20:50.790814 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:20:50.790814 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:20:50.790814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:50.790814 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:20:50.790814 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:20:52.104932 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:20:52.106925 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:20:52.107980 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m20:20:52.689652 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:20:52.698324 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:20:52.698324 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:20:53.122591 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:53.139349 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:20:53.139349 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:20:53.139349 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:20:53.781661 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:20:53.786255 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:20:53.786255 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:20:54.078397 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:54.078397 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m20:20:54.086540 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:20:54.086540 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:20:54.376976 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:54.382619 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:20:54.382619 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:20:54.382619 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:20:54.536580 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:54.536917 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:20:54.536917 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:20:54.686374 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:54.686374 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 20:20:50.774745 => 20:20:54.686374
[0m20:20:54.686374 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:20:54.977012 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:20:54.977012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fabcc26-71bd-47d1-b822-3bee35ee8d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029EDB25DF10>]}
[0m20:20:54.986902 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 4.21s]
[0m20:20:54.986902 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:20:54.991445 [debug] [MainThread]: Using redshift connection "master"
[0m20:20:54.991445 [debug] [MainThread]: On master: BEGIN
[0m20:20:54.991445 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:20:54.996471 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:20:54.996471 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:20:56.712744 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m20:20:56.716843 [debug] [MainThread]: On master: COMMIT
[0m20:20:56.716843 [debug] [MainThread]: Using redshift connection "master"
[0m20:20:56.716843 [debug] [MainThread]: On master: COMMIT
[0m20:20:57.006415 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:20:57.006415 [debug] [MainThread]: On master: Close
[0m20:20:57.006415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:57.006415 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m20:20:57.006415 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m20:20:57.006415 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m20:20:57.016808 [info ] [MainThread]: 
[0m20:20:57.016808 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 28.32 seconds (28.32s).
[0m20:20:57.016808 [debug] [MainThread]: Command end result
[0m20:20:57.046586 [info ] [MainThread]: 
[0m20:20:57.046586 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:20:57.046586 [info ] [MainThread]: 
[0m20:20:57.054847 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:20:57.056319 [debug] [MainThread]: Command `dbt run` succeeded at 20:20:57.056319 after 29.38 seconds
[0m20:20:57.056319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED95718B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED9CEAF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029ED94EFF80>]}
[0m20:20:57.056319 [debug] [MainThread]: Flushing usage events
[0m20:35:14.888830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C916117C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C916116BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C916116480>]}


============================== 20:35:14.894350 | a02eb81a-2fef-4e54-8eed-c594ec8b31e7 ==============================
[0m20:35:14.894350 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:35:14.895887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models views/vw_sales.sql', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:35:15.394250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a02eb81a-2fef-4e54-8eed-c594ec8b31e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C916B9CD40>]}
[0m20:35:15.501948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a02eb81a-2fef-4e54-8eed-c594ec8b31e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C916153320>]}
[0m20:35:15.504573 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m20:35:15.525783 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:35:15.679307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:35:15.679307 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:35:15.690487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a02eb81a-2fef-4e54-8eed-c594ec8b31e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C916116690>]}
[0m20:35:15.709178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a02eb81a-2fef-4e54-8eed-c594ec8b31e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C916D38200>]}
[0m20:35:15.709178 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:35:15.714196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a02eb81a-2fef-4e54-8eed-c594ec8b31e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9153B9430>]}
[0m20:35:15.714285 [warn ] [MainThread]: The selection criterion 'views/vw_sales.sql' does not match any nodes
[0m20:35:15.718688 [info ] [MainThread]: 
[0m20:35:15.721636 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:35:15.724185 [debug] [MainThread]: Command end result
[0m20:35:15.744341 [debug] [MainThread]: Command `dbt run` succeeded at 20:35:15.744341 after 0.95 seconds
[0m20:35:15.744341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9161D81A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C916773290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C916B17B00>]}
[0m20:35:15.749413 [debug] [MainThread]: Flushing usage events
[0m20:44:33.774513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F3DBE420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F3F26A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F3F26540>]}


============================== 20:44:33.782043 | 2ced4205-85cf-46bd-962d-d28d7ded5796 ==============================
[0m20:44:33.782043 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:44:33.784423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models views/vw_sales.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:44:34.290425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ced4205-85cf-46bd-962d-d28d7ded5796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F4A583B0>]}
[0m20:44:34.410943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ced4205-85cf-46bd-962d-d28d7ded5796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F45A77D0>]}
[0m20:44:34.415466 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m20:44:34.436879 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:44:34.626667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:44:34.627648 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models\views\vw_sales.sql
[0m20:44:34.806090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ced4205-85cf-46bd-962d-d28d7ded5796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F4ACB680>]}
[0m20:44:34.823342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ced4205-85cf-46bd-962d-d28d7ded5796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F4E3C080>]}
[0m20:44:34.824340 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:44:34.825923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ced4205-85cf-46bd-962d-d28d7ded5796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F4E3C170>]}
[0m20:44:34.827859 [warn ] [MainThread]: The selection criterion 'views/vw_sales.sql' does not match any nodes
[0m20:44:34.830868 [info ] [MainThread]: 
[0m20:44:34.833872 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m20:44:34.836380 [debug] [MainThread]: Command end result
[0m20:44:34.858006 [debug] [MainThread]: Command `dbt run` succeeded at 20:44:34.857002 after 1.17 seconds
[0m20:44:34.859258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F3E58950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F3CA1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1F3DBE420>]}
[0m20:44:34.860306 [debug] [MainThread]: Flushing usage events
[0m20:45:37.735789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B790A17DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B790A15FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B790A16390>]}


============================== 20:45:37.740841 | f4c2f545-b539-4484-aaaa-0b8338f6cc37 ==============================
[0m20:45:37.740841 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:45:37.740841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:45:38.236184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4c2f545-b539-4484-aaaa-0b8338f6cc37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7909FB050>]}
[0m20:45:38.344504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4c2f545-b539-4484-aaaa-0b8338f6cc37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B791443C20>]}
[0m20:45:38.347031 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m20:45:38.363401 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:45:38.519368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:45:38.521306 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:45:38.529263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4c2f545-b539-4484-aaaa-0b8338f6cc37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B79153ABD0>]}
[0m20:45:38.544655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4c2f545-b539-4484-aaaa-0b8338f6cc37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B791637D10>]}
[0m20:45:38.546021 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:45:38.549027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4c2f545-b539-4484-aaaa-0b8338f6cc37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B791637E30>]}
[0m20:45:38.551338 [info ] [MainThread]: 
[0m20:45:38.554297 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:45:38.557880 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m20:45:38.588367 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:45:38.590519 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m20:45:38.592041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:38.596741 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:45:38.599452 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:45:40.487046 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:45:40.490043 [debug] [ThreadPool]: On list_dev: Close
[0m20:45:40.495290 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m20:45:40.505585 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:45:40.512183 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:45:40.514186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:45:40.515695 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:45:40.517707 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:45:42.305510 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:45:42.312652 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:45:42.314657 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m20:45:42.622928 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:42.624923 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:45:42.923884 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:45:42.936155 [debug] [MainThread]: Using redshift connection "master"
[0m20:45:42.936155 [debug] [MainThread]: On master: BEGIN
[0m20:45:42.936155 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:45:42.936155 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:45:42.936155 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:45:44.221614 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:45:44.222572 [debug] [MainThread]: Using redshift connection "master"
[0m20:45:44.223567 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:45:44.566095 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:44.566095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4c2f545-b539-4484-aaaa-0b8338f6cc37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7917B1760>]}
[0m20:45:44.566095 [debug] [MainThread]: On master: ROLLBACK
[0m20:45:44.884725 [debug] [MainThread]: Using redshift connection "master"
[0m20:45:44.887237 [debug] [MainThread]: On master: BEGIN
[0m20:45:45.028778 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:45.028778 [debug] [MainThread]: On master: COMMIT
[0m20:45:45.035953 [debug] [MainThread]: Using redshift connection "master"
[0m20:45:45.035953 [debug] [MainThread]: On master: COMMIT
[0m20:45:45.326746 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:45.328690 [debug] [MainThread]: On master: Close
[0m20:45:45.329987 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:45:45.333362 [info ] [MainThread]: 
[0m20:45:45.335874 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:45:45.335874 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:45:45.335874 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.analytics_dbt.my_first_dbt_model'
[0m20:45:45.345641 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:45:45.351653 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:45:45.355682 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 20:45:45.346689 => 20:45:45.354682
[0m20:45:45.357008 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:45:45.440933 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m20:45:45.446969 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:45.447990 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:45:45.449576 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:45:45.450589 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:45:45.451470 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:45:46.666200 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:45:46.675889 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:46.677418 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:45:47.006689 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:47.012148 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:45:47.013870 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:47.014888 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:45:48.067268 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:45:48.067268 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:48.067268 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:45:48.215056 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:48.223678 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m20:45:48.228812 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:48.228812 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m20:45:48.517852 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:48.520523 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:45:48.521520 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:48.522520 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:45:48.996172 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:48.996172 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:48.996172 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:45:49.136162 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:49.151910 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:49.153904 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:45:50.128212 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:45:50.159621 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:45:50.160567 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:50.161426 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:45:50.719980 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:45:50.721991 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:50.723047 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:45:50.996257 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:51.005893 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m20:45:51.011401 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:51.013189 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:45:51.294898 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:51.299042 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:45:51.300045 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:51.301871 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:45:51.445756 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:51.445756 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:45:51.445756 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:45:51.585996 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:51.593709 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 20:45:45.358033 => 20:45:51.593709
[0m20:45:51.595959 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:45:51.876242 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:45:51.878491 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4c2f545-b539-4484-aaaa-0b8338f6cc37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7915F6A50>]}
[0m20:45:51.879696 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 6.54s]
[0m20:45:51.879696 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:45:51.879696 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m20:45:51.885946 [info ] [Thread-1 (]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m20:45:51.889238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m20:45:51.891257 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m20:45:51.896870 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:45:51.900821 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 20:45:51.891344 => 20:45:51.899853
[0m20:45:51.902112 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m20:45:51.935693 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m20:45:51.940213 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:45:51.941215 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:45:51.942720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:51.943730 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:45:51.946690 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:45:53.178371 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:45:53.239757 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:45:53.241656 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales

),



renamed as (

    select 
        SALESID AS ID_VENDAS,
        LISTID AS ID_LISTA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        cast(SALETIME as date) AS DATA_VENDA,
        to_char( SALETIME, 'dd/mm/yyy hh24:mi:ss') as DATA_HORA_VENDA,
        to_char( SALETIME, 'hh24:mi:ss') as HORA_VENDA,
     from source_sales

)

SELECT * FROM renamed
  ) ;
[0m20:45:53.386166 [debug] [Thread-1 (]: Redshift adapter: Redshift error: syntax error at or near "from"
[0m20:45:53.386166 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:45:53.672481 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 20:45:51.903123 => 20:45:53.671335
[0m20:45:53.673405 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m20:45:53.678306 [debug] [Thread-1 (]: Database Error in model vw_sales (models\views\vw_sales.sql)
  syntax error at or near "from"
  compiled Code at target\run\analytics_dbt\models\views\vw_sales.sql
[0m20:45:53.678306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4c2f545-b539-4484-aaaa-0b8338f6cc37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B791187BF0>]}
[0m20:45:53.678306 [error] [Thread-1 (]: 2 of 3 ERROR creating sql view model public.vw_sales ........................... [[31mERROR[0m in 1.79s]
[0m20:45:53.685870 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m20:45:53.685870 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:45:53.685870 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:45:53.691460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m20:45:53.692471 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:45:53.700853 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:45:53.702805 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 20:45:53.694763 => 20:45:53.702805
[0m20:45:53.704242 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:45:53.715776 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m20:45:53.720304 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:45:53.720304 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:45:53.720304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:45:53.720304 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:45:53.725935 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:45:54.946381 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:45:54.946381 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:45:54.946381 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m20:45:55.511680 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:45:55.515813 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:45:55.515813 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:45:55.937585 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:55.941387 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:45:55.942435 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:45:55.943388 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:45:56.565695 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:45:56.567388 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:45:56.568455 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:45:56.845998 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:56.845998 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m20:45:56.861252 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:45:56.863553 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:45:57.142547 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:57.144879 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:45:57.146107 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:45:57.146107 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:45:57.294926 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:57.296123 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:45:57.296123 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:45:57.436220 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:57.436220 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 20:45:53.705252 => 20:45:57.436220
[0m20:45:57.436220 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:45:57.722154 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:45:57.724700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4c2f545-b539-4484-aaaa-0b8338f6cc37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B791E744A0>]}
[0m20:45:57.725698 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 4.04s]
[0m20:45:57.728209 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:45:57.728209 [debug] [MainThread]: Using redshift connection "master"
[0m20:45:57.728209 [debug] [MainThread]: On master: BEGIN
[0m20:45:57.728209 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:45:57.735784 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:45:57.735784 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:45:59.016431 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:45:59.016431 [debug] [MainThread]: On master: COMMIT
[0m20:45:59.016431 [debug] [MainThread]: Using redshift connection "master"
[0m20:45:59.016431 [debug] [MainThread]: On master: COMMIT
[0m20:45:59.311079 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:45:59.315783 [debug] [MainThread]: On master: Close
[0m20:45:59.315783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:45:59.315783 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m20:45:59.315783 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m20:45:59.315783 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m20:45:59.315783 [info ] [MainThread]: 
[0m20:45:59.315783 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 20.76 seconds (20.76s).
[0m20:45:59.325872 [debug] [MainThread]: Command end result
[0m20:45:59.347674 [info ] [MainThread]: 
[0m20:45:59.347674 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:45:59.347674 [info ] [MainThread]: 
[0m20:45:59.347674 [error] [MainThread]:   Database Error in model vw_sales (models\views\vw_sales.sql)
  syntax error at or near "from"
  compiled Code at target\run\analytics_dbt\models\views\vw_sales.sql
[0m20:45:59.355750 [info ] [MainThread]: 
[0m20:45:59.355750 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:45:59.363851 [debug] [MainThread]: Command `dbt run` failed at 20:45:59.362838 after 21.71 seconds
[0m20:45:59.366399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B790B67080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B79034EA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B7915F6C00>]}
[0m20:45:59.367928 [debug] [MainThread]: Flushing usage events
[0m20:46:14.066954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BB416210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BB4166C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BB4168D0>]}


============================== 20:46:14.066954 | 15b73c31-fa7b-4d43-9fb2-603886ac6427 ==============================
[0m20:46:14.066954 [info ] [MainThread]: Running with dbt=1.7.3
[0m20:46:14.066954 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:46:14.474375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15b73c31-fa7b-4d43-9fb2-603886ac6427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BB3485C0>]}
[0m20:46:14.552902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15b73c31-fa7b-4d43-9fb2-603886ac6427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BBB4F860>]}
[0m20:46:14.552902 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m20:46:14.579624 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m20:46:14.703471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:46:14.708484 [debug] [MainThread]: Partial parsing: updated file: analytics_dbt://models\views\vw_sales.sql
[0m20:46:14.834290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15b73c31-fa7b-4d43-9fb2-603886ac6427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BC3F9E50>]}
[0m20:46:14.849912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15b73c31-fa7b-4d43-9fb2-603886ac6427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BC25ECF0>]}
[0m20:46:14.849912 [info ] [MainThread]: Found 3 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m20:46:14.865540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15b73c31-fa7b-4d43-9fb2-603886ac6427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BC25F1D0>]}
[0m20:46:14.865540 [info ] [MainThread]: 
[0m20:46:14.871521 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m20:46:14.873332 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m20:46:14.895406 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m20:46:14.896406 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m20:46:14.897401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:14.903936 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:46:14.903936 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:46:17.122457 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:46:17.126289 [debug] [ThreadPool]: On list_dev: Close
[0m20:46:17.132290 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m20:46:17.147290 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:46:17.149289 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m20:46:17.150288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:46:17.152290 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:46:17.153288 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:46:18.937749 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m20:46:18.937749 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m20:46:18.937749 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m20:46:19.242134 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:19.242134 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m20:46:19.541186 [debug] [ThreadPool]: On list_dev_public: Close
[0m20:46:19.556631 [debug] [MainThread]: Using redshift connection "master"
[0m20:46:19.556631 [debug] [MainThread]: On master: BEGIN
[0m20:46:19.556631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:46:19.556631 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:46:19.556631 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:46:20.825453 [debug] [MainThread]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:20.825453 [debug] [MainThread]: Using redshift connection "master"
[0m20:46:20.825453 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m20:46:21.171948 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:21.171948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15b73c31-fa7b-4d43-9fb2-603886ac6427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BC5E5E20>]}
[0m20:46:21.171948 [debug] [MainThread]: On master: ROLLBACK
[0m20:46:21.483184 [debug] [MainThread]: Using redshift connection "master"
[0m20:46:21.498727 [debug] [MainThread]: On master: BEGIN
[0m20:46:21.640433 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:21.640433 [debug] [MainThread]: On master: COMMIT
[0m20:46:21.640433 [debug] [MainThread]: Using redshift connection "master"
[0m20:46:21.640433 [debug] [MainThread]: On master: COMMIT
[0m20:46:21.937399 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:21.937399 [debug] [MainThread]: On master: Close
[0m20:46:21.937399 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:46:21.937399 [info ] [MainThread]: 
[0m20:46:21.955253 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m20:46:21.957255 [info ] [Thread-1 (]: 1 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m20:46:21.959252 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.analytics_dbt.my_first_dbt_model'
[0m20:46:21.961431 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m20:46:21.961431 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m20:46:21.961431 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 20:46:21.961431 => 20:46:21.961431
[0m20:46:21.961431 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m20:46:22.027905 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m20:46:22.043842 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:22.043842 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:46:22.043842 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:46:22.043842 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:46:22.043842 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:46:23.271466 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:23.271466 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:23.271466 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m20:46:23.600573 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:23.600573 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:46:23.600573 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:23.600573 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:46:24.284738 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:24.284738 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:24.284738 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:46:24.426676 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:24.426676 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m20:46:24.442302 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:24.442302 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m20:46:24.730383 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:24.730383 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:46:24.730383 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:24.730383 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:46:25.231960 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:25.231960 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:25.231960 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:46:25.373238 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:25.373238 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:25.373238 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m20:46:26.360411 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:26.376038 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:46:26.376038 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:26.376038 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:46:27.003854 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:27.003854 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:27.003854 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:46:27.286014 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:27.286014 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m20:46:27.286014 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:27.286014 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m20:46:27.568623 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:27.568623 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:46:27.568623 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:27.584248 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m20:46:27.724675 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:27.724675 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m20:46:27.724675 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m20:46:27.866503 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:27.866503 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 20:46:21.961431 => 20:46:27.866503
[0m20:46:27.866503 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m20:46:28.149463 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m20:46:28.149463 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15b73c31-fa7b-4d43-9fb2-603886ac6427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BC3225A0>]}
[0m20:46:28.149463 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 6.19s]
[0m20:46:28.149463 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m20:46:28.149463 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m20:46:28.165146 [info ] [Thread-1 (]: 2 of 3 START sql view model public.vw_sales .................................... [RUN]
[0m20:46:28.165146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m20:46:28.169384 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m20:46:28.173400 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m20:46:28.176401 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 20:46:28.170400 => 20:46:28.176401
[0m20:46:28.178396 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m20:46:28.195871 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m20:46:28.214480 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:28.215463 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:46:28.217756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:28.217756 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:46:28.217756 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:46:29.432998 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:29.432998 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:29.449026 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales

),



renamed as (

    select 
        SALESID AS ID_VENDAS,
        LISTID AS ID_LISTA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        cast(SALETIME as date) AS DATA_VENDA,
        to_char( SALETIME, 'dd/mm/yyy hh24:mi:ss') as DATA_HORA_VENDA,
        to_char( SALETIME, 'hh24:mi:ss') as HORA_VENDA
     from source_sales

)

SELECT * FROM renamed
  ) ;
[0m20:46:30.015184 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:30.017359 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:46:30.018357 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:30.019356 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:46:30.672740 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:30.672740 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:30.672740 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:46:30.955003 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:30.955003 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales"
[0m20:46:30.970750 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:30.970750 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales" cascade
[0m20:46:31.254094 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:31.254094 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:46:31.254094 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:31.254094 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:46:31.753877 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:31.753877 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:31.753877 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:46:31.897833 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:31.897833 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:31.897833 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m20:46:32.742735 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:32.742735 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:46:32.742735 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:32.742735 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:46:33.369424 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:33.369424 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:33.369424 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:46:33.652241 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:33.652241 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales__dbt_backup"
[0m20:46:33.652241 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:33.662307 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m20:46:33.935636 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:33.935636 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:46:33.935636 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:33.935636 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m20:46:34.089864 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:34.089864 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m20:46:34.089864 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m20:46:34.231227 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:34.231227 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 20:46:28.180415 => 20:46:34.231227
[0m20:46:34.231227 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m20:46:34.514421 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m20:46:34.514421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15b73c31-fa7b-4d43-9fb2-603886ac6427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BC8E9730>]}
[0m20:46:34.565104 [info ] [Thread-1 (]: 2 of 3 OK created sql view model public.vw_sales ............................... [[32mSUCCESS[0m in 6.35s]
[0m20:46:34.568694 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m20:46:34.569758 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m20:46:34.570747 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m20:46:34.573695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m20:46:34.575510 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m20:46:34.577759 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m20:46:34.577759 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 20:46:34.577520 => 20:46:34.577759
[0m20:46:34.577759 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m20:46:34.577759 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m20:46:34.594251 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:46:34.596214 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:46:34.597212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:46:34.599214 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:46:34.599939 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:46:36.284916 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m20:46:36.284916 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:46:36.284916 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m20:46:36.851526 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:36.851526 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:46:36.851526 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m20:46:37.277432 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:37.277432 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:46:37.277432 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:46:37.277432 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:46:37.900842 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m20:46:37.900842 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:46:37.900842 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:46:38.183838 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:38.183838 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m20:46:38.183838 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:46:38.183838 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m20:46:38.465520 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:38.465520 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:46:38.465520 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:46:38.465520 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m20:46:38.623082 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:38.623082 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m20:46:38.623082 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m20:46:38.764545 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:38.764545 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 20:46:34.577759 => 20:46:38.764545
[0m20:46:38.764545 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m20:46:39.045798 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m20:46:39.045798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15b73c31-fa7b-4d43-9fb2-603886ac6427', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BC87BA40>]}
[0m20:46:39.045798 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 4.47s]
[0m20:46:39.061211 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m20:46:39.061211 [debug] [MainThread]: Using redshift connection "master"
[0m20:46:39.061211 [debug] [MainThread]: On master: BEGIN
[0m20:46:39.061211 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:46:39.061211 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m20:46:39.061211 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m20:46:40.818454 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m20:46:40.818454 [debug] [MainThread]: On master: COMMIT
[0m20:46:40.818454 [debug] [MainThread]: Using redshift connection "master"
[0m20:46:40.818454 [debug] [MainThread]: On master: COMMIT
[0m20:46:41.114756 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m20:46:41.114756 [debug] [MainThread]: On master: Close
[0m20:46:41.114756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:46:41.114756 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m20:46:41.114756 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m20:46:41.114756 [debug] [MainThread]: Connection 'model.analytics_dbt.my_second_dbt_model' was properly closed.
[0m20:46:41.114756 [info ] [MainThread]: 
[0m20:46:41.130389 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 26.25 seconds (26.25s).
[0m20:46:41.130389 [debug] [MainThread]: Command end result
[0m20:46:41.218336 [info ] [MainThread]: 
[0m20:46:41.220320 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:46:41.221318 [info ] [MainThread]: 
[0m20:46:41.223318 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:46:41.226343 [debug] [MainThread]: Command `dbt run` succeeded at 20:46:41.226343 after 27.23 seconds
[0m20:46:41.227348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BC3B5D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BA02A900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296BA0540B0>]}
[0m20:46:41.228351 [debug] [MainThread]: Flushing usage events
[0m21:48:23.986092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12F316450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12F315E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12F3158B0>]}


============================== 21:48:24.011772 | 6f78b02b-36f1-48d7-86a2-ea652ba69b9d ==============================
[0m21:48:24.011772 [info ] [MainThread]: Running with dbt=1.7.3
[0m21:48:24.015789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\jpess\\.dbt', 'log_path': 'C:\\Josi\\Cursos e Treinamentos\\Stack\\DBT\\dbt_env\\analytics_edz_dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:48:24.745418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6f78b02b-36f1-48d7-86a2-ea652ba69b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12FC4FC80>]}
[0m21:48:24.896496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6f78b02b-36f1-48d7-86a2-ea652ba69b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12FEB2BD0>]}
[0m21:48:24.916882 [info ] [MainThread]: Registered adapter: redshift=1.7.0
[0m21:48:24.957100 [debug] [MainThread]: checksum: c95636796e12235e48c0560a0bb6a50e98827ef72e7ea1fe07a97c38c91661e1, vars: {}, profile: , target: , version: 1.7.3
[0m21:48:24.982231 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:48:24.986271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6f78b02b-36f1-48d7-86a2-ea652ba69b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12FE72B40>]}
[0m21:48:27.349863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6f78b02b-36f1-48d7-86a2-ea652ba69b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12FEFDF10>]}
[0m21:48:27.370216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6f78b02b-36f1-48d7-86a2-ea652ba69b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12FFB7E60>]}
[0m21:48:27.371806 [info ] [MainThread]: Found 4 models, 4 tests, 0 sources, 0 exposures, 0 metrics, 455 macros, 0 groups, 0 semantic models
[0m21:48:27.372882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f78b02b-36f1-48d7-86a2-ea652ba69b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1302E5430>]}
[0m21:48:27.375902 [info ] [MainThread]: 
[0m21:48:27.378460 [debug] [MainThread]: Acquiring new redshift connection 'master'
[0m21:48:27.382048 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev'
[0m21:48:27.416608 [debug] [ThreadPool]: Using redshift connection "list_dev"
[0m21:48:27.419542 [debug] [ThreadPool]: On list_dev: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev"} */

    select distinct nspname from pg_namespace
[0m21:48:27.419542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:27.428210 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:48:27.429216 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:48:31.051489 [debug] [ThreadPool]: SQL status: SUCCESS in 4.0 seconds
[0m21:48:31.072724 [debug] [ThreadPool]: On list_dev: Close
[0m21:48:31.080782 [debug] [ThreadPool]: Acquiring new redshift connection 'list_dev_public'
[0m21:48:31.096918 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m21:48:31.098933 [debug] [ThreadPool]: On list_dev_public: BEGIN
[0m21:48:31.100624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:31.102713 [debug] [ThreadPool]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:48:31.102859 [debug] [ThreadPool]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:48:33.291218 [debug] [ThreadPool]: SQL status: SUCCESS in 2.0 seconds
[0m21:48:33.292750 [debug] [ThreadPool]: Using redshift connection "list_dev_public"
[0m21:48:33.294769 [debug] [ThreadPool]: On list_dev_public: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "list_dev_public"} */
select
        table_catalog as database,
        table_name as name,
        table_schema as schema,
        'table' as type
    from information_schema.tables
    where table_schema ilike 'public'
    and table_type = 'BASE TABLE'
    union all
    select
      table_catalog as database,
      table_name as name,
      table_schema as schema,
      case
        when view_definition ilike '%create materialized view%'
          then 'materialized_view'
        else 'view'
      end as type
    from information_schema.views
    where table_schema ilike 'public'
[0m21:48:33.603621 [debug] [ThreadPool]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:33.622702 [debug] [ThreadPool]: On list_dev_public: ROLLBACK
[0m21:48:33.927300 [debug] [ThreadPool]: On list_dev_public: Close
[0m21:48:33.973681 [debug] [MainThread]: Using redshift connection "master"
[0m21:48:33.974684 [debug] [MainThread]: On master: BEGIN
[0m21:48:33.975681 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:48:33.976682 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:48:33.977682 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:48:35.501526 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m21:48:35.501526 [debug] [MainThread]: Using redshift connection "master"
[0m21:48:35.505165 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "connection_name": "master"} */
with
    relation as (
        select
            pg_class.oid as relation_id,
            pg_class.relname as relation_name,
            pg_class.relnamespace as schema_id,
            pg_namespace.nspname as schema_name,
            pg_class.relkind as relation_type
        from pg_class
        join pg_namespace
          on pg_class.relnamespace = pg_namespace.oid
        where pg_namespace.nspname != 'information_schema'
          and pg_namespace.nspname not like 'pg\_%'
    ),
    dependency as (
        select distinct
            coalesce(pg_rewrite.ev_class, pg_depend.objid) as dep_relation_id,
            pg_depend.refobjid as ref_relation_id,
            pg_depend.refclassid as ref_class_id
        from pg_depend
        left join pg_rewrite
          on pg_depend.objid = pg_rewrite.oid
        where coalesce(pg_rewrite.ev_class, pg_depend.objid) != pg_depend.refobjid
    )

select distinct
    dep.schema_name as dependent_schema,
    dep.relation_name as dependent_name,
    ref.schema_name as referenced_schema,
    ref.relation_name as referenced_name
from dependency
join relation ref
    on dependency.ref_relation_id = ref.relation_id
join relation dep
    on dependency.dep_relation_id = dep.relation_id
[0m21:48:35.962238 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:35.983463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6f78b02b-36f1-48d7-86a2-ea652ba69b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12FFF0980>]}
[0m21:48:35.984467 [debug] [MainThread]: On master: ROLLBACK
[0m21:48:36.481367 [debug] [MainThread]: Using redshift connection "master"
[0m21:48:36.483726 [debug] [MainThread]: On master: BEGIN
[0m21:48:36.703391 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:36.719684 [debug] [MainThread]: On master: COMMIT
[0m21:48:36.723321 [debug] [MainThread]: Using redshift connection "master"
[0m21:48:36.726340 [debug] [MainThread]: On master: COMMIT
[0m21:48:37.012774 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:37.026793 [debug] [MainThread]: On master: Close
[0m21:48:37.032093 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:48:37.036474 [info ] [MainThread]: 
[0m21:48:37.053439 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_first_dbt_model
[0m21:48:37.057620 [info ] [Thread-1 (]: 1 of 4 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m21:48:37.062161 [debug] [Thread-1 (]: Acquiring new redshift connection 'model.analytics_dbt.my_first_dbt_model'
[0m21:48:37.067315 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_first_dbt_model
[0m21:48:37.078468 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_first_dbt_model"
[0m21:48:37.085463 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (compile): 21:48:37.069594 => 21:48:37.083411
[0m21:48:37.088012 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_first_dbt_model
[0m21:48:37.274713 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_first_dbt_model"
[0m21:48:37.281413 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:37.284462 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m21:48:37.285435 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:48:37.287979 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:48:37.290010 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:48:38.609908 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:38.627711 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:38.629734 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */

  
    

  create  table
    "dev"."public"."my_first_dbt_model__dbt_tmp"
    
    
    
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
[0m21:48:38.963396 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:38.971491 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m21:48:38.973506 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:38.975547 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m21:48:39.733873 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:39.736872 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:39.738872 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m21:48:39.887397 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:39.920234 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model"
[0m21:48:39.942013 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:39.944075 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model" cascade
[0m21:48:40.242733 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:40.262701 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m21:48:40.262701 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:40.268794 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m21:48:40.834555 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:40.856336 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:40.858424 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m21:48:41.170098 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:41.189257 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:41.190259 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
alter table "dev"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m21:48:43.546131 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m21:48:43.598347 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m21:48:43.599225 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:43.601277 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m21:48:44.564441 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:44.582583 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:44.584498 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m21:48:45.324049 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:45.347716 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_first_dbt_model__dbt_backup"
[0m21:48:45.350219 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:45.352395 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_first_dbt_model"} */
drop table if exists "dev"."public"."my_first_dbt_model__dbt_backup" cascade
[0m21:48:46.135668 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:46.153574 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m21:48:46.155573 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:46.156574 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: COMMIT
[0m21:48:46.348373 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:46.366680 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_first_dbt_model"
[0m21:48:46.367681 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: BEGIN
[0m21:48:46.653239 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:46.653239 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_first_dbt_model (execute): 21:48:37.088636 => 21:48:46.653239
[0m21:48:46.653239 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: ROLLBACK
[0m21:48:46.949563 [debug] [Thread-1 (]: On model.analytics_dbt.my_first_dbt_model: Close
[0m21:48:46.968159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f78b02b-36f1-48d7-86a2-ea652ba69b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12D774080>]}
[0m21:48:46.970294 [info ] [Thread-1 (]: 1 of 4 OK created sql table model public.my_first_dbt_model .................... [[32mSUCCESS[0m in 9.91s]
[0m21:48:46.971936 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_first_dbt_model
[0m21:48:46.973988 [debug] [Thread-1 (]: Began running node model.analytics_dbt.vw_sales
[0m21:48:46.976057 [info ] [Thread-1 (]: 2 of 4 START sql view model public.vw_sales .................................... [RUN]
[0m21:48:46.978021 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_first_dbt_model, now model.analytics_dbt.vw_sales)
[0m21:48:46.980505 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.vw_sales
[0m21:48:46.984655 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.vw_sales"
[0m21:48:46.986646 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (compile): 21:48:46.981608 => 21:48:46.986646
[0m21:48:46.988675 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.vw_sales
[0m21:48:47.037188 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.vw_sales"
[0m21:48:47.041756 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:47.045801 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m21:48:47.048835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:47.049843 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:48:47.052572 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:48:48.320882 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:48.338499 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:48.339648 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */


  create view "dev"."public"."vw_sales__dbt_tmp" as (
    with source_sales as (
    select *
    from sales

),



renamed as (

    select 
        SALESID AS ID_VENDAS,
        LISTID AS ID_LISTA,
        SELLERID AS ID_VENDEDOR,
        BUYERID AS ID_COMPRADOR,
        EVENTID AS ID_EVENTO,
        DATEID AS ID_DATE,
        QTYSOLD AS QUANTIDADE_VENDIDA,
        PRICEPAID AS VALOR_PAGO,
        COMMISSION AS COMISSAO,
        cast(SALETIME as date) AS DATA_VENDA,
        to_char( SALETIME, 'dd/mm/yyy hh24:mi:ss') as DATA_HORA_VENDA,
        to_char( SALETIME, 'hh24:mi:ss') as HORA_VENDA
     from source_sales

)

SELECT * FROM renamed
  ) ;
[0m21:48:48.912598 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:48.931275 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m21:48:48.933218 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:48.933218 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m21:48:49.633294 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:49.650388 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:49.651483 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m21:48:49.934247 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:49.956417 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales"
[0m21:48:49.967066 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:49.968065 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales" cascade
[0m21:48:50.252847 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:50.272658 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m21:48:50.273642 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:50.274654 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m21:48:50.816527 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:50.834572 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:50.835555 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m21:48:51.021075 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:51.027717 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:51.029729 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
alter table "dev"."public"."vw_sales__dbt_tmp" rename to "vw_sales"
[0m21:48:52.963027 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m21:48:52.972617 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m21:48:52.975634 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:52.978633 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m21:48:53.786239 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:53.805378 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:53.808933 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m21:48:54.246105 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:54.254420 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."vw_sales__dbt_backup"
[0m21:48:54.258413 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:54.260412 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.vw_sales"} */
drop view if exists "dev"."public"."vw_sales__dbt_backup" cascade
[0m21:48:54.775676 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:54.778874 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m21:48:54.781391 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:54.783599 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: COMMIT
[0m21:48:55.016369 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:55.035755 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.vw_sales"
[0m21:48:55.037789 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: BEGIN
[0m21:48:55.220849 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:55.238540 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.vw_sales (execute): 21:48:46.988675 => 21:48:55.237541
[0m21:48:55.241065 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: ROLLBACK
[0m21:48:55.629332 [debug] [Thread-1 (]: On model.analytics_dbt.vw_sales: Close
[0m21:48:55.648954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f78b02b-36f1-48d7-86a2-ea652ba69b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F130B94770>]}
[0m21:48:55.651633 [info ] [Thread-1 (]: 2 of 4 OK created sql view model public.vw_sales ............................... [[32mSUCCESS[0m in 8.67s]
[0m21:48:55.653599 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.vw_sales
[0m21:48:55.654597 [debug] [Thread-1 (]: Began running node model.analytics_dbt.my_second_dbt_model
[0m21:48:55.657601 [info ] [Thread-1 (]: 3 of 4 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m21:48:55.661311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.vw_sales, now model.analytics_dbt.my_second_dbt_model)
[0m21:48:55.664355 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.my_second_dbt_model
[0m21:48:55.672771 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.my_second_dbt_model"
[0m21:48:55.672771 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (compile): 21:48:55.665355 => 21:48:55.672771
[0m21:48:55.672771 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.my_second_dbt_model
[0m21:48:55.688711 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.my_second_dbt_model"
[0m21:48:55.695823 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m21:48:55.695823 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m21:48:55.701332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:48:55.703381 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:48:55.704301 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:48:57.388877 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m21:48:57.405951 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m21:48:57.407969 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */


  create view "dev"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "dev"."public"."my_first_dbt_model"
where id = 1
  ) ;
[0m21:48:57.981402 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:57.995898 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m21:48:57.995898 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
alter table "dev"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m21:48:58.437735 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:48:58.443081 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m21:48:58.443081 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m21:48:58.443081 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m21:48:59.622912 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:48:59.634562 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m21:48:59.635531 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m21:49:00.231462 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:49:00.231462 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."my_second_dbt_model__dbt_backup"
[0m21:49:00.231462 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m21:49:00.231462 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.my_second_dbt_model"} */
drop view if exists "dev"."public"."my_second_dbt_model__dbt_backup" cascade
[0m21:49:00.645894 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:49:00.665988 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m21:49:00.666982 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m21:49:00.667988 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: COMMIT
[0m21:49:00.814576 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:49:00.837925 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.my_second_dbt_model"
[0m21:49:00.839925 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: BEGIN
[0m21:49:01.056544 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:49:01.075091 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.my_second_dbt_model (execute): 21:48:55.678301 => 21:49:01.075091
[0m21:49:01.077008 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: ROLLBACK
[0m21:49:01.464674 [debug] [Thread-1 (]: On model.analytics_dbt.my_second_dbt_model: Close
[0m21:49:01.483358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f78b02b-36f1-48d7-86a2-ea652ba69b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12D774080>]}
[0m21:49:01.485377 [info ] [Thread-1 (]: 3 of 4 OK created sql view model public.my_second_dbt_model .................... [[32mSUCCESS[0m in 5.82s]
[0m21:49:01.493046 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.my_second_dbt_model
[0m21:49:01.494058 [debug] [Thread-1 (]: Began running node model.analytics_dbt.tb_top_10_compradores
[0m21:49:01.496436 [info ] [Thread-1 (]: 4 of 4 START sql table model public.tb_top_10_compradores ...................... [RUN]
[0m21:49:01.500425 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.analytics_dbt.my_second_dbt_model, now model.analytics_dbt.tb_top_10_compradores)
[0m21:49:01.501938 [debug] [Thread-1 (]: Began compiling node model.analytics_dbt.tb_top_10_compradores
[0m21:49:01.510371 [debug] [Thread-1 (]: Writing injected SQL for node "model.analytics_dbt.tb_top_10_compradores"
[0m21:49:01.517493 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.tb_top_10_compradores (compile): 21:49:01.505390 => 21:49:01.516460
[0m21:49:01.519580 [debug] [Thread-1 (]: Began executing node model.analytics_dbt.tb_top_10_compradores
[0m21:49:01.525107 [debug] [Thread-1 (]: Writing runtime sql for node "model.analytics_dbt.tb_top_10_compradores"
[0m21:49:01.535282 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m21:49:01.537280 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: BEGIN
[0m21:49:01.539325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:49:01.541820 [debug] [Thread-1 (]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:49:01.543849 [debug] [Thread-1 (]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:49:04.536084 [debug] [Thread-1 (]: SQL status: SUCCESS in 3.0 seconds
[0m21:49:04.555309 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m21:49:04.556335 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_top_10_compradores"} */

  
    

  create  table
    "dev"."public"."tb_top_10_compradores__dbt_tmp"
    
    
    
  as (
    with sales as(
	select * from vw_sales
	--"dev"."public"."vw_sales"
),

compradores as (
	select
		(firstname||' '|| lastname) as Nome_Completo, userid
	from users
),

top_10_compradores as(
	select 
	  compradores.Nome_completo as Nome_completo,
	  sum(sales.quantidade_vendida) as Vendas_totais,
	  sales.comissao as Comissao
	from sales inner join compradores
    on sales.id_comprador = compradores.userid
    group by compradores.userid, compradores.Nome_completo, sales.comissao
    order by Vendas_totais desc
    limit 10
)

select * from top_10_compradores
  );
[0m21:49:09.877242 [debug] [Thread-1 (]: SQL status: SUCCESS in 5.0 seconds
[0m21:49:09.882447 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m21:49:09.883440 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_top_10_compradores"} */
alter table "dev"."public"."tb_top_10_compradores__dbt_tmp" rename to "tb_top_10_compradores"
[0m21:49:11.394013 [debug] [Thread-1 (]: SQL status: SUCCESS in 2.0 seconds
[0m21:49:11.416204 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m21:49:11.417205 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m21:49:11.418204 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m21:49:12.624134 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:49:12.642700 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m21:49:12.644695 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: BEGIN
[0m21:49:13.339988 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:49:13.364401 [debug] [Thread-1 (]: Applying DROP to: "dev"."public"."tb_top_10_compradores__dbt_backup"
[0m21:49:13.367386 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m21:49:13.369382 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: /* {"app": "dbt", "dbt_version": "1.7.3", "profile_name": "analytics_dbt", "target_name": "dev", "node_id": "model.analytics_dbt.tb_top_10_compradores"} */
drop table if exists "dev"."public"."tb_top_10_compradores__dbt_backup" cascade
[0m21:49:14.020336 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:49:14.038019 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m21:49:14.040047 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m21:49:14.041533 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: COMMIT
[0m21:49:14.195187 [debug] [Thread-1 (]: SQL status: SUCCESS in 0.0 seconds
[0m21:49:14.212947 [debug] [Thread-1 (]: Using redshift connection "model.analytics_dbt.tb_top_10_compradores"
[0m21:49:14.214935 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: BEGIN
[0m21:49:15.286487 [debug] [Thread-1 (]: SQL status: SUCCESS in 1.0 seconds
[0m21:49:15.307172 [debug] [Thread-1 (]: Timing info for model.analytics_dbt.tb_top_10_compradores (execute): 21:49:01.519580 => 21:49:15.304940
[0m21:49:15.309716 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: ROLLBACK
[0m21:49:16.104771 [debug] [Thread-1 (]: On model.analytics_dbt.tb_top_10_compradores: Close
[0m21:49:16.123971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6f78b02b-36f1-48d7-86a2-ea652ba69b9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F130BECE90>]}
[0m21:49:16.125990 [info ] [Thread-1 (]: 4 of 4 OK created sql table model public.tb_top_10_compradores ................. [[32mSUCCESS[0m in 14.62s]
[0m21:49:16.129990 [debug] [Thread-1 (]: Finished running node model.analytics_dbt.tb_top_10_compradores
[0m21:49:16.133535 [debug] [MainThread]: Using redshift connection "master"
[0m21:49:16.134536 [debug] [MainThread]: On master: BEGIN
[0m21:49:16.135535 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:49:16.136534 [debug] [MainThread]: Redshift adapter: Establishing connection using ssl with `sslmode` set to 'prefer'.To connect without ssl, set `sslmode` to 'disable'.
[0m21:49:16.137533 [debug] [MainThread]: Redshift adapter: Connecting to redshift with username/password based auth...
[0m21:49:18.267661 [debug] [MainThread]: SQL status: SUCCESS in 2.0 seconds
[0m21:49:18.269659 [debug] [MainThread]: On master: COMMIT
[0m21:49:18.272259 [debug] [MainThread]: Using redshift connection "master"
[0m21:49:18.276278 [debug] [MainThread]: On master: COMMIT
[0m21:49:18.747863 [debug] [MainThread]: SQL status: SUCCESS in 0.0 seconds
[0m21:49:18.765792 [debug] [MainThread]: On master: Close
[0m21:49:18.769813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:49:18.769813 [debug] [MainThread]: Connection 'list_dev' was properly closed.
[0m21:49:18.771325 [debug] [MainThread]: Connection 'list_dev_public' was properly closed.
[0m21:49:18.773334 [debug] [MainThread]: Connection 'model.analytics_dbt.tb_top_10_compradores' was properly closed.
[0m21:49:18.774333 [info ] [MainThread]: 
[0m21:49:18.775764 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 51.40 seconds (51.40s).
[0m21:49:18.779780 [debug] [MainThread]: Command end result
[0m21:49:18.803415 [info ] [MainThread]: 
[0m21:49:18.806436 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:49:18.807413 [info ] [MainThread]: 
[0m21:49:18.810237 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m21:49:18.811300 [debug] [MainThread]: Command `dbt run` succeeded at 21:49:18.811300 after 54.95 seconds
[0m21:49:18.811300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12F103620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12F2FB440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F12F0D2120>]}
[0m21:49:18.817826 [debug] [MainThread]: Flushing usage events
